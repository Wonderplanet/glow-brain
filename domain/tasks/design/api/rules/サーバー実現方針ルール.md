# サーバー実現方針 定義ドキュメント（ゲームAPI開発向け）

本ドキュメントは、  
**サーバー要件として抽出された仕様項目に対し、  
「どのような実現アプローチを取るか」を検討・記録するための指針**を定義する。

本フェーズの目的は、  
実装詳細に踏み込む前に **無理のない・説明可能なサーバー実現方針を確定すること** である。

---

## 1. 本ドキュメントの位置づけ

サーバー実現方針は、以下の開発プロセス上の中間成果物である。

```
ゲーム体験仕様
  ↓
要件分類
  ↓
サーバー要件抽出
  ↓
★ サーバー実現方針（本ドキュメント）
  ↓
API設計
  ↓
実装詳細設計
```

- 「何を作るか」はすでに確定している
- 「どう作るか（詳細）」はまだ決めない
- **「どういうアプローチで実現するか」だけを決める**

---

## 2. サーバー実現方針とは何か

### 定義
**仕様項目ごとに、  
サーバーとしてどのような実現アプローチを採用するかを判断・記録したもの**。

### 含むもの
- 既存機能で実現可能かどうかの判断
- 無理のない設計・実装になるかの評価
- 新規実装が必要かどうかの結論
- その判断に至った理由・背景

### 含まないもの
- API仕様の詳細
- クラス設計・コード構造
- アルゴリズム・SQL詳細

---

## 3. 実現方針の分類

各仕様項目は、以下のいずれかの方針に分類する。

### 3.1 既存機能の組み合わせで実現する

#### 意味
- 新規ドメインロジックは作らない
- 既存API / 処理フローの組み合わせで対応可能

#### 採用条件
- 責務が歪まない
- 条件分岐が過度に増えない
- 将来の拡張で破綻しない
- 運用・デバッグが現実的

---

### 3.2 既存機能を一部拡張して実現する

#### 意味
- 既存構造をベースに、最小限の拡張を加える
- 新しい概念を増やさない

#### 採用条件
- 拡張が自然である
- 他機能への影響が限定的
- 一時しのぎにならない

---

### 3.3 新規実装が必要

#### 意味
- 既存機能の流用・拡張では無理がある
- 新しいドメイン概念が必要

#### 採用条件
- 既存機能を無理に使うと設計が歪む
- 将来的な保守・拡張に悪影響が出る
- 説明可能な理由がある

---

## 4. 検討時の評価観点（最重要）

実現方針を決める際は、以下の観点で必ず評価する。

### 設計健全性
- 責務は適切か
- ドメイン境界を壊していないか

### 実装現実性
- 条件分岐地獄にならないか
- 実装コストは妥当か

### 運用・保守性
- デバッグ可能か
- 運営・障害対応が現実的か

### 将来拡張性
- 次の仕様追加で破綻しないか
- 再利用可能か

---

## 5. 「新規実装」と判断するためのルール

以下に該当する場合は、  
**既存機能の流用を無理に行わず、新規実装を選択する**。

- 本来の責務を超えて既存機能を使おうとしている
- 特殊条件が増えすぎて可読性が著しく低下する
- 運用・障害対応が困難になる
- 将来の仕様変更に耐えられない

---

## 6. 方針決定時の記載ルール

### 必須記載項目
- 対象仕様項目
- 採用した実現方針
- 検討した選択肢（簡潔でよい）
- 採用理由
- 却下理由（ある場合）

### 記載スタンス
- 正解を装わない
- 判断理由を残す
- 後から読んだ人が納得できることを重視する

---

## 7. 本ドキュメントの価値

- 設計判断のブラックボックス化を防ぐ
- 将来の改修時の理解コストを下げる
- レビュー・合意形成を円滑にする
- 「なぜ新規で作ったのか」を説明できる

---

## 備考
- サーバー実現方針は「設計の一部」であり「実装の前提」である
- 本ドキュメントは、継続的に更新される前提で扱う
