# アチーブメントミッションマスタデータ作成プロンプト

## 作業内容

「アチーブメントミッション マスタデータ設定手順書」セクションの手順に従って、
添付した運営仕様書からアチーブメントミッションのマスタデータを作成してください。
運営仕様書: 04_ミッション

新規リソース情報など、データ作成に必要な追加情報があれば、追加情報ファイルとして追加します。
追加情報ファイル:
- 新規リソース情報を含むファイル: 01_概要

最後に、仕様書、設計書の内容で、正確に漏れなく、マスタデータを作成できているかを、必ず確認する。全て正確に作り終えるまで、作業を終えてはいけません

## 入力パラメータ

- release_key: {release_keyを指定}
- MstMissionAchievement.id の接頭辞: achievement_{グループ番号}_
- MstMissionAchievementDependency.id: {連番の開始番号}
- MstMissionReward.id: mission_reward_{連番の開始番号}

## 出力形式

### 1. マスタデータ

- 手順書の「データ整合性のチェック」を満たしたデータになっていることを必ずチェックし、問題があれば修正完了してから出力する
- Markdown表形式で出力（スプレッドシートへのエクスポート・コピーボタンが正常に表示される形式）

---

# アチーブメントミッション マスタデータ設定手順書

## 概要

アチーブメントミッションのマスタデータ作成手順を記載します。
本手順書に従うことで、ゲーム内でエラーが発生しない正確なマスタデータを作成できます。

## 対象テーブル

アチーブメントミッションでは、以下の3シート構成でマスタデータを作成します。

**出力シート**:
- **MstMissionAchievement** - アチーブメントミッションの基本情報(MstMissionAchievementI18nのカラムを含む)
- **MstMissionAchievementDependency** - ミッション間の解放順序の依存関係
- **MstMissionReward** - ミッション報酬

**重要**: MstMissionAchievementI18nは独立したシートではなく、MstMissionAchievementシート内に統合されています。

## 作成フロー

### 1. 仕様書の確認

運営仕様書から以下の情報を抽出します。

**必要情報**:
- ミッションの達成条件(何を何回実行するか)
- ミッションの報酬内容
- ミッションの表示順序
- ミッション説明文(日本語)
- ミッション間の依存関係(順序解放の有無)

### 2. MstMissionAchievement シートの作成(I18n含む)

#### 2.1 シートスキーマ

このシートには、TABLE行、ENABLE行、データ行が含まれます。

**TABLE行** - 各カラムがどのテーブルに属するかを示します。

```
TABLE,MstMissionAchievement,MstMissionAchievement,MstMissionAchievement,MstMissionAchievement,MstMissionAchievement,MstMissionAchievement,MstMissionAchievement,MstMissionAchievement,MstMissionAchievement,MstMissionAchievement,MstMissionAchievement,MstMissionAchievement,MstMissionAchievementI18n
```

**ENABLEと列名行** - カラム名を示します。

```
ENABLE,id,release_key,criterion_type,criterion_value,criterion_count,unlock_criterion_type,unlock_criterion_value,unlock_criterion_count,group_key,mst_mission_reward_group_id,sort_order,destination_scene,description.ja
```

#### 2.2 各カラムの設定ルール

| カラム名 | 設定ルール |
|---------|-----------|
| **ENABLE** | 固定値: `e` (有効化) |
| **id** | ミッションの一意識別子。命名規則: `achievement_{グループ番号}_{連番}` |
| **release_key** | リリースキー。例: `202512020` |
| **criterion_type** | 達成条件タイプ。下記の「criterion_type設定一覧」を参照 |
| **criterion_value** | 条件の指定値。criterion_typeに応じて設定。不要な場合は空欄 |
| **criterion_count** | 条件の回数。例: `5`(5回クリア) |
| **unlock_criterion_type** | 解放条件タイプ。通常は `__NULL__` (依存関係はMstMissionAchievementDependencyで管理) |
| **unlock_criterion_value** | 解放条件の値。通常は空欄 |
| **unlock_criterion_count** | 解放条件の回数。通常は `0` |
| **group_key** | グループキー。**アチーブメントミッションでは使用しない**。常に空欄 |
| **mst_mission_reward_group_id** | 報酬グループID。MstMissionRewardのgroup_idと対応。通常はidと同じ値を設定 |
| **sort_order** | 表示順序。小さい数字ほど上位に表示。例: `1`, `2`, `3`... |
| **destination_scene** | タップ時の遷移先シーン。下記の「destination_scene設定ルール」を参照 |
| **description.ja** | ミッション説明文(日本語)。ユーザーに表示される文言 |

#### criterion_type設定一覧

アチーブメントミッションで使用可能なcriterion_typeは
notebookLMにソース登録されている「ミッショントリガー一覧 - データ入力用ミッショントリガー一覧」に記載されています。
適切にデータを抽出してマスタデータ作成を進めてください。
注意：**大文字小文字を正確に一致**させてください。

**頻繁に使用されるcriterion_type(使用頻度順)**:

| criterion_type | 説明 | criterion_value | criterion_count | destination_scene | 使用例 |
|---------------|------|----------------|----------------|------------------|--------|
| **SpecificQuestClear** | 特定クエストを初クリア | クエストID (mst_quests.id)<br>例: `quest_main_osh_normal_17` | 固定値: `1`<br>※2以上は設定不可 | QuestSelect | メインクエスト「【推しの子】」の難易度ノーマルをクリアしよう |
| **LoginCount** | 通算ログイン日数 | 空欄 | 通算ログインして欲しい日数 | Home | 通算ログイン7日目 |
| **DefeatEnemyCount** | インゲームで敵を撃破 | 空欄 | 撃破して欲しい敵数 | StageSelect | 敵を100体撃破しよう |
| **UnitLevelUpCount** | ユニットのレベルアップ | 空欄 | レベルアップを実行してほしい回数 | UnitList | ユニットのレベルアップを10回実行しよう |
| **OutpostEnhanceCount** | ゲートを強化 | 空欄 | ゲートを強化してほしい回数 | OutpostEnhance | ゲートを5回強化しよう |
| **CoinCollect** | コインを集める | 空欄 | 集めてほしいコイン数 | StageSelect | コインを10000枚集めよう |
| **IdleIncentiveCount** | 探索 | 空欄 | 探索をして欲しい回数 | IdleIncentive | 探索を10回実行しよう |
| **DefeatBossEnemyCount** | インゲームで強敵(ボス)を撃破 | 空欄 | 撃破して欲しい敵数 | StageSelect | ボスを10体撃破しよう |

#### 2.3 destination_scene設定ルール

`destination_scene`は、ミッションをタップした時にユーザーが遷移する画面を指定します。

**重要な原則**:
- **criterion_typeとdestination_sceneは強い相関関係があります**
- 83%のcriterion_typeは1つのdestination_sceneに固定されています
- 上記のcriterion_type一覧表の「destination_scene候補」列を参照してください

**destination_scene一覧**:

| destination_scene | 説明 | 主な用途 |
|------------------|------|---------|
| **QuestSelect** | クエスト選択画面 | クエスト・原画・エンブレム系ミッション(最も使用頻度が高い) |
| **Home** | ホーム画面 | ログイン・プレイヤーレベル・ミッションクリア系ミッション |
| **StageSelect** | ステージ選択画面 | コイン収集・通常ステージ・敵撃破系ミッション |
| **UnitList** | ユニット一覧画面 | ユニット育成系ミッション |
| **OutpostEnhance** | ゲート強化画面 | ゲート強化系ミッション |
| **IdleIncentive** | 放置報酬画面 | 探索系ミッション |
| **Gacha** | ガシャ画面 | ガシャ引き回数・ユニット獲得系ミッション |
| **Web** | Web遷移 | SNSフォロー・レビュー・外部サイト系 |
| **LinkBnId** | アカウント連携画面 | アカウント連携系ミッション |
| **Pvp** | 決闘画面 | 決闘系ミッション |
| **Event** | イベント画面 | イベント関連ミッション |

#### 2.4 アチーブメントミッション固有の設定

アチーブメントミッションでは、以下のように設定します。

- **criterion_type**: 上記のcriterion_type一覧から選択。アチーブメントミッションで頻繁に使用されるものを優先的に検討
- **criterion_value**: criterion_typeに応じて設定(不要な場合は空欄)
- **criterion_count**: 達成に必要な回数またはレベル・数量
- **unlock_criterion_type**: 通常は `__NULL__` (依存関係はMstMissionAchievementDependencyで管理)
- **unlock_criterion_value**: 通常は空欄
- **unlock_criterion_count**: 通常は `0`
- **group_key**: **アチーブメントミッションでは使用しない**。常に空欄
- **destination_scene**: criterion_typeに応じて設定。上記の「destination_scene設定ルール」を参照

#### 2.5 ID採番ルール

アチーブメントミッションのIDは、以下の形式で採番します。

```
achievement_{グループ番号}_{連番}
```

**パラメータ:**
- `グループ番号`: 1から順番に採番(アンダースコア区切りなし)
- `連番`: グループ内で1から順番に採番(ゼロパディングは仕様書に従う)

**採番例:**
```
achievement_1_001   (グループ1 ミッション1)
achievement_1_002   (グループ1 ミッション2)
achievement_2_101   (グループ2 ミッション101)
achievement_2_102   (グループ2 ミッション102)
```

**重要な注意点:**
- group_keyは常に空欄
- mst_mission_reward_group_idはidと同じ値を使用

#### 2.6 作成例

```
TABLE,MstMissionAchievement,MstMissionAchievement,MstMissionAchievement,MstMissionAchievement,MstMissionAchievement,MstMissionAchievement,MstMissionAchievement,MstMissionAchievement,MstMissionAchievement,MstMissionAchievement,MstMissionAchievement,MstMissionAchievement,MstMissionAchievementI18n
ENABLE,id,release_key,criterion_type,criterion_value,criterion_count,unlock_criterion_type,unlock_criterion_value,unlock_criterion_count,group_key,mst_mission_reward_group_id,sort_order,destination_scene,description.ja
e,achievement_2_101,202512020,SpecificQuestClear,quest_main_osh_normal_17,1,__NULL__,,0,,achievement_2_101,101,QuestSelect,メインクエスト「【推しの子】」の難易度ノーマルをクリアしよう
e,achievement_2_102,202512020,SpecificQuestClear,quest_main_osh_hard_17,1,__NULL__,,0,,achievement_2_102,102,QuestSelect,メインクエスト「【推しの子】」の難易度ハードをクリアしよう
e,achievement_2_103,202512020,SpecificQuestClear,quest_main_osh_veryhard_17,1,__NULL__,,0,,achievement_2_103,103,QuestSelect,メインクエスト「【推しの子】」の難易度エクストラをクリアしよう
```

#### 2.7 説明文作成のポイント

- 達成条件を明確に記載する(例: 「難易度ノーマルをクリア」)
- ユーザーフレンドリーな表現にする
- 文末は「〜しよう」形式が推奨
- 特別な演出がある場合は【】で強調する(例: 【汗が輝いてるよ!】)

### 3. MstMissionAchievementDependency シートの作成

#### 3.1 シートスキーマ

このシートには、TABLE行、ENABLE行、データ行が含まれます。

**TABLE行** - 各カラムがどのテーブルに属するかを示します。

```
TABLE,MstMissionAchievementDependency,MstMissionAchievementDependency,MstMissionAchievementDependency,MstMissionAchievementDependency,MstMissionAchievementDependency,MstMissionAchievementDependency
```

**ENABLEと列名行** - カラム名を示します。

```
ENABLE,id,release_key,group_id,mst_mission_achievement_id,unlock_order,備考
```

#### 3.2 各カラムの設定ルール

| カラム名 | 設定ルール |
|---------|-----------|
| **ENABLE** | 固定値: `e` (有効化) |
| **id** | 依存関係の一意識別子。連番で設定。例: `101`, `102`, `103`... |
| **release_key** | リリースキー。MstMissionAchievementと同じ値 |
| **group_id** | 依存関係のグループID。下記の「group_id採番ルール」を参照 |
| **mst_mission_achievement_id** | ミッションID。MstMissionAchievement.idと対応 |
| **unlock_order** | 解放順序。1から順番に設定 |
| **備考** | 空欄にする |

#### 3.3 group_id採番ルール

MstMissionAchievementDependencyの`group_id`は、**依存関係グループの最初のミッションIDと同じ値**を使用します。

**採番パターン:**
```
achievement_{グループ番号}_{連番}
```

**重要な原則:**
- group_idは、そのグループで**最初に解放されるミッション(unlock_order=1)のミッションID**と同じ
- 同じgroup_id内のミッションは、unlock_orderの順番に解放される
- group_idが異なる場合は、それぞれ独立した依存関係グループとして管理される

**実例:**

| group_id | 含まれるミッション | unlock_order | 説明 |
|----------|------------------|--------------|------|
| achievement_2_101 | achievement_2_101 | 1 | メインクエストクリアミッション(1番目) |
| achievement_2_101 | achievement_2_102 | 2 | メインクエストクリアミッション(2番目) |
| achievement_2_101 | achievement_2_103 | 3 | メインクエストクリアミッション(3番目) |

**設定方法:**

1. 依存関係を持つミッションのグループを特定する
2. そのグループの最初のミッションIDをgroup_idとして使用する
3. 同じgroup_id内のミッションに、unlock_order=1から順番に番号を振る

**例:**

メインクエストクリアミッション(ノーマル→ハード→エクストラ)を作成する場合:

```
group_id: achievement_2_101 (最初のミッションIDと同じ)

achievement_2_101, unlock_order: 1 (ノーマルクリア)
achievement_2_102, unlock_order: 2 (ハードクリア)
achievement_2_103, unlock_order: 3 (エクストラクリア)
```

#### 3.4 依存関係の設定方法

**重要**: 依存関係は、**順序解放が必要なミッショングループのみ**に設定します。全てのミッションに設定する必要はありません。

**依存関係が必要なミッションの例:**
- メインクエスト難易度別クリアミッション(ノーマル→ハード→エクストラ)
- 通算ログイン日数ミッション(7日→14日→30日...)
- 累積系ミッション(100回→500回→1000回...)

**依存関係が不要なミッションの例:**
- 独立したクエストクリアミッション
- 単発のユニット育成ミッション
- アカウント連携、SNSフォロー等の1回限りのミッション

**設定手順:**

1. 依存関係グループを特定する
2. 各グループの最初のミッションIDをgroup_idとして使用
3. 同じgroup_id内のミッションにunlock_order=1から順番に番号を振る
4. 依存関係が不要なミッションはMstMissionAchievementDependencyに含めない

#### 3.5 作成例

```
TABLE,MstMissionAchievementDependency,MstMissionAchievementDependency,MstMissionAchievementDependency,MstMissionAchievementDependency,MstMissionAchievementDependency,MstMissionAchievementDependency
ENABLE,id,release_key,group_id,mst_mission_achievement_id,unlock_order,備考
e,101,202512020,achievement_2_101,achievement_2_101,1,
e,102,202512020,achievement_2_101,achievement_2_102,2,
e,103,202512020,achievement_2_101,achievement_2_103,3,
```

上記の例:
- `achievement_2_101`グループ: メインクエストクリアミッション(1→2→3の順に解放)

### 4. MstMissionReward シートの作成

#### 4.1 シートスキーマ

このシートには、TABLE行、ENABLE行、データ行が含まれます。

**TABLE行** - 各カラムがどのテーブルに属するかを示します。

```
TABLE,MstMissionReward,MstMissionReward,MstMissionReward,MstMissionReward,MstMissionReward,MstMissionReward,MstMissionReward,MstMissionReward
```

**ENABLEと列名行** - カラム名を示します。

```
ENABLE,id,release_key,group_id,resource_type,resource_id,resource_amount,sort_order,備考
```

#### 4.2 各カラムの設定ルール

| カラム名 | 設定ルール |
|---------|-----------|
| **ENABLE** | 固定値: `e` (有効化) |
| **id** | 報酬の一意識別子。命名規則: `mission_reward_{連番}` |
| **release_key** | リリースキー。MstMissionAchievementと同じ値 |
| **group_id** | 報酬グループID。MstMissionAchievement.mst_mission_reward_group_idと対応 |
| **resource_type** | 報酬のリソースタイプ。下記の「resource_type設定一覧」を参照 |
| **resource_id** | リソースID。resource_typeに応じて設定。不要な場合は空欄 |
| **resource_amount** | 報酬の数量 |
| **sort_order** | 表示順序。複数報酬がある場合の並び順 |
| **備考** | 空欄にする |

#### resource_type設定一覧

ミッション報酬(MstMissionReward)で使用可能なresource_typeは以下の通りです。**大文字小文字を正確に一致**させてください。

| resource_type | 説明 | resource_id | 参照先テーブル | 主な用途 |
|--------------|------|------------|--------------|---------|
| **Coin** | コイン(ゲーム内通貨) | 不要(空欄) | - | ミッション報酬の定番 |
| **FreeDiamond** | 無償プリズム | 不要(空欄) | - | 重要なミッション報酬 |
| **Exp** | 経験値(プレイヤー経験値) | 不要(空欄) | - | クエストクリア報酬 |
| **Item** | アイテム(チケット、素材など) | **必要** | **MstItem** | ガシャチケット、育成素材 |
| **Emblem** | エンブレム(称号) | **必要** | **MstEmblem** | イベント達成報酬 |
| **Unit** | ユニット(キャラクター) | **必要** | **MstUnit** | ガシャ報酬、特別報酬 |

#### 4.3 作成例

```
TABLE,MstMissionReward,MstMissionReward,MstMissionReward,MstMissionReward,MstMissionReward,MstMissionReward,MstMissionReward,MstMissionReward
ENABLE,id,release_key,group_id,resource_type,resource_id,resource_amount,sort_order,備考
e,mission_reward_460,202512020,achievement_2_101,FreeDiamond,,50,1,
e,mission_reward_461,202512020,achievement_2_102,FreeDiamond,,50,1,
e,mission_reward_462,202512020,achievement_2_103,FreeDiamond,,50,1,
```

### 5. データ整合性のチェック

マスタデータ作成後、以下の項目を確認してください。

#### 5.1 必須チェック項目

- [ ] **ヘッダーの列順が正しいか**
  - スキーマファイルと完全一致している

- [ ] **IDの一意性**
  - すべてのidが一意である
  - 他のリリースのidと重複していない

- [ ] **ID採番ルール**
  - MstMissionAchievement.id: `achievement_{グループ番号}_{連番}`
    - 例: `achievement_1_001`, `achievement_2_101`
  - MstMissionAchievement.mst_mission_reward_group_id: idと同じ値
  - MstMissionAchievement.group_key: 常に空欄
  - MstMissionAchievementDependency.id: 連番(例: `101`, `102`, `103`...)
  - MstMissionAchievementDependency.group_id: 依存関係グループの最初のミッションIDと同じ
    - 例: `achievement_2_101` (そのグループの最初のミッション)
  - MstMissionReward.id: `mission_reward_{連番}`
    - 例: `mission_reward_460`, `mission_reward_461`
  - MstMissionReward.group_id: MstMissionAchievement.mst_mission_reward_group_idと同じ値

- [ ] **リレーションの整合性**
  - `MstMissionAchievement.mst_mission_reward_group_id` = `MstMissionReward.group_id`
  - `MstMissionAchievementDependency.mst_mission_achievement_id` がMstMissionAchievement.idに存在する
  - すべてのミッションにdescription.ja(説明文)が設定されている

- [ ] **criterion_typeの正確性**
  - 「criterion_type設定一覧」に記載されたいずれかを使用している
  - **大文字小文字が正確に一致している**(例: `SpecificQuestClear` ○, `specificquestclear` ×)
  - criterion_valueの設定有無が正しい(必要なタイプには設定、不要なタイプは空欄)
  - criterion_countが適切な値である

- [ ] **destination_sceneの正確性**
  - 「destination_scene設定ルール」に記載されたいずれかを使用している
  - criterion_typeに対応するdestination_sceneが設定されている
  - criterion_type一覧表の「destination_scene候補」列と一致している

- [ ] **resource_typeの正確性**
  - 「resource_type設定一覧」に記載された値を使用している
  - 大文字小文字が正確に一致している
  - resource_idの設定有無が正しい(必要なタイプには設定、不要なタイプは空欄)

- [ ] **unlock設定の統一性**
  - unlock_criterion_typeは通常 `__NULL__`
  - unlock_criterion_valueは通常空欄
  - unlock_criterion_countは通常 `0`

- [ ] **数値の妥当性**
  - criterion_count, resource_amount, sort_orderが正の整数である

- [ ] **仕様書、設計書の内容で、正確に漏れなく、マスタデータを作成できているかを、必ず確認する。全て正確に作り終えるまで、作業を終えてはいけません**

#### 5.2 推奨チェック項目

- [ ] **命名規則の統一**
  - idのプレフィックスが統一されている

- [ ] **説明文の品質**
  - 誤字脱字がない
  - ユーザーが理解しやすい表現である

- [ ] **依存関係の妥当性**
  - unlock_orderが1から連番で設定されている
  - 同じgroup_id内で欠番がない

- [ ] **destination_sceneとcriterion_typeの組み合わせの一貫性**
  - 同じcriterion_typeのミッションは同じdestination_sceneを使用している
  - ユーザーが混乱しない遷移先設定になっている

### 6. 出力フォーマット

最終的な出力は以下の3シート構成で行います。

#### 6.1 MstMissionAchievement シート

| TABLE | MstMissionAchievement | MstMissionAchievement | MstMissionAchievement | MstMissionAchievement | MstMissionAchievement | MstMissionAchievement | MstMissionAchievement | MstMissionAchievement | MstMissionAchievement | MstMissionAchievement | MstMissionAchievement | MstMissionAchievement | MstMissionAchievementI18n |
|-------|----------------------|----------------------|----------------------|----------------------|----------------------|----------------------|----------------------|----------------------|----------------------|----------------------|----------------------|----------------------|-----------------------------|
| **ENABLE** | **id** | **release_key** | **criterion_type** | **criterion_value** | **criterion_count** | **unlock_criterion_type** | **unlock_criterion_value** | **unlock_criterion_count** | **group_key** | **mst_mission_reward_group_id** | **sort_order** | **destination_scene** | **description.ja** |
| e | achievement_2_101 | 202512020 | SpecificQuestClear | quest_main_osh_normal_17 | 1 | `__NULL__` | | 0 | | achievement_2_101 | 101 | QuestSelect | メインクエスト「【推しの子】」の難易度ノーマルをクリアしよう |
| e | achievement_2_102 | 202512020 | SpecificQuestClear | quest_main_osh_hard_17 | 1 | `__NULL__` | | 0 | | achievement_2_102 | 102 | QuestSelect | メインクエスト「【推しの子】」の難易度ハードをクリアしよう |

**注意**: group_keyカラムは常に空欄です。

#### 6.2 MstMissionAchievementDependency シート

| TABLE | MstMissionAchievementDependency | MstMissionAchievementDependency | MstMissionAchievementDependency | MstMissionAchievementDependency | MstMissionAchievementDependency | MstMissionAchievementDependency |
|-------|--------------------------------|--------------------------------|--------------------------------|--------------------------------|--------------------------------|--------------------------------|
| **ENABLE** | **id** | **release_key** | **group_id** | **mst_mission_achievement_id** | **unlock_order** | **備考** |
| e | 101 | 202512020 | achievement_2_101 | achievement_2_101 | 1 | |
| e | 102 | 202512020 | achievement_2_101 | achievement_2_102 | 2 | |

#### 6.3 MstMissionReward シート

| TABLE | MstMissionReward | MstMissionReward | MstMissionReward | MstMissionReward | MstMissionReward | MstMissionReward | MstMissionReward | MstMissionReward |
|-------|-----------------|-----------------|-----------------|-----------------|-----------------|-----------------|-----------------|-----------------|
| **ENABLE** | **id** | **release_key** | **group_id** | **resource_type** | **resource_id** | **resource_amount** | **sort_order** | **備考** |
| e | mission_reward_460 | 202512020 | achievement_2_101 | FreeDiamond | | 50 | 1 | |
| e | mission_reward_461 | 202512020 | achievement_2_102 | FreeDiamond | | 50 | 1 | |

#### 重要なポイント

- **TABLE行は必須**: 各シートの先頭にTABLE行を含める
- **3シート構成**: MstMissionAchievement、MstMissionAchievementDependency、MstMissionRewardの3シート
- **I18nはカラムとして統合**: description.jaカラムでI18n情報を管理
- **依存関係は必要に応じて**: 順序解放が必要なミッショングループのみMstMissionAchievementDependencyを設定
- **仕様書、設計書の内容で、正確に漏れなく、マスタデータを作成できているかを、必ず確認する。全て正確に作り終えるまで、作業を終えてはいけません**
