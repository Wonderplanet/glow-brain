# イベントミッション マスタデータ設定手順書

## 概要

イベントミッションのマスタデータ作成手順を記載します。
本手順書に従うことで、ゲーム内でエラーが発生しない正確なマスタデータを作成できます。

## この手順を始める前に必要な情報

### 入力情報

以下の情報を事前に準備してください。

| 項目 | 説明 | 例 |
|------|------|-----|
| **リリースキー** | マスタデータのリリースキー | `202512020` |
| **作品ID** | 対象作品の識別子 | `osh`, `kai`, `glo` |
| **イベントID** | 対象イベントのマスタID | `event_osh_00001` |

### 必要な運営仕様書・設計書

以下のファイルを参照します。

| ファイル | 説明 | パス例 |
|---------|------|--------|
| **ミッション仕様書** | イベントミッションの達成条件・報酬内容 | `マスタデータ/運営仕様/<イベント名>/要件/04_ミッション.xlsx` |
| **概要・リソース情報** | 新規リソースID情報 | `マスタデータ/運営仕様/<イベント名>/要件/01_概要.xlsx` |

### 参照する技術資料

| 資料 | 説明 | 場所 |
|------|------|------|
| **ミッショントリガー一覧** | criterion_typeの定義一覧 | `domain/raw-data/google-drive/spread-sheet/GLOW/040_エンジニアリング/共通/ミッショントリガー一覧.csv` |
| **DBスキーマ** | テーブル定義 | `projects/glow-server/api/database/schema/exports/master_tables_schema.json` |

---

## 対象テーブル

イベントミッションでは、以下の4ファイルでマスタデータを作成します。

| ファイル名 | 説明 |
|-----------|------|
| **MstMissionEvent.csv** | イベントミッションの基本情報 |
| **MstMissionEventI18n.csv** | イベントミッションの説明文（多言語対応） |
| **MstMissionEventDependency.csv** | ミッション間の解放順序の依存関係 |
| **MstMissionReward.csv** | ミッション報酬 |

---

## 作成フロー

### 1. 仕様書の確認

運営仕様書から以下の情報を抽出します。

**必要情報**:
- ミッションの達成条件（何を何回実行するか）
- ミッションの報酬内容
- イベントID（mst_event_id）
- ミッションの表示順序
- ミッション説明文（日本語）
- ミッション間の依存関係（順序解放の有無）

---

### 2. MstMissionEvent.csv の作成

#### 2.1 CSVヘッダー

```csv
ENABLE,id,release_key,mst_event_id,criterion_type,criterion_value,criterion_count,unlock_criterion_type,unlock_criterion_value,unlock_criterion_count,group_key,mst_mission_reward_group_id,sort_order,destination_scene
```

#### 2.2 各カラムの設定ルール

| カラム名 | 設定ルール |
|---------|-----------|
| **ENABLE** | 固定値: `e` (有効化) |
| **id** | ミッションの一意識別子。命名規則: `event_{作品ID}_{イベント連番5桁}_{ミッション連番}` |
| **release_key** | リリースキー。例: `202512020` |
| **mst_event_id** | イベントID。MstEventテーブルのidと対応。例: `event_osh_00001`, `event_glo_00001` |
| **criterion_type** | 達成条件タイプ。下記の「criterion_type設定一覧」を参照 |
| **criterion_value** | 条件の指定値。criterion_typeに応じて設定。不要な場合は空欄 |
| **criterion_count** | 条件の回数。例: `5`(5回クリア) |
| **unlock_criterion_type** | 解放条件タイプ。通常は `__NULL__` (依存関係はMstMissionEventDependencyで管理) |
| **unlock_criterion_value** | 解放条件の値。通常は空欄 |
| **unlock_criterion_count** | 解放条件の回数。通常は `0` |
| **group_key** | グループキー。**イベントミッションでは使用しない**。常に空欄 |
| **mst_mission_reward_group_id** | 報酬グループID。MstMissionRewardのgroup_idと対応。下記の「mst_mission_reward_group_id採番ルール」を参照 |
| **sort_order** | 表示順序。小さい数字ほど上位に表示。例: `1`, `2`, `3`... |
| **destination_scene** | タップ時の遷移先シーン。例: `Event`, `Gacha` |

#### 2.3 criterion_type設定一覧

イベントミッション（mst_event_id指定）で使用可能なcriterion_typeは、`domain/raw-data/google-drive/spread-sheet/GLOW/040_エンジニアリング/共通/ミッショントリガー一覧.csv`に記載されています。

**重要**: **大文字小文字を正確に一致**させてください。

**よく使用されるcriterion_type例**:

| criterion_type | 説明 | criterion_value | criterion_count |
|---------------|------|-----------------|-----------------|
| **StageClearCount** | ステージクリア回数 | 不要（空欄） | 回数（例: 5） |
| **SpecificQuestClear** | 特定クエストクリア | クエストID | 回数（例: 1） |
| **SpecificGachaDrawCount** | 特定ガシャ引き回数 | ガシャID | 回数（例: 10） |
| **SpecificUnitStageClearCount** | 特定ユニット編成でクリア | ユニットID.ステージID | 回数（例: 1） |
| **SpecificUnitGradeUpCount** | 特定ユニットのグレードアップ回数 | ユニットID | 回数（例: 2） |
| **SpecificUnitLevel** | 特定ユニットのレベル到達 | ユニットID | レベル（例: 20） |
| **DefeatEnemyCount** | 敵撃破数 | 不要（空欄） | 撃破数（例: 50） |
| **DefeatBossEnemyCount** | ボス敵撃破数 | 不要（空欄） | 撃破数（例: 10） |

#### 2.4 destination_scene設定ルール

`destination_scene`は、ミッションをタップした時にユーザーが遷移する画面を指定します。

**destination_scene一覧**:

| destination_scene | 説明 | 主な用途 |
|------------------|------|---------|
| **Event** | イベント画面 | イベント関連ミッション（最も使用頻度が高い） |
| **UnitList** | ユニット一覧画面 | ユニット育成系ミッション |
| **Gacha** | ガシャ画面 | ガシャ引き回数ミッション |
| **QuestSelect** | クエスト選択画面 | クエスト・原画・エンブレム系ミッション |
| **Home** | ホーム画面 | ログイン・プレイヤーレベル系ミッション |
| **StageSelect** | ステージ選択画面 | コイン収集・通常ステージ系ミッション |
| **OutpostEnhance** | ゲート強化画面 | ゲート強化系ミッション |
| **IdleIncentive** | 放置報酬画面 | 探索系ミッション |
| **Pvp** | 決闘画面 | 決闘系ミッション |
| **Web** | Web遷移 | SNSフォロー・レビュー・外部サイト系 |
| **LinkBnId** | アカウント連携画面 | アカウント連携系ミッション |
| **(空欄)** | 遷移なし | ボーナスポイント累積系ミッション |

**複数のdestination_scene候補がある場合**:

以下のcriterion_typeは、イベントミッションと通常ミッションで異なるdestination_sceneを使用します。

| criterion_type | イベントミッション | 通常ミッション |
|---------------|------------------|---------------|
| DefeatEnemyCount | Event | StageSelect |
| DefeatBossEnemyCount | Event | StageSelect |
| SpecificQuestClear | Event | QuestSelect |
| SpecificSeriesEnemyDiscoveryCount | Event | StageSelect |
| EnemyDiscoveryCount | Event | StageSelect |
| SpecificEnemyDiscoveryCount | Event | StageSelect |

**イベントミッションでの推奨設定**:
- イベント関連のミッションは基本的に `Event` を設定
- ガシャ引き回数ミッションは `Gacha`
- ユニット育成系ミッションは `UnitList`

#### 2.5 イベントミッション固有の設定

イベントミッションでは、以下のように設定します。

- **mst_event_id**: イベントIDを必ず指定（例: `event_osh_00001`）
- **criterion_type**: 上記のcriterion_type一覧から選択。イベントミッションで頻繁に使用されるものを優先的に検討
- **criterion_value**: criterion_typeに応じて設定（不要な場合は空欄）
- **criterion_count**: 達成に必要な回数またはレベル・数量
- **unlock_criterion_type**: 通常は `__NULL__` (依存関係はMstMissionEventDependencyで管理)
- **unlock_criterion_value**: 通常は空欄
- **unlock_criterion_count**: 通常は `0`
- **group_key**: 常に空欄（イベントミッションでは使用しない）
- **destination_scene**: criterion_typeに応じて設定。上記の「destination_scene設定ルール」を参照

#### 2.6 mst_mission_reward_group_id採番ルール

イベントミッションの報酬グループIDは、以下の形式で採番します。

```
{作品ID}_{イベント連番5桁}_event_reward_{報酬段階}
```

**パラメータ:**
- `作品ID`: 3文字の作品識別子
  - osh = 推しの子
  - kai = 怪獣8号
  - glo = GLOW全体
- `イベント連番5桁`: イベントごとに採番（00001からゼロパディング）
- `報酬段階`: 報酬のステップ番号

**報酬段階のゼロパディングルール:**
- **通常**: 2桁ゼロパディング（01, 02, 03...28）
- **例外（osh: 推しの子のみ）**: ゼロパディングなし（1, 2, 3...53）

**採番例:**
```
kai_00001_event_reward_01   (怪獣8号 イベント1 報酬段階1)
kai_00001_event_reward_28   (怪獣8号 イベント1 報酬段階28)
osh_00001_event_reward_1    (推しの子 イベント1 報酬段階1)
osh_00001_event_reward_53   (推しの子 イベント1 報酬段階53)
glo_00001_event_reward_01   (GLOW全体 イベント1 報酬段階1)
```

**重要な注意点:**
- ミッションIDの連番と報酬段階の連番は必ずしも一致しない
- 同じ報酬段階番号を複数のミッションで共有しない（1ミッション = 1報酬グループ）

#### 2.7 作成例

```csv
ENABLE,id,release_key,mst_event_id,criterion_type,criterion_value,criterion_count,unlock_criterion_type,unlock_criterion_value,unlock_criterion_count,group_key,mst_mission_reward_group_id,sort_order,destination_scene
e,event_osh_00001_1,202512020,event_osh_00001,StageClearCount,,5,__NULL__,,0,,osh_00001_event_reward_1,1,Event
e,event_osh_00001_2,202512020,event_osh_00001,StageClearCount,,10,__NULL__,,0,,osh_00001_event_reward_2,2,Event
e,event_osh_00001_28,202512020,event_osh_00001,SpecificGachaDrawCount,gasho_001,10,__NULL__,,0,,osh_00001_event_reward_28,28,Gacha
e,event_osh_00001_33,202512020,event_osh_00001,SpecificUnitStageClearCount,chara_osh_00601.event_osh1_1day_00001,1,__NULL__,,0,,osh_00001_event_reward_33,33,Event
e,event_kai_00001_1,202509010,event_kai_00001,SpecificUnitGradeUpCount,chara_kai_00601,2,__NULL__,,0,,kai_00001_event_reward_01,1,UnitList
```

---

### 3. MstMissionEventI18n.csv の作成

#### 3.1 CSVヘッダー

```csv
ENABLE,release_key,id,mst_mission_event_id,language,description
```

#### 3.2 各カラムの設定ルール

| カラム名 | 設定ルール |
|---------|-----------|
| **ENABLE** | 固定値: `e` (有効化) |
| **release_key** | リリースキー。MstMissionEventと同じ値 |
| **id** | I18nレコードの一意識別子。命名規則: `{mst_mission_event_id}_{language}` |
| **mst_mission_event_id** | ミッションID。MstMissionEvent.idと対応 |
| **language** | 言語コード。例: `ja`（日本語） |
| **description** | ミッション説明文。ユーザーに表示される文言 |

#### 3.3 説明文作成のポイント

- イベント名を明記する（例: 「ファンと推し合戦!」）
- 達成条件を明確に記載する（例: 「5回クリア」）
- ユーザーフレンドリーな表現にする
- 文末は「〜しよう」形式が推奨
- 特別な演出がある場合は【】で強調する（例: 【汗が輝いてるよ!】）

#### 3.4 作成例

```csv
ENABLE,release_key,id,mst_mission_event_id,language,description
e,202512020,event_osh_00001_1_ja,event_osh_00001_1,ja,ステージを5回クリアしよう
e,202512020,event_osh_00001_2_ja,event_osh_00001_2,ja,ステージを10回クリアしよう
e,202512020,event_osh_00001_28_ja,event_osh_00001_28,ja,賀正ガシャ2026を10回引こう
e,202512020,event_osh_00001_33_ja,event_osh_00001_33,ja,【汗が輝いてるよ!】ぴえヨンを編成に入れて「ファンと推し合戦!」を1回クリア
e,202509010,event_kai_00001_1_ja,event_kai_00001_1,ja,古橋 伊春 をグレード2まで強化しよう
```

---

### 4. MstMissionEventDependency.csv の作成

#### 4.1 CSVヘッダー

```csv
ENABLE,id,release_key,group_id,mst_mission_event_id,unlock_order,備考
```

#### 4.2 各カラムの設定ルール

| カラム名 | 設定ルール |
|---------|-----------|
| **ENABLE** | 固定値: `e` (有効化) |
| **id** | 依存関係の一意識別子。命名規則: `mission_event_dependency_{group_id}_{連番}` |
| **release_key** | リリースキー。MstMissionEventと同じ値 |
| **group_id** | 依存関係のグループID。下記の「group_id採番ルール」を参照 |
| **mst_mission_event_id** | ミッションID。MstMissionEvent.idと対応 |
| **unlock_order** | 解放順序。1から順番に設定 |
| **備考** | 空欄にする |

#### 4.3 group_id採番ルール

MstMissionEventDependencyの`group_id`は、**依存関係グループの最初のミッションIDと同じ値**を使用します。

**採番パターン:**
```
event_{作品ID}_{イベント連番}_{ミッション連番}
```

**重要な原則:**
- group_idは、そのグループで**最初に解放されるミッション（unlock_order=1）のミッションID**と同じ
- 同じgroup_id内のミッションは、unlock_orderの順番に解放される
- group_idが異なる場合は、それぞれ独立した依存関係グループとして管理される

**実例:**

| group_id | 含まれるミッション | unlock_order | 説明 |
|----------|------------------|--------------|------|
| event_osh_00001_1 | event_osh_00001_1 | 1 | ステージクリア回数ミッション（1番目） |
| event_osh_00001_1 | event_osh_00001_2 | 2 | ステージクリア回数ミッション（2番目） |
| event_osh_00001_1 | event_osh_00001_3 | 3 | ステージクリア回数ミッション（3番目） |
| event_osh_00001_1 | event_osh_00001_27 | 27 | ステージクリア回数ミッション（27番目） |
| event_osh_00001_28 | event_osh_00001_28 | 1 | ガシャミッション（1番目） |
| event_osh_00001_28 | event_osh_00001_29 | 2 | ガシャミッション（2番目） |
| event_osh_00001_28 | event_osh_00001_32 | 5 | ガシャミッション（5番目） |
| event_osh_00001_33 | event_osh_00001_33 | 1 | 特定ユニット編成ミッション（1番目） |
| event_osh_00001_33 | event_osh_00001_34 | 2 | 特定ユニット編成ミッション（2番目） |
| event_osh_00001_33 | event_osh_00001_35 | 3 | 特定ユニット編成ミッション（3番目） |

**設定方法:**

1. 依存関係を持つミッションのグループを特定する
2. そのグループの最初のミッションIDをgroup_idとして使用する
3. 同じgroup_id内のミッションに、unlock_order=1から順番に番号を振る

**例:**

ステージクリア回数ミッション（5回→10回→15回→20回）を作成する場合:

```
group_id: event_osh_00001_1 (最初のミッションIDと同じ)

event_osh_00001_1, unlock_order: 1 (5回クリア)
event_osh_00001_2, unlock_order: 2 (10回クリア)
event_osh_00001_3, unlock_order: 3 (15回クリア)
event_osh_00001_4, unlock_order: 4 (20回クリア)
```

#### 4.4 依存関係の設定方法

**重要**: 依存関係は、**順序解放が必要なミッショングループのみ**に設定します。全てのミッションに設定する必要はありません。

**依存関係が必要なミッションの例:**
- ステージクリア回数ミッション（5回→10回→15回→20回...）
- ガシャ引き回数ミッション（10回→20回→30回→40回...）
- 特定ユニット編成でのクリア回数ミッション（1回→3回→5回...）
- 敵撃破数ミッション（50体→100体→200体...）
- ユニットレベル/グレードアップミッション（Lv.10→Lv.20→Lv.30...）

**依存関係が不要なミッションの例:**
- 単発の特定クエストクリアミッション
- 独立したガシャミッション（他のミッションと依存関係がない場合）
- アカウント連携、SNSフォロー等の1回限りのミッション

**設定手順:**

1. 依存関係グループを特定する
2. 各グループの最初のミッションIDをgroup_idとして使用
3. 同じgroup_id内のミッションにunlock_order=1から順番に番号を振る
4. 依存関係が不要なミッションはMstMissionEventDependencyに含めない

#### 4.5 作成例

```csv
ENABLE,id,release_key,group_id,mst_mission_event_id,unlock_order,備考
e,mission_event_dependency_event_osh_00001_1_1,202512020,event_osh_00001_1,event_osh_00001_1,1,
e,mission_event_dependency_event_osh_00001_1_2,202512020,event_osh_00001_1,event_osh_00001_2,2,
e,mission_event_dependency_event_osh_00001_1_3,202512020,event_osh_00001_1,event_osh_00001_3,3,
e,mission_event_dependency_event_osh_00001_1_4,202512020,event_osh_00001_1,event_osh_00001_4,4,
e,mission_event_dependency_event_osh_00001_28_1,202512020,event_osh_00001_28,event_osh_00001_28,1,
e,mission_event_dependency_event_osh_00001_28_2,202512020,event_osh_00001_28,event_osh_00001_29,2,
e,mission_event_dependency_event_osh_00001_28_3,202512020,event_osh_00001_28,event_osh_00001_30,3,
```

上記の例:
- `event_osh_00001_1`グループ: ステージクリア回数ミッション（1→2→3→4の順に解放）
- `event_osh_00001_28`グループ: ガシャミッション（28→29→30の順に解放）

---

### 5. MstMissionReward.csv の作成

#### 5.1 CSVヘッダー

```csv
ENABLE,id,release_key,group_id,resource_type,resource_id,resource_amount,sort_order,備考
```

#### 5.2 各カラムの設定ルール

| カラム名 | 設定ルール |
|---------|-----------|
| **ENABLE** | 固定値: `e` (有効化) |
| **id** | 報酬の一意識別子。命名規則: `mission_reward_{group_id}_{連番}` |
| **release_key** | リリースキー。MstMissionEventと同じ値 |
| **group_id** | 報酬グループID。MstMissionEvent.mst_mission_reward_group_idと対応 |
| **resource_type** | 報酬のリソースタイプ。下記の「resource_type設定一覧」を参照 |
| **resource_id** | リソースID。resource_typeに応じて設定。不要な場合は空欄 |
| **resource_amount** | 報酬の数量 |
| **sort_order** | 表示順序。複数報酬がある場合の並び順 |
| **備考** | 空欄にする |

#### 5.3 resource_type設定一覧

ミッション報酬（MstMissionReward）で使用可能なresource_typeは以下の通りです。**大文字小文字を正確に一致**させてください。

| resource_type | 説明 | resource_id | 参照先テーブル | 主な用途 |
|--------------|------|------------|--------------|---------|
| **Coin** | コイン（ゲーム内通貨） | 不要（空欄） | - | ミッション報酬の定番 |
| **FreeDiamond** | 無償プリズム | 不要（空欄） | - | 重要なミッション報酬 |
| **Exp** | 経験値（プレイヤー経験値） | 不要（空欄） | - | クエストクリア報酬 |
| **Item** | アイテム（チケット、素材など） | **必要** | **MstItem** | ガシャチケット、育成素材 |
| **Emblem** | エンブレム（称号） | **必要** | **MstEmblem** | イベント達成報酬 |
| **Unit** | ユニット（キャラクター） | **必要** | **MstUnit** | ガシャ報酬、特別報酬 |

#### 5.4 作成例

```csv
ENABLE,id,release_key,group_id,resource_type,resource_id,resource_amount,sort_order,備考
e,mission_reward_osh_00001_event_reward_1_1,202512020,osh_00001_event_reward_1,Item,ticket_glo_10001,2,1,
e,mission_reward_osh_00001_event_reward_5_1,202512020,osh_00001_event_reward_5,FreeDiamond,,50,1,
e,mission_reward_osh_00001_event_reward_33_1,202512020,osh_00001_event_reward_33,Coin,,1000,1,
e,mission_reward_osh_00001_event_reward_41_1,202512020,osh_00001_event_reward_41,Emblem,emblem_event_osh_00008,1,1,
```

---

## データ整合性のチェック

マスタデータ作成後、以下の項目を確認してください。

### 必須チェック項目

- [ ] **ヘッダーの列順が正しいか**
  - 上記のCSVヘッダーと完全一致している

- [ ] **IDの一意性**
  - すべてのidが一意である
  - 他のリリースのidと重複していない

- [ ] **ID採番ルール**
  - MstMissionEvent.id: `event_{作品ID}_{イベント連番5桁}_{ミッション連番}`
    - 例: `event_osh_00001_1`, `event_kai_00001_28`
  - MstMissionEvent.mst_event_id: MstEventテーブルに存在するイベントID
    - 例: `event_osh_00001`, `event_glo_00001`
  - MstMissionEvent.mst_mission_reward_group_id: `{作品ID}_{イベント連番5桁}_event_reward_{報酬段階}`
    - 通常: 2桁ゼロパディング（例: `kai_00001_event_reward_01`）
    - 例外（osh）: ゼロパディングなし（例: `osh_00001_event_reward_1`）
  - MstMissionEvent.group_key: 常に空欄
  - MstMissionEventI18n.id: `{mst_mission_event_id}_{language}`
    - 例: `event_osh_00001_ja`, `event_kai_00001_ja`
  - MstMissionEventDependency.id: `mission_event_dependency_{group_id}_{連番}`
    - 例: `mission_event_dependency_event_osh_00001_1_1`
  - MstMissionEventDependency.group_id: 依存関係グループの最初のミッションIDと同じ
    - 例: `event_osh_00001_1`（そのグループの最初のミッション）
  - MstMissionReward.id: `mission_reward_{group_id}_{連番}`
    - 例: `mission_reward_osh_00001_event_reward_1_1`, `mission_reward_kai_00001_event_reward_01_1`
  - MstMissionReward.group_id: MstMissionEvent.mst_mission_reward_group_idと同じ値

- [ ] **リレーションの整合性**
  - `MstMissionEvent.mst_mission_reward_group_id` = `MstMissionReward.group_id`
  - `MstMissionEventDependency.mst_mission_event_id` がMstMissionEvent.idに存在する
  - `MstMissionEventI18n.mst_mission_event_id` がMstMissionEvent.idに存在する
  - すべてのミッションにdescription（説明文）が設定されている

- [ ] **criterion_typeの正確性**
  - 「criterion_type設定一覧」に記載されたいずれかを使用している
  - **大文字小文字が正確に一致している**（例: `StageClearCount` ○, `stageclearcount` ×）
  - criterion_valueの設定有無が正しい（必要なタイプには設定、不要なタイプは空欄）
  - criterion_countが適切な値である

- [ ] **destination_sceneの正確性**
  - 「destination_scene設定ルール」に記載されたいずれかを使用している
  - criterion_typeに対応するdestination_sceneが設定されている
  - 複数候補がある場合は、イベントミッションでは`Event`を優先的に使用している
    - 例: DefeatEnemyCount → Event（イベント） / StageSelect（通常）

- [ ] **resource_typeの正確性**
  - 「resource_type設定一覧」に記載された値を使用している
  - 大文字小文字が正確に一致している
  - resource_idの設定有無が正しい（必要なタイプには設定、不要なタイプは空欄）

- [ ] **unlock設定の統一性**
  - unlock_criterion_typeは通常 `__NULL__`
  - unlock_criterion_valueは通常空欄
  - unlock_criterion_countは通常 `0`

- [ ] **数値の妥当性**
  - criterion_count, resource_amount, sort_orderが正の整数である

- [ ] **仕様書、設計書の内容との整合性**
  - 運営仕様書のミッション内容が正確に漏れなくマスタデータに反映されているか

### 推奨チェック項目

- [ ] **命名規則の統一**
  - idのプレフィックスが統一されている

- [ ] **説明文の品質**
  - 誤字脱字がない
  - ユーザーが理解しやすい表現である

- [ ] **依存関係の妥当性**
  - unlock_orderが1から連番で設定されている
  - 同じgroup_id内で欠番がない

- [ ] **destination_sceneとcriterion_typeの組み合わせの一貫性**
  - 同じcriterion_typeのミッションは同じdestination_sceneを使用している
  - イベント内で一貫性のあるdestination_scene設定になっている
  - ユーザーが混乱しない遷移先設定になっている

---

## 出力形式

最終的な出力は以下の4ファイル構成で行います。

### 1. MstMissionEvent.csv

```csv
ENABLE,id,release_key,mst_event_id,criterion_type,criterion_value,criterion_count,unlock_criterion_type,unlock_criterion_value,unlock_criterion_count,group_key,mst_mission_reward_group_id,sort_order,destination_scene
e,event_osh_00001_1,202512020,event_osh_00001,StageClearCount,,5,__NULL__,,0,,osh_00001_event_reward_1,1,Event
e,event_osh_00001_2,202512020,event_osh_00001,StageClearCount,,10,__NULL__,,0,,osh_00001_event_reward_2,2,Event
e,event_kai_00001_1,202509010,event_kai_00001,SpecificUnitGradeUpCount,chara_kai_00601,2,__NULL__,,0,,kai_00001_event_reward_01,1,UnitList
```

**注意**: group_keyカラムは常に空欄です。

### 2. MstMissionEventI18n.csv

```csv
ENABLE,release_key,id,mst_mission_event_id,language,description
e,202512020,event_osh_00001_1_ja,event_osh_00001_1,ja,ステージを5回クリアしよう
e,202512020,event_osh_00001_2_ja,event_osh_00001_2,ja,ステージを10回クリアしよう
e,202509010,event_kai_00001_1_ja,event_kai_00001_1,ja,古橋 伊春 をグレード2まで強化しよう
```

### 3. MstMissionEventDependency.csv

```csv
ENABLE,id,release_key,group_id,mst_mission_event_id,unlock_order,備考
e,mission_event_dependency_event_osh_00001_1_1,202512020,event_osh_00001_1,event_osh_00001_1,1,
e,mission_event_dependency_event_osh_00001_1_2,202512020,event_osh_00001_1,event_osh_00001_2,2,
```

### 4. MstMissionReward.csv

```csv
ENABLE,id,release_key,group_id,resource_type,resource_id,resource_amount,sort_order,備考
e,mission_reward_osh_00001_event_reward_1_1,202512020,osh_00001_event_reward_1,Item,ticket_glo_10001,2,1,
e,mission_reward_osh_00001_event_reward_5_1,202512020,osh_00001_event_reward_5,FreeDiamond,,50,1,
```

---

## 重要なポイント

- **4ファイル構成**: MstMissionEvent、MstMissionEventI18n、MstMissionEventDependency、MstMissionRewardの4ファイル
- **I18nは別ファイル**: description（説明文）はMstMissionEventI18nで管理
- **依存関係は必要に応じて**: 順序解放が必要なミッショングループのみMstMissionEventDependencyを設定
- **ID採番ルールに注意**: 特にMstMissionEventDependency.idは単純な連番（1, 2, 3...）
- **運営仕様書との整合性**: 仕様書、設計書の内容で、正確に漏れなく、マスタデータを作成できているかを必ず確認する

---

## 参考資料

- **DBスキーマ**: `projects/glow-server/api/database/schema/exports/master_tables_schema.json`
- **ミッショントリガー一覧**: `domain/raw-data/google-drive/spread-sheet/GLOW/040_エンジニアリング/共通/ミッショントリガー一覧.csv`
- **既存マスタデータ**: `projects/glow-masterdata/MstMission*.csv`
