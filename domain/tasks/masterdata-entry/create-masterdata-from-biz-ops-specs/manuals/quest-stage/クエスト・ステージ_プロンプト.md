# クエスト・ステージ マスタデータ作成プロンプト

## 概要

このプロンプトは、運営仕様書とクエスト設計書からクエスト・ステージのマスタデータCSVを作成するために使用します。

## プロンプト

```
あなたは、GLOWプロジェクトのマスタデータ作成を支援するエキスパートです。
以下の仕様書を元に、クエスト・ステージのマスタデータCSVを作成してください。

# インプット資料

1. **運営仕様書**: {運営仕様書のパス}
2. **クエスト設計書**: {クエスト設計書のパス}
3. **マスタデータ設定手順書**: domain/tasks/masterdata-entry/create-masterdata-from-biz-ops-specs/manuals/quest-stage/クエスト・ステージ_マスタデータ設定手順書.md

# 作成するマスタデータCSV

以下の10個のCSVファイルを作成してください。

## 1. MstQuest.csv

**目的**: クエストの基本情報を定義します。

**手順**:
1. 運営仕様書・クエスト設計書から以下の情報を抽出:
   - クエスト名
   - クエストタイプ(event、raid、story、enhance)
   - イベントID
   - 開催期間(開始日時・終了日時)
   - 難易度(Normal、Hard、VeryHard)
2. IDを採番: `quest_event_{series_id}{連番}_{クエストタイプ略称}`
3. quest_groupを設定: `event_{series_id}{連番}_{識別子}`
4. CSVフォーマットに従ってデータを作成

**スキーマ**:
```
ENABLE,id,quest_type,mst_event_id,sort_order,asset_key,start_date,end_date,quest_group,difficulty,release_key
```

**作成例**:
```
ENABLE,id,quest_type,mst_event_id,sort_order,asset_key,start_date,end_date,quest_group,difficulty,release_key
e,quest_event_jig1_charaget01,event,event_jig_00001,1,jig1_charaget01,"2026-01-16 15:00:00","2026-02-16 10:59:59",event_jig1_charaget_mei,Normal,202601010
e,quest_event_jig1_1day,event,event_jig_00001,5,jig1_1day,"2026-01-16 15:00:00","2026-02-2 03:59:59",event_jig1_1day,Normal,202601010
```

## 2. MstQuestI18n.csv

**目的**: クエスト名と説明文を定義します(多言語対応)。

**手順**:
1. 監修資料・設計書からクエスト名とカテゴリ名を抽出
2. IDを採番: `{mst_quest_id}_{language}`
3. 日本語(ja)は必須、他言語は設計書に応じて設定
4. CSVフォーマットに従ってデータを作成

**スキーマ**:
```
ENABLE,release_key,id,mst_quest_id,language,name,category_name,flavor_text
```

**作成例**:
```
ENABLE,release_key,id,mst_quest_id,language,name,category_name,flavor_text
e,202601010,quest_event_jig1_charaget01_ja,quest_event_jig1_charaget01,ja,必ず生きて帰る,ストーリー,
e,202601010,quest_event_jig1_1day_ja,quest_event_jig1_1day,ja,"本能が告げている 危険だと",デイリー,
```

## 3. MstQuestBonusUnit.csv

**目的**: クエスト特効キャラとボーナス率を定義します。

**手順**:
1. 設計書から特効キャラとボーナス率を抽出
2. IDを連番で採番
3. coin_bonus_rateを設定(0.05～0.2程度)
4. 特効期間を設定(通常はクエスト開催期間と同じ)
5. CSVフォーマットに従ってデータを作成

**スキーマ**:
```
ENABLE,id,mst_quest_id,mst_unit_id,coin_bonus_rate,start_at,end_at,release_key
```

**作成例**:
```
ENABLE,id,mst_quest_id,mst_unit_id,coin_bonus_rate,start_at,end_at,release_key
e,58,quest_enhance_00001,chara_jig_00001,0.15,"2026-01-16 15:00:00","2026-02-16 10:59:59",202601010
e,62,quest_enhance_00001,chara_jig_00401,0.2,"2026-01-16 15:00:00","2026-02-16 10:59:59",202601010
```

## 4. MstStage.csv

**目的**: ステージの基本情報を定義します。

**手順**:
1. 設計書から各ステージの情報を抽出:
   - ステージ番号
   - 推奨レベル、スタミナコスト、経験値、コイン
   - 周回設定(AfterClear、__NULL__)
   - 前提ステージID
   - 原画欠片ドロップグループID(ストーリークエストのみ)
2. IDを採番: `{クエストタイプ略称}_{連番5桁}`
3. CSVフォーマットに従ってデータを作成

**スキーマ**:
```
ENABLE,id,mst_quest_id,mst_in_game_id,stage_number,recommended_level,cost_stamina,exp,coin,prev_mst_stage_id,mst_stage_tips_group_id,auto_lap_type,max_auto_lap_count,sort_order,asset_key,mst_stage_limit_status_id,release_key,mst_artwork_fragment_drop_group_id,start_at,end_at
```

**作成例**:
```
ENABLE,id,mst_quest_id,mst_in_game_id,stage_number,recommended_level,cost_stamina,exp,coin,prev_mst_stage_id,mst_stage_tips_group_id,auto_lap_type,max_auto_lap_count,sort_order,asset_key,mst_stage_limit_status_id,release_key,mst_artwork_fragment_drop_group_id,start_at,end_at
e,event_jig1_charaget01_00001,quest_event_jig1_charaget01,event_jig1_charaget01_00001,1,10,5,50,100,,1,AfterClear,5,1,event_jig1_00001,,202601010,event_jig_a_0001,"2026-01-16 15:00:00","2026-02-16 10:59:59"
e,event_jig1_charaget01_00002,quest_event_jig1_charaget01,event_jig1_charaget01_00002,2,15,5,50,100,event_jig1_charaget01_00001,1,AfterClear,5,2,general_diamond,,202601010,event_jig_a_0002,"2026-01-16 15:00:00","2026-02-16 10:59:59"
```

## 5. MstStageI18n.csv

**目的**: ステージ名を定義します(多言語対応)。

**手順**:
1. 監修資料・設計書からステージ名を抽出(通常はクエスト名と同じ)
2. IDを採番: `{mst_stage_id}_{language}`
3. CSVフォーマットに従ってデータを作成

**スキーマ**:
```
ENABLE,release_key,id,mst_stage_id,language,name,category_name
```

**作成例**:
```
ENABLE,release_key,id,mst_stage_id,language,name,category_name
e,202601010,event_jig1_charaget01_00001_ja,event_jig1_charaget01_00001,ja,必ず生きて帰る,
e,202601010,event_jig1_charaget01_00002_ja,event_jig1_charaget01_00002,ja,必ず生きて帰る,
```

## 6. MstStageEventReward.csv

**目的**: ステージ報酬を定義します(初回クリア・ランダム報酬)。

**手順**:
1. 運営仕様書・設計書から各ステージの報酬を抽出:
   - 初回クリア報酬(FirstClear): ユニット、ダイヤ、コイン、アイテム等
   - ランダム報酬(Random): 欠片、メモリー、コイン、ダイヤ等
2. IDを連番で採番
3. reward_categoryを設定(FirstClear、Random)
4. resource_typeとresource_idを設定
5. percentageを設定(FirstClearは100、Randomは確率)
6. CSVフォーマットに従ってデータを作成

**スキーマ**:
```
ENABLE,id,mst_stage_id,reward_category,resource_type,resource_id,resource_amount,percentage,sort_order,release_key
```

**作成例**:
```
ENABLE,id,mst_stage_id,reward_category,resource_type,resource_id,resource_amount,percentage,sort_order,release_key
e,569,event_jig1_charaget01_00001,FirstClear,Unit,chara_jig_00701,1,100,1,202601010
e,570,event_jig1_charaget01_00001,FirstClear,FreeDiamond,prism_glo_00001,40,100,2,202601010
e,571,event_jig1_charaget01_00001,FirstClear,Coin,,500,100,3,202601010
e,572,event_jig1_charaget01_00001,Random,Item,piece_jig_00701,1,10,4,202601010
```

## 7. MstStageEventSetting.csv

**目的**: ステージイベント設定を定義します(リセット、開催期間、背景等)。

**手順**:
1. 設計書から各ステージの設定を抽出:
   - リセットタイプ(Daily、__NULL__)
   - クリア可能回数(Dailyの場合に設定)
   - 背景アセットキー
2. IDを連番で採番
3. CSVフォーマットに従ってデータを作成

**スキーマ**:
```
ENABLE,id,mst_stage_id,reset_type,clearable_count,ad_challenge_count,mst_stage_rule_group_id,start_at,end_at,release_key,background_asset_key
```

**作成例**:
```
ENABLE,id,mst_stage_id,reset_type,clearable_count,ad_challenge_count,mst_stage_rule_group_id,start_at,end_at,release_key,background_asset_key
e,162,event_jig1_1day_00001,Daily,1,0,__NULL__,"2026-01-16 15:00:00","2026-02-2 03:59:59",202601010,jig_00001
e,169,event_jig1_charaget01_00001,__NULL__,,0,__NULL__,"2026-01-16 15:00:00","2026-02-16 10:59:59",202601010,jig_00003
```

## 8. MstStageClearTimeReward.csv

**目的**: タイムアタック報酬を定義します。

**手順**:
1. 設計書からタイムアタック報酬の設定を抽出
   - チャレンジクエストや高難度クエストで設定
2. IDを採番: `{mst_stage_id}_{連番}`
3. upper_clear_time_msをミリ秒で設定
4. CSVフォーマットに従ってデータを作成

**スキーマ**:
```
ENABLE,id,mst_stage_id,upper_clear_time_ms,resource_type,resource_id,resource_amount,release_key
```

**作成例**:
```
ENABLE,id,mst_stage_id,upper_clear_time_ms,resource_type,resource_id,resource_amount,release_key
e,event_jig1_challenge01_00001_1,event_jig1_challenge01_00001,140000,FreeDiamond,,20,202601010
e,event_jig1_challenge01_00001_2,event_jig1_challenge01_00001,200000,FreeDiamond,,20,202601010
e,event_jig1_challenge01_00001_3,event_jig1_challenge01_00001,300000,FreeDiamond,,20,202601010
```

## 9. MstStageEndCondition.csv(特殊クエストのみ)

**目的**: ステージ終了条件を定義します。

**手順**:
1. 降臨バトルやPVP等の特殊クエストの場合のみ作成
2. 通常のイベントクエストでは作成不要
3. stage_end_typeとcondition_typeを設定
4. condition_value1に時間(秒)を設定
5. CSVフォーマットに従ってデータを作成

**スキーマ**:
```
ENABLE,id,mst_stage_id,stage_end_type,condition_type,condition_value1,condition_value2,release_key
```

**作成例**:
```
ENABLE,id,mst_stage_id,stage_end_type,condition_type,condition_value1,condition_value2,release_key
e,quest_raid_jig1_00001,quest_raid_jig1_00001,Defeat,TimeOver,120,,202601010
```

## 10. MstQuestEventBonusSchedule.csv(特殊クエストのみ)

**目的**: 特効スケジュールを定義します。

**手順**:
1. 降臨バトル等の特殊クエストの場合のみ作成
2. 通常のイベントクエストではMstQuestBonusUnitを使用
3. event_bonus_group_idを設定
4. 特効期間を設定
5. CSVフォーマットに従ってデータを作成

**スキーマ**:
```
ENABLE,id,mst_quest_id,event_bonus_group_id,start_at,end_at,release_key
```

**作成例**:
```
ENABLE,id,mst_quest_id,event_bonus_group_id,start_at,end_at,release_key
e,9,quest_raid_jig1_00001,raid_jig1_00001,"2026-01-23 15:00:00","2026-01-29 14:59:59",202601010
```

# 重要な注意事項

1. **IDの一意性**: すべてのIDが一意であることを確認してください
2. **リレーションの整合性**: 外部キーが正しく設定されていることを確認してください
3. **日時形式**: すべての日時は`YYYY-MM-DD HH:MM:SS`形式で設定してください
4. **enum値の正確性**: quest_type、difficulty、auto_lap_type等のenum値は大文字小文字を正確に一致させてください
5. **__NULL__の使用**: NULL値を表す場合は`__NULL__`を使用してください(空欄ではなく)
6. **報酬設定**: FirstClear報酬のpercentageは必ず100に設定してください
7. **ステージ解放順序**: prev_mst_stage_idで前提ステージを正しく設定してください
8. **特殊クエスト**: 降臨バトルやPVPの場合のみMstStageEndConditionとMstQuestEventBonusScheduleを作成してください

# 出力形式

各CSVファイルを個別に出力してください。ファイル名は以下の形式で指定してください。

- MstQuest.csv
- MstQuestI18n.csv
- MstQuestBonusUnit.csv
- MstStage.csv
- MstStageI18n.csv
- MstStageEventReward.csv
- MstStageEventSetting.csv
- MstStageClearTimeReward.csv
- MstStageEndCondition.csv(特殊クエストのみ)
- MstQuestEventBonusSchedule.csv(特殊クエストのみ)
```

## プロンプトの使用方法

1. 上記のプロンプトをコピーして、Claude Codeに貼り付けます
2. `{運営仕様書のパス}`と`{クエスト設計書のパス}`を実際のパスに置き換えます
3. プロンプトを実行します
4. 生成されたCSVファイルを確認し、必要に応じて修正します
5. `domain/tasks/masterdata-entry/create-masterdata-from-biz-ops-specs/manuals/quest-stage/クエスト・ステージ_マスタデータ設定手順書.md`の「データ整合性のチェック」セクションに従って検証します

## プロンプトのカスタマイズ

特定のクエストタイプ(デイリー、チャレンジ、ストーリー等)に特化したプロンプトを作成する場合は、以下の点を調整してください。

- **デイリークエスト**: reset_type=Daily、clearable_count=1を強調
- **ストーリークエスト**: auto_lap_type=AfterClear、原画欠片ドロップグループIDの設定を強調
- **チャレンジクエスト**: タイムアタック報酬(MstStageClearTimeReward)の設定を強調
- **高難度クエスト**: 推奨レベル・スタミナコストの高さ、特殊ルール設定を強調
- **降臨バトル**: MstStageEndConditionとMstQuestEventBonusScheduleの作成を強調
