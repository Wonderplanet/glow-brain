# 降臨バトル マスタデータ作成プロンプト

運営仕様書から降臨バトルのマスタデータCSVを作成してください。

## インプット

### 運営仕様書
- 降臨バトル設計書（以下の情報を含む）
  - 降臨バトルの基本情報（バトルID、イベントID、開催期間）
  - バトルタイプ（ScoreChallenge等）
  - スコア設定（初期BP、スコア加算係数）
  - 挑戦回数設定
  - ランク評価基準（Bronze～Master）
  - 報酬設定（最高スコア、累計スコア、ランク、ランキング）
  - 特効キャラとボーナス率
  - ボス敵キャラID
  - インゲーム設定

### 参考資料
- `/Users/junki.mizutani/Documents/workspace/glow/glow-brain-repos/glow-brain-hotei/domain/tasks/masterdata-entry/create-masterdata-from-biz-ops-specs/manuals/advent-battle/降臨バトル_マスタデータ設定手順書.md`
- `/Users/junki.mizutani/Documents/workspace/glow/glow-brain-repos/glow-brain-hotei/domain/raw-data/masterdata/released/202601010/tables/`
  - MstAdventBattle.csv
  - MstAdventBattleI18n.csv
  - MstAdventBattleClearReward.csv
  - MstAdventBattleRank.csv
  - MstAdventBattleReward.csv
  - MstAdventBattleRewardGroup.csv
  - MstEventBonusUnit.csv
- DBスキーマ: `projects/glow-server/api/database/schema/exports/master_tables_schema.json`

## アウトプット

以下の7つのCSVシートを作成してください。

### 1. MstAdventBattle
- 降臨バトルの基本情報
- カラム: ENABLE, id, mst_event_id, mst_in_game_id, asset_key, advent_battle_type, initial_battle_point, score_addition_type, score_additional_coef, score_addition_target_mst_enemy_stage_parameter_id, mst_stage_rule_group_id, event_bonus_group_id, challengeable_count, ad_challengeable_count, display_mst_unit_id1, display_mst_unit_id2, display_mst_unit_id3, exp, coin, start_at, end_at, release_key
- ID形式: `quest_raid_{series_id}{連番1桁}_{連番5桁}`
- 注意: start_atとend_atを`"`で囲む

### 2. MstAdventBattleI18n
- 降臨バトル名とボス説明（多言語対応）
- カラム: ENABLE, release_key, id, mst_advent_battle_id, language, name, boss_description
- ID形式: `{mst_advent_battle_id}_{locale}`
- 言語: ja（必須）、en、zh-CN、zh-TW

### 3. MstAdventBattleRank
- ランク評価設定（Bronze/Silver/Gold/Master 各4レベル）
- カラム: ENABLE, id, mst_advent_battle_id, rank_type, rank_level, required_lower_score, asset_key, release_key
- ID形式: `{mst_advent_battle_id}_rank_{連番2桁}`
- 全16レコード（Bronze～Master各4レベル）
- スコア閾値を昇順に設定

### 4. MstAdventBattleClearReward
- クリア時ランダム報酬
- カラム: ENABLE, id, mst_advent_battle_id, reward_category, resource_type, resource_id, resource_amount, percentage, sort_order, release_key
- ID形式: `{mst_advent_battle_id}_{連番1桁}`
- reward_category: Random
- percentage合計: 100

### 5. MstAdventBattleRewardGroup
- 報酬カテゴリ定義
- カラム: ENABLE, id, mst_advent_battle_id, reward_category, condition_value, release_key
- ID形式: `{mst_advent_battle_id変換}_reward_group_{連番5桁}_{連番2桁}`
- reward_category: MaxScore, RaidTotalScore, Rank, Ranking
- 推奨構成:
  - MaxScore: 10～15段階
  - RaidTotalScore: 15～20段階
  - Rank: 16段階（全ランク）
  - Ranking: 上位順位 + Participation（参加賞）

### 6. MstAdventBattleReward
- 報酬詳細
- カラム: ENABLE, id, mst_advent_battle_reward_group_id, resource_type, resource_id, resource_amount, release_key
- ID形式: `{mst_advent_battle_reward_group_id}_{連番1桁}`
- 1つの報酬グループに複数報酬を設定可能

### 7. MstEventBonusUnit
- 特効キャラ設定
- カラム: ENABLE, id, mst_unit_id, bonus_percentage, event_bonus_group_id, is_pick_up, release_key
- bonus_percentage: 5, 10, 15, 20
- 特効キャラ: 5～10体程度

## 作業手順

### Step 1: 運営仕様書の解析
1. 降臨バトル設計書から必要な情報を抽出
2. ID採番ルールに従ってIDを決定
3. 開催期間、スコア設定、報酬設定を確認

### Step 2: MstAdventBattleの作成
1. 基本情報を設定
2. バトルタイプ（ScoreChallenge等）を設定
3. スコア設定（initial_battle_point、score_addition_type、score_additional_coef）
4. 挑戦回数（challengeable_count、ad_challengeable_count）
5. 開催期間（start_at、end_at）を`"`で囲んで設定

### Step 3: MstAdventBattleI18nの作成
1. 日本語（ja）の設定（必須）
2. 降臨バトル名（name）
3. ボス説明文（boss_description）
4. 他言語の設定（en、zh-CN、zh-TW）

### Step 4: MstAdventBattleRankの作成
1. Bronze（レベル1～4）
2. Silver（レベル1～4）
3. Gold（レベル1～4）
4. Master（レベル1～4）
5. 合計16レコード
6. スコア閾値を昇順に設定

### Step 5: MstAdventBattleClearRewardの作成
1. ランダム報酬の設定
2. 5種類程度のアイテム
3. percentageの合計を100にする

### Step 6: MstAdventBattleRewardGroupの作成
1. MaxScore報酬グループ（10～15段階）
2. RaidTotalScore報酬グループ（15～20段階）
3. Rank報酬グループ（16段階）
4. Ranking報酬グループ（上位 + 参加賞）

### Step 7: MstAdventBattleRewardの作成
1. 各報酬グループに対して報酬を設定
2. 1つの報酬グループに複数報酬を設定可能
3. ランキング上位報酬は豪華に設定

### Step 8: MstEventBonusUnitの作成
1. 特効キャラを5～10体選定
2. ボーナス率を設定（5%, 10%, 15%, 20%）
3. 新規実装キャラは高ボーナス（20%）

### Step 9: データ整合性チェック
1. ID採番ルールの確認
2. リレーションの整合性確認
3. enum値の正確性確認
4. ランク設定の完全性確認
5. 報酬設定の完全性確認
6. 開催期間の妥当性確認

## 注意事項

### 必須チェック項目
- [ ] IDの一意性と採番ルールの遵守
- [ ] リレーション（外部キー）の整合性
- [ ] enum値の大文字小文字が正確に一致
- [ ] ランクが16段階（Bronze～Master各4レベル）
- [ ] 報酬カテゴリの完全性（MaxScore、RaidTotalScore、Rank、Ranking）
- [ ] クリア報酬のpercentage合計が100
- [ ] 開催期間のフォーマット（`"YYYY-MM-DD HH:MM:SS"`）

### よくあるミス
- [ ] start_atとend_atを`"`で囲み忘れ
- [ ] enum値の大文字小文字ミス（例: scorechallenge → ScoreChallenge）
- [ ] ID採番ルールの誤り（例: quest_raid_jig_00001 → quest_raid_jig1_00001）
- [ ] reward_groupのID形式ミス（quest_を削除する）
- [ ] ランクのスコア閾値が降順になっている
- [ ] percentageの合計が100でない
- [ ] Ranking報酬で参加賞（Participation）を忘れる

## 出力形式

各CSVシートは以下の形式で出力してください。

```
ENABLE,カラム1,カラム2,...
e,値1,値2,...
e,値1,値2,...
```

- 1行目: ヘッダー行（ENABLE + カラム名）
- 2行目以降: データ行（e + 各カラムの値）
- 日時は`"`で囲む
- 文字列で`,`を含む場合は`"`で囲む

## 参考: 地獄楽降臨バトルの例

```
MstAdventBattle:
quest_raid_jig1_00001,event_jig_00001,raid_jig1_00001,ScoreChallenge,500,AllEnemiesAndOutPost,0.07,...

MstAdventBattleI18n:
quest_raid_jig1_00001_ja,"まるで 悪夢を見ているようだ",ボスを倒して高スコア獲得!!

MstAdventBattleRank:
quest_raid_jig1_00001_rank_01,Bronze,1,1000
quest_raid_jig1_00001_rank_13,Master,1,500000

MstEventBonusUnit:
chara_jig_00401,20,raid_jig1_00001
chara_jig_00001,15,raid_jig1_00001
```
