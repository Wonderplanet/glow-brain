# マスタデータ作成スキル開発タスク

## 現在の状況

### 完了済み
- ✅ スキル設計アーキテクチャ策定（`skill-design/skill-architecture.md`）
- ✅ スキルテンプレート作成（`skill-design/skill-template.md`）
- ✅ 分割計画策定（`split-plan/resource-split-plan.md`）
- ✅ スキルロードマップ策定（`skill-roadmap.md`）
- ✅ **ガチャスキル開発完了**（`.claude/skills/masterdata-from-bizops-gacha/`）

### 開発対象
**合計15スキル、95テーブル（100%カバレッジ）**のうち、**残り14スキル**を開発
- 各機能スキル（子スキル）13個
- 統合スキル（親スキル）1個

---

## タスク実行プロンプト

以下のプロンプトを新しいセッションで実行してください。

---

### プロンプト本文

```
運営仕様書からマスタデータCSVを作成するClaude Codeスキルシステムの開発を続けます。

## 最終目標

**運営仕様書全てをインプットして、マスタデータ設定が必要な全ての機能のマスタデータ作成を高精度に実行するワークフロー**を構築します。

### スキル構成の全体像

```
masterdata-from-bizops-all（統合スキル・親スキル）
├─ ユーザー手動トリガーでワークフロー開始
├─ 運営仕様書全体を解析
└─ 各機能スキル（子スキル）を適切に呼び出してマスタデータ一括作成
    ├─ masterdata-from-bizops-gacha（ガチャ）
    ├─ masterdata-from-bizops-hero（ヒーロー）
    ├─ masterdata-from-bizops-mission（ミッション）
    ├─ masterdata-from-bizops-quest-stage（クエスト・ステージ）
    ├─ masterdata-from-bizops-item（アイテム）
    ├─ masterdata-from-bizops-reward（報酬・汎用）
    ├─ masterdata-from-bizops-event-basic（イベント基本設定）
    ├─ masterdata-from-bizops-advent-battle（降臨バトル）
    ├─ masterdata-from-bizops-pvp（PVP）
    ├─ masterdata-from-bizops-shop-pack（ショップ・パック）
    ├─ masterdata-from-bizops-artwork（原画）
    ├─ masterdata-from-bizops-emblem（エンブレム）
    ├─ masterdata-from-bizops-enemy-autoplayer（敵・自動行動）
    └─ masterdata-from-bizops-ingame（インゲーム）
```

### 開発の段階

1. **Phase 1～3**: 各機能スキル（子スキル）の開発
2. **Phase 4**: 統合スキル（親スキル）の開発

## 現在の状況

以下のファイルを参照して、現在の状況を理解してください：

1. **スキル設計方針**: `domain/tasks/masterdata-entry/create-masterdata-from-biz-ops-specs/skill-design/skill-architecture.md`
2. **スキルテンプレート**: `domain/tasks/masterdata-entry/create-masterdata-from-biz-ops-specs/skill-design/skill-template.md`
3. **分割計画**: `domain/tasks/masterdata-entry/create-masterdata-from-biz-ops-specs/split-plan/resource-split-plan.md`
4. **スキルロードマップ**: `domain/tasks/masterdata-entry/create-masterdata-from-biz-ops-specs/skill-roadmap.md`
5. **完成済みのガチャスキル（参考）**: `.claude/skills/masterdata-from-bizops-gacha/`

## 作業内容

### Phase 1～3: 各機能スキル（子スキル）の開発

スキルロードマップ（`skill-roadmap.md`）に従って、以下の優先順位でスキルを開発してください。

### Phase 1: 高頻度グループ（優先度高）- 残り2スキル

1. **masterdata-from-bizops-hero**（13テーブル）
   - 既存の手順書: `domain/tasks/masterdata-entry/create-masterdata-from-biz-ops-specs/manuals/hero/`
   - 見積もり工数: 2～3日

2. **masterdata-from-bizops-mission**（8テーブル）
   - 既存の手順書: `domain/tasks/masterdata-entry/create-masterdata-from-biz-ops-specs/manuals/mission/`
   - 見積もり工数: 1.5～2日

### Phase 2: 中頻度グループ（優先度中）- 4スキル

3. **masterdata-from-bizops-quest-stage**（10テーブル）
   - 既存の手順書: `domain/tasks/masterdata-entry/create-masterdata-from-biz-ops-specs/manuals/quest-stage/`
   - 見積もり工数: 2～2.5日

4. **masterdata-from-bizops-item**（2テーブル）
   - 既存の手順書: `domain/tasks/masterdata-entry/create-masterdata-from-biz-ops-specs/manuals/item-reward/`（アイテム部分のみ抽出）
   - 見積もり工数: 0.5～1日

5. **masterdata-from-bizops-reward**（17テーブル）**汎用スキル**
   - 既存の手順書: `domain/tasks/masterdata-entry/create-masterdata-from-biz-ops-specs/manuals/item-reward/`（報酬部分のみ抽出）
   - **重要**: 報酬設定用汎用スキルとして、全17個の報酬テーブルの共通ルールをまとめる
   - resource_type別の参照先を明記（Item→MstItem、Unit→MstUnit、Emblem→MstEmblem）
   - 各機能スキルとの併用方法を記載
   - 見積もり工数: 2～3日

6. **masterdata-from-bizops-event-basic**（3テーブル）
   - 既存の手順書: `domain/tasks/masterdata-entry/create-masterdata-from-biz-ops-specs/manuals/event-basic/`
   - 見積もり工数: 1～1.5日

### Phase 3: 低頻度グループ（優先度低）- 7スキル

7. **masterdata-from-bizops-advent-battle**（7テーブル）
8. **masterdata-from-bizops-pvp**（2テーブル）
9. **masterdata-from-bizops-shop-pack**（7テーブル）
10. **masterdata-from-bizops-artwork**（5テーブル）
11. **masterdata-from-bizops-emblem**（2テーブル）
12. **masterdata-from-bizops-enemy-autoplayer**（5テーブル）
13. **masterdata-from-bizops-ingame**（7テーブル）

### Phase 4: 統合スキル（親スキル）の開発 - 最終目標

**masterdata-from-bizops-all**（全95テーブル）**統合スキル**

**位置付け**: マスタデータ一括作成ワークフローの統合スキル（親スキル）

**概要**:
運営仕様書全てをインプットして、マスタデータ設定が必要な全ての機能のマスタデータ作成を高精度に実行するワークフローを提供します。

**主要な機能**:
1. **運営仕様書の解析**
   - 添付された運営仕様書ファイル全体を解析
   - 各機能ごとに必要なマスタデータを特定
   - 依存関係を考慮した実行順序を決定

2. **各機能スキルの適切な呼び出し**
   - Phase 1～3で開発した14個の機能スキル（子スキル）を適切に呼び出す
   - 依存関係を考慮した実行順序（例: アイテム → 報酬、ヒーロー → ミッション報酬等）
   - 各機能スキルの実行結果を収集

3. **データ整合性の全体チェック**
   - 各機能スキルで作成されたマスタデータの整合性をチェック
   - テーブル間のリレーション整合性を確認
   - ID採番の一貫性を確認

4. **推測値レポートの統合**
   - 各機能スキルから出力された推測値レポートを統合
   - 全体の推測値レポートとして提示

**ワークフロー設計**:
```
1. 運営仕様書の解析
   ↓
2. 必要な機能の特定（ガチャ、ヒーロー、ミッション等）
   ↓
3. 依存関係の解析（アイテム → 報酬等）
   ↓
4. 実行順序の決定
   ↓
5. 各機能スキルの順次実行
   ├─ masterdata-from-bizops-item（アイテム）
   ├─ masterdata-from-bizops-hero（ヒーロー）
   ├─ masterdata-from-bizops-emblem（エンブレム）
   ├─ masterdata-from-bizops-gacha（ガチャ）
   ├─ masterdata-from-bizops-quest-stage（クエスト・ステージ）
   ├─ masterdata-from-bizops-mission（ミッション）
   ├─ masterdata-from-bizops-reward（報酬・汎用）
   ├─ masterdata-from-bizops-advent-battle（降臨バトル）
   ├─ masterdata-from-bizops-pvp（PVP）
   ├─ masterdata-from-bizops-event-basic（イベント基本設定）
   ├─ masterdata-from-bizops-shop-pack（ショップ・パック）
   ├─ masterdata-from-bizops-artwork（原画）
   ├─ masterdata-from-bizops-enemy-autoplayer（敵・自動行動）
   └─ masterdata-from-bizops-ingame（インゲーム）
   ↓
6. データ整合性の全体チェック
   ↓
7. 推測値レポートの統合
   ↓
8. 全体レポートの出力
```

**主要な入力パラメータ**:
- release_key: リリースキー（例: 202601010）
- 運営仕様書ファイル: 全ての運営仕様書ファイルを添付

**主要な出力**:
- 全95テーブルのマスタデータCSV
- 統合推測値レポート
- データ整合性チェック結果
- 実行サマリー（各機能スキルの実行結果一覧）

**開発上の注意点**:
- 各機能スキルを適切に呼び出すロジック
- 依存関係を考慮した実行順序の制御
- エラーハンドリング（途中で失敗した場合の対応）
- 進捗状況のレポート

**見積もり工数**: 3～5日

## 作業手順（Phase 1～3: 各機能スキル）

各スキルの開発は以下の手順で行ってください：

### 1. 既存の手順書を確認
- `manuals/{機能名}/` 配下の以下のファイルを読む：
  - `{機能名}_マスタデータ設定手順書.md`
  - `{機能名}_プロンプト.md`

### 2. スキルディレクトリを作成
- `.claude/skills/masterdata-from-bizops-{機能名}/`

### 3. SKILL.mdを作成
- `skill-design/skill-template.md` を参考に、機能用にカスタマイズ
- YAMLフロントマター設定（name、description）
- 概要、基本的な使い方、ワークフロー、出力例、注意事項を記載
- **重要**: 「追加情報ファイル」のセクションは不要（削除）

### 4. references/manual.mdを作成
- 既存の `{機能名}_マスタデータ設定手順書.md` をほぼそのまま移植

### 5. examples/sample-output.mdを作成
- サンプル出力を記載（既存のリリース202601010のデータを参考）

## 作業手順（Phase 4: 統合スキル）

Phase 1～3の各機能スキルが全て完成した後、統合スキルを開発してください。

### 1. 統合スキルの設計
- 運営仕様書の解析方法を設計
- 各機能スキルの呼び出しロジックを設計
- 依存関係を考慮した実行順序を設計
- エラーハンドリングを設計

### 2. スキルディレクトリを作成
- `.claude/skills/masterdata-from-bizops-all/`

### 3. SKILL.mdを作成
- 統合スキルとしての概要を記載
- 運営仕様書全体を入力とする使い方を記載
- ワークフロー全体を説明
- 各機能スキルとの連携方法を記載

### 4. ワークフローロジックを実装
- 運営仕様書の解析ロジック
- 各機能スキルの呼び出しロジック
- 依存関係を考慮した実行順序の制御
- データ整合性チェック
- 推測値レポートの統合

### 5. 統合テスト
- リリース202601010の運営仕様書全体を使ってテスト
- 各機能スキルが正しく呼び出されることを確認
- データ整合性チェックが正しく動作することを確認

## 重要な注意点

### スキル設計方針
- 既存の手順書を `references/manual.md` として活用
- `SKILL.md` にユーザー向けエントリーポイントを作成
- スキル命名規則: `masterdata-from-bizops-{機能名}`
- 推測値レポートの必須化でデータ品質を保証

### 削除すべき要素
- ❌ 「追加情報ファイル」セクション（全てのスキルで不要）
- ❌ シートスキーマへの言及（方針転換により廃止）

### 報酬スキルの特別な注意点
- 報酬設定用汎用スキルとして設計
- 全17個の報酬テーブルの共通ルールをまとめる
- resource_type別の参照先を明記:
  - `resource_type=Item` → `MstItem.id`
  - `resource_type=Unit` → `MstUnit.id`
  - `resource_type=Emblem` → `MstEmblem.id`
  - `resource_type=Coin/FreeDiamond/PaidDiamond` → 空欄
- 各機能スキルとの併用方法を記載

## 成果物

### Phase 1～3: 各機能スキル（子スキル）
各スキルごとに以下のファイルを作成：
- `.claude/skills/masterdata-from-bizops-{機能名}/SKILL.md`
- `.claude/skills/masterdata-from-bizops-{機能名}/references/manual.md`
- `.claude/skills/masterdata-from-bizops-{機能名}/examples/sample-output.md`

### Phase 4: 統合スキル（親スキル）
- `.claude/skills/masterdata-from-bizops-all/SKILL.md`
- `.claude/skills/masterdata-from-bizops-all/workflow-logic.md`（ワークフローロジックの設計書）
- `.claude/skills/masterdata-from-bizops-all/examples/full-workflow-example.md`（全体ワークフローの実行例）

## 推奨作業順序

1. **Phase 1を優先**: ヒーロー、ミッション（高頻度で使用）
2. **Phase 2を次に**: クエスト・ステージ、アイテム、報酬、イベント基本設定（中頻度）
3. **Phase 3を続けて**: その他7スキル（低頻度）
4. **Phase 4で完成**: 統合スキル（親スキル）の開発で最終目標達成

各スキルを完成させたら、ガチャスキルと同様に動作確認とレビューを行ってください。

**重要**: Phase 1～3の各機能スキルが全て完成してから、Phase 4の統合スキルを開発してください。統合スキルは各機能スキルに依存しています。

## 参考資料

- 完成済みのガチャスキル: `.claude/skills/masterdata-from-bizops-gacha/`
- DBスキーマ: `projects/glow-server/api/database/schema/exports/master_tables_schema.json`
- 既存のマスタデータ: `projects/glow-masterdata/`（実際にDBに投入するデータ）
- リリース202601010のマスタデータ: `domain/raw-data/masterdata/released/202601010/tables/`

---

上記の内容で、スキル開発を進めてください。

**開発の流れ**:
1. Phase 1～3で各機能スキル（子スキル）を順番に開発
2. 各スキルの動作確認とレビュー
3. Phase 4で統合スキル（親スキル）を開発
4. 統合スキルで全体ワークフローをテスト
5. 最終目標達成: 運営仕様書全体からマスタデータ一括作成

**最終的なゴール**: ユーザーが運営仕様書全てを添付して `/masterdata-from-bizops-all` を実行すれば、全95テーブルのマスタデータが高精度に一括作成されるワークフローを実現します。
```

---

## 補足

### 開発の全体像

**合計15スキルの開発**:
- ✅ ガチャスキル（完了）
- ⬜ 各機能スキル（子スキル）13個（Phase 1～3）
- ⬜ 統合スキル（親スキル）1個（Phase 4）

### 開発の進め方

1. **Phase 1（ヒーロー、ミッション）から優先的に開発**
   - 高頻度で使用されるスキル
   - 各スキルの開発完了後、動作確認とレビュー

2. **Phase 2（クエスト・ステージ、アイテム、報酬、イベント基本設定）**
   - 報酬スキルは特に重要な汎用スキルなので、慎重に開発
   - 各スキルの開発完了後、動作確認とレビュー

3. **Phase 3（その他7スキル）**
   - 低頻度で使用されるスキル
   - 各スキルの開発完了後、動作確認とレビュー

4. **Phase 4（統合スキル）**
   - Phase 1～3が全て完了してから開発
   - 運営仕様書全体からマスタデータ一括作成するワークフローを実現
   - リリース202601010の運営仕様書全体で統合テスト

### 最終目標の達成

統合スキルが完成すれば、以下のワークフローが実現します：

```bash
# ユーザーが運営仕様書全てを添付して実行
/masterdata-from-bizops-all

# パラメータ:
# - release_key: 202601010
# - 運営仕様書ファイル: 全てを添付

# ↓ 統合スキルが各機能スキルを適切に呼び出し

# 出力:
# - 全95テーブルのマスタデータCSV
# - 統合推測値レポート
# - データ整合性チェック結果
# - 実行サマリー
```

これにより、**運営仕様書全体から高精度なマスタデータ一括作成**が可能になります。
