# MstAdventBattleRank データソース調査結果

## 概要

MstAdventBattleRank.csvのデータがどのファイルから抽出できるかを、レコード単位・列単位で調査した結果をまとめます。

## データソースファイル

### 1. 降臨バトル設計書（基礎設計シート）

**パス**: `GLOW/031_レベルデザイン/基礎設計シート/01_クエスト・ステージ/クエスト設計/イベントクエスト/【202601010】地獄楽 いいジャン祭/【降臨バトル】まるで 悪夢を見ているようだ_地獄楽/`

- **ステージ概要.csv**
  - クエストID: `quest_raid_jig1_00001`（7行目）
  - リリースキー: `202601010`（9行目）

- **報酬管理.csv**
  - ランク報酬の詳細情報（プリズム、コイン等の報酬数）
  - ただし、MstAdventBattleRankテーブル自体には報酬情報は含まれないため、参考情報のみ

### 2. 運営仕様書

**パス**: `GLOW/080_運営/いいジャン祭（施策）/運営_仕様書/20260116_地獄楽 いいジャン祭_仕様書/`

- **03_降臨バトル.csv**
  - ◆ランク到達報酬セクション（59-75行目）
  - 累計スコア（Pt）とランク名の定義

## 列ごとのデータソース詳細

### 1. ENABLE

| 抽出元 | 値 | 備考 |
|--------|-----|------|
| 固定値 | `e` | 全レコード共通 |

### 2. id

| 抽出元 | パターン | 例 |
|--------|----------|-----|
| 自動生成 | `{mst_advent_battle_id}_rank_{2桁連番}` | `quest_raid_jig1_00001_rank_01` |

**生成ルール**:
- `mst_advent_battle_id`（クエストID）をプレフィックスとする
- `_rank_`を接続
- 連番を2桁でゼロパディング（01, 02, 03...）

### 3. mst_advent_battle_id

| 抽出元ファイル | シート/セクション | 行 | 列 | 値 |
|---------------|-------------------|-----|-----|-----|
| **降臨バトル設計書/ステージ概要.csv** | ステージ概要 | 7 | D列 | `quest_raid_jig1_00001` |

**GLOWパス**: `GLOW/031_レベルデザイン/基礎設計シート/01_クエスト・ステージ/クエスト設計/イベントクエスト/【202601010】地獄楽 いいジャン祭/【降臨バトル】まるで 悪夢を見ているようだ_地獄楽/ステージ概要.csv`

### 4. rank_type

| 抽出元ファイル | シート/セクション | 行 | 列 | 元データ | 変換後 |
|---------------|-------------------|-----|-----|---------|---------|
| **運営仕様書/03_降臨バトル.csv** | ◆ランク到達報酬 | 60 | B列 | ブロンズ1 | Bronze |
| 同上 | 同上 | 61 | B列 | ブロンズ2 | Bronze |
| 同上 | 同上 | 64 | B列 | シルバー1 | Silver |
| 同上 | 同上 | 68 | B列 | ゴールド1 | Gold |
| 同上 | 同上 | 72 | B列 | マスター1 | Master |

**GLOWパス**: `GLOW/080_運営/いいジャン祭（施策）/運営_仕様書/20260116_地獄楽 いいジャン祭_仕様書/03_降臨バトル.csv`

**変換ルール**:
- ブロンズ → Bronze
- シルバー → Silver
- ゴールド → Gold
- マスター → Master

### 5. rank_level

| 抽出元ファイル | シート/セクション | 行 | 列 | 元データ | 抽出値 |
|---------------|-------------------|-----|-----|---------|---------|
| **運営仕様書/03_降臨バトル.csv** | ◆ランク到達報酬 | 60-75 | B列 | ブロンズ1 | 1 |
| 同上 | 同上 | 同上 | 同上 | シルバー2 | 2 |

**GLOWパス**: `GLOW/080_運営/いいジャン祭（施策）/運営_仕様書/20260116_地獄楽 いいジャン祭_仕様書/03_降臨バトル.csv`

**抽出ルール**:
- ランク名の末尾の数字を取得（例: ブロンズ1 → 1）

### 6. required_lower_score

| 抽出元ファイル | シート/セクション | 行 | 列 | 元データ | 値 |
|---------------|-------------------|-----|-----|---------|-----|
| **運営仕様書/03_降臨バトル.csv** | ◆ランク到達報酬 | 60 | A列 | 1000~ | 1000 |
| 同上 | 同上 | 61 | A列 | 5000~ | 5000 |
| 同上 | 同上 | 62 | A列 | 10000~ | 10000 |
| 同上 | 同上 | 63 | A列 | 15000~ | 15000 |
| 同上 | 同上 | 64 | A列 | 30000~ | 30000 |
| 同上 | 同上 | 65 | A列 | 50000~ | 50000 |
| 同上 | 同上 | 66 | A列 | 75000~ | 75000 |
| 同上 | 同上 | 67 | A列 | 100000~ | 100000 |
| 同上 | 同上 | 68 | A列 | 150000~ | 150000 |
| 同上 | 同上 | 69 | A列 | 200000~ | 200000 |
| 同上 | 同上 | 70 | A列 | 250000~ | 250000 |
| 同上 | 同上 | 71 | A列 | 300000~ | 300000 |
| 同上 | 同上 | 72 | A列 | 500000~ | 500000 |
| 同上 | 同上 | 73 | A列 | 1000000~ | 1000000 |
| 同上 | 同上 | 74 | A列 | 1500000~ | 1500000 |
| 同上 | 同上 | 75 | A列 | 2000000~ | 2000000 |

**GLOWパス**: `GLOW/080_運営/いいジャン祭（施策）/運営_仕様書/20260116_地獄楽 いいジャン祭_仕様書/03_降臨バトル.csv`

**抽出ルール**:
- 「累計スコア（Pt）」列の値から「~」を除去して数値化

### 7. asset_key

| 抽出元 | 値 | 備考 |
|--------|-----|------|
| なし | 空欄 | どのファイルにも記載なし |

**調査結果**:
- 降臨バトル設計書、運営仕様書のどちらにも該当するデータなし
- 全レコードで空欄

### 8. release_key

| 抽出元ファイル | シート/セクション | 行 | 列 | 値 |
|---------------|-------------------|-----|-----|-----|
| **降臨バトル設計書/ステージ概要.csv** | ステージ概要 | 9 | D列 | 202601010 |

**GLOWパス**: `GLOW/031_レベルデザイン/基礎設計シート/01_クエスト・ステージ/クエスト設計/イベントクエスト/【202601010】地獄楽 いいジャン祭/【降臨バトル】まるで 悪夢を見ているようだ_地獄楽/ステージ概要.csv`

**備考**:
- 全レコードで同じ値（202601010）を使用

## レコードごとのデータソース対応表

| レコード | id | mst_advent_battle_id | rank_type | rank_level | required_lower_score | データソース（運営仕様書） |
|---------|-----|---------------------|-----------|------------|---------------------|--------------------------|
| 1 | 自動生成 | ステージ概要.csv | 03_降臨バトル.csv 60行 | 同左 | 同左 | 60行目 |
| 2 | 自動生成 | ステージ概要.csv | 03_降臨バトル.csv 61行 | 同左 | 同左 | 61行目 |
| 3 | 自動生成 | ステージ概要.csv | 03_降臨バトル.csv 62行 | 同左 | 同左 | 62行目 |
| 4 | 自動生成 | ステージ概要.csv | 03_降臨バトル.csv 63行 | 同左 | 同左 | 63行目 |
| 5 | 自動生成 | ステージ概要.csv | 03_降臨バトル.csv 64行 | 同左 | 同左 | 64行目 |
| 6 | 自動生成 | ステージ概要.csv | 03_降臨バトル.csv 65行 | 同左 | 同左 | 65行目 |
| 7 | 自動生成 | ステージ概要.csv | 03_降臨バトル.csv 66行 | 同左 | 同左 | 66行目 |
| 8 | 自動生成 | ステージ概要.csv | 03_降臨バトル.csv 67行 | 同左 | 同左 | 67行目 |
| 9 | 自動生成 | ステージ概要.csv | 03_降臨バトル.csv 68行 | 同左 | 同左 | 68行目 |
| 10 | 自動生成 | ステージ概要.csv | 03_降臨バトル.csv 69行 | 同左 | 同左 | 69行目 |
| 11 | 自動生成 | ステージ概要.csv | 03_降臨バトル.csv 70行 | 同左 | 同左 | 70行目 |
| 12 | 自動生成 | ステージ概要.csv | 03_降臨バトル.csv 71行 | 同左 | 同左 | 71行目 |
| 13 | 自動生成 | ステージ概要.csv | 03_降臨バトル.csv 72行 | 同左 | 同左 | 72行目 |
| 14 | 自動生成 | ステージ概要.csv | 03_降臨バトル.csv 73行 | 同左 | 同左 | 73行目 |
| 15 | 自動生成 | ステージ概要.csv | 03_降臨バトル.csv 74行 | 同左 | 同左 | 74行目 |
| 16 | 自動生成 | ステージ概要.csv | 03_降臨バトル.csv 75行 | 同左 | 同左 | 75行目 |

## データ抽出の流れ

1. **降臨バトル設計書/ステージ概要.csv**を読み、`クエストID`と`リリースキー`を取得
   - クエストID: quest_raid_jig1_00001
   - リリースキー: 202601010

2. **運営仕様書/03_降臨バトル.csv**の◆ランク到達報酬セクション（59-75行目）を読み、各ランクの情報を取得
   - 累計スコア（Pt）列から`required_lower_score`を取得
   - ランク列から`rank_type`と`rank_level`を取得
     - 日本語ランク名を英語に変換（ブロンズ→Bronze等）
     - 数字部分を抽出してrank_levelに設定

3. **レコードIDを自動生成**
   - パターン: `{quest_id}_rank_{2桁連番}`
   - 例: quest_raid_jig1_00001_rank_01

4. **固定値を設定**
   - ENABLE: `e`
   - asset_key: 空欄

5. **全レコードに同じrelease_keyを設定**
   - 値: `202601010`

## 注意事項

- **asset_key**はどのファイルにもデータソースが見つからず、現時点では空欄
- **rank_type**は日本語から英語への変換が必要
- **rank_level**はランク名の末尾の数字を抽出
- **required_lower_score**は「~」記号を除去して数値化が必要
- **id**は命名規則に従った自動生成が必要

## まとめ

MstAdventBattleRankテーブルのデータは、主に以下の2つのファイルから抽出されます:

1. **降臨バトル設計書/ステージ概要.csv** - クエストIDとリリースキーの取得
2. **運営仕様書/03_降臨バトル.csv** - ランク設定と必要スコアの取得

レコード数は運営仕様書のランク到達報酬セクションの行数に対応し、各レコードは1対1でマッピングされます。
