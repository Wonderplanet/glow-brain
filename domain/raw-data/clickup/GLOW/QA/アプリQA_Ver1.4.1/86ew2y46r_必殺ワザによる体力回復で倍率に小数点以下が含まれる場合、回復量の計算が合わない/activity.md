# 必殺ワザによる体力回復で倍率に小数点以下が含まれる場合、回復量の計算が合わない - Activity

**コメント #1** by Kazuya Adachi 
(2026-01-07 14:20:07)

1/7 安達
必殺ワザを使用して体力の回復を行った際、
倍率に小数点が含まれる場合でも、必殺ワザ文言の値そのままで計算が行われていることを確認しました。

また、ダメージ計算についても問題なく、
ダメージ/回復の計算結果も今まで通り「小数点以下切り上げ」となっていることを合わせて確認しております。

確認ビルド：iOS#43(532)、AOS#42(535)
確認環境：dev-qa
確認端末：iPhoneSE3(iOS:18.6)
　　　　　ZenFone6(AOS:9.0)



**コメント #2** by Kenta Inui 
(2026-01-07 12:28:47)

iOS：1.4.1 (532)
Android：1.4.1 (534)



**コメント #3** by Kenta Inui 
(2026-01-07 10:19:27)

PR中



**コメント #4** by Kenta Inui 
(2026-01-05 18:57:52)

エンジニアメモ
体力は整数値管理なので最終的な値は整数値となる。
既存処理どうなっているか確認し相談。

調査・修正方針
スレッド

【対応1】
インゲームの計算初期段階で係数の小数点以下を切り捨てている場所を発見しました。(30.2%→30%としていた)
こちら切り捨て無いように対応すすめようと思います。
※HPは整数値なので最終反映値はいずれも小数点以下切り上げとしていました、この部分は維持予定。
【対応2】
現状のダメージ・回復計算中の小数点以下の保持の仕方が「小数点以下第2位で四捨五入」となっておりました、こちらアウトゲームに合わせて「小数点以下第3位切り捨て」に変更する
例：アウトゲームでの表示が「30.25%」の場合のダメージ・回復計算中の扱われ方
・現状：30.3%
・変更後：30.25%



**コメント #5** by Kazuya Adachi 
(2026-01-05 18:48:17)

@Ryosuke Goto 
お疲れ様です。
ご返答が遅れ申し訳ありません。
----------------------
四捨五入による小数点第一位の切り上げ、切り捨て対応せずに、そのまま必殺ワザ文言の値で回復するように対応
----------------------

こちらの対応が望ましいと考えております。



**コメント #6** by Ryosuke Goto 
(2026-01-05 17:48:54)

@Kazuya Adachi 
お疲れ様です。
こちら対応としては以下になっていれば良いでしょうか？
・四捨五入による小数点第一位の切り上げ、切り捨て対応せずに、そのまま必殺ワザ文言の値で回復するように対応



**コメント #7** by Toshikazu Takahashi 
(2026-01-05 16:49:14)

### 調査方針・解決策の提案

本事象は、「わくわく アーニャ」「メイ」などの体力回復スキルにおいて、「回復倍率」に小数点以下がある場合、実際の回復量計算が正しくない（小数点以下が四捨五入されている）ことに起因しています。仕様上は表示された％（例：30.2%）で体力が回復されるべきですが、実装上の端数処理に問題があると見受けられます。

#### 調査・対応観点
- 回復量の計算処理における小数点以下の取り扱い（切り捨て／四捨五入／切り上げ）が設計・実装・表示いずれとも一致しているかを確認
- 端数処理の食い違いが、「回復量の実装値」「必殺ワザ文言」「表示値」間で発生していないかの検証
- 表示上30.2%なら、実数値×0.302との差がどこで発生しているかのソース追跡

#### 過去対応例
類似の「計算処理における端数処理」および「数値表示不一致」に関するタスクは見受けられませんでした。
ただし、下記のような小数点端数処理に起因する「期待値ズレ」「資料・実装不一致」タスクが参考になる可能性があります。
- [【仕様確認】「復讐を誓う片星 星野 アクア」の必殺ワザ強化時、固定ダメージの上昇値が四捨五入になっていない場合があることについて](https://app.clickup.com/t/86evu89h8)
  - 案件概要：同様に「四捨五入」や「資料値と実装値の誤差」が指摘されている

#### 解決策案
- **まずはソースを精査**し、回復量計算部の端数処理が仕様どおりか確認。必要に応じて「必殺ワザ倍率設定値」と「回復処理ロジック」の端数処理方式を統一する修正を行います。
- 表示文言（例：「xx.x%回復」の表示内容）と実際の回復量処理で端数処理の揺れが残る場合、「表示値」または「計算ロジック」のどちらを正とすべきか、仕様確認のうえ調整を検討
- 表示仕様（小数点以下の見せ方や取扱い）に関しても必要に応じてディレクター確認／仕様再整理
- 回復量計算の検証用にデバッグログ等を導入し、全パターンの差異有無を網羅的に確認

#### 推奨担当者
- **Shodai Ando**  
　┗過去に「端数処理」「キャラパラメータ」「実装データと設計値の整合性」関連のタスクを多く担当されています。
  （例：[「メイ」にて、RUSHダメージUPの倍率が資料と相違している](https://app.clickup.com/t/86evzk3y5) ほか）

---

#### 参考・類似タスク
- 【仕様確認】「復讐を誓う片星 星野 アクア」の必殺ワザ強化時、固定ダメージの上昇値が四捨五入になっていない場合があることについて  
  https://app.clickup.com/t/86evu89h8
- 「メイ」にて、RUSHダメージUPの倍率が資料と相違している  
  https://app.clickup.com/t/86evzk3y5

---

**備考**  
この事象はユーザー視点からの体感不一致でもあるため、修正後は再度必殺技使用時の回復量表示やデバッグ値でユーザー側の体感との一貫性チェックも推奨します。


