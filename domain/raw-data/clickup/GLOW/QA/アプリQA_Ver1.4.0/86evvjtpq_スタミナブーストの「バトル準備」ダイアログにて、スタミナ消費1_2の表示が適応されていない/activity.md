# スタミナブーストの「バトル準備」ダイアログにて、スタミナ消費1/2の表示が適応されていない - Activity

**コメント #1** by Kazuya Adachi 
(2025-12-15 10:56:48)

12/15 堤
キャンペーン中の「バトル準備」ダイアログのスタミナ消費が、1/2表示になっていることを確認いたしました。
ご対応頂き、ありがとうございました。

▼キャンペーンでの消費、所持のスタミナ値の半減表示
・バトル開始時の「バトル準備」ダイアログで、半減の表示を確認
・バトル終了時の「バトル準備」ダイアログで、半減の表示を確認

▼キャンペーン外での消費、所持のスタミナ値の表示
・バトル開始時の「バトル準備」ダイアログで、通常の表示を確認
・バトル終了時の「バトル準備」ダイアログで、通常の表示を確認

検証ビルド：iOS #2550、AOS #2550
確認環境 ：dev-qa2
検証端末 ：iPad mini（第6世代）（iOS:18.2）
　　　　 ：Galaxy S10（AOS:12）



**コメント #2** by Toshikazu Takahashi 
(2025-12-13 16:39:26)

### 調査方針・解決策の提案

【概要】
スタミナブーストの「バトル準備」ダイアログにて、スタミナ消費1/2キャンペーン中にもかかわらず、「消費スタミナ」の表示が半減前の値（例：40）が表示されています。実際のスタミナ消費自体は正しく半減されているため、UIの表示不整合と考えられます。

【過去類似タスクの参照】
現時点で、スタミナブーストやバトル準備ダイアログに直接関連し、「スタミナ値の表示」がキャンペーン制御と不整合になっていた類似事象は解決済みリストに見つかりません。  
ただし、「各種キャンペーン表示内容の不整合」「UI表示と内部値の齟齬」の事例としては、下記タスクが参考になるかと思います。

- 「BLACKFRIDAYキャンペーンにて、スタミナ消費量調整の効果が発生していない」  
　https://app.clickup.com/t/86evfa1ny  
  → 表示値・挙動ともに効果が出ていないパターン。  
- 「BLACK FRIDAYキャンペーンで、スタミナ1/2のバルーンにキャンペーン種別内容が表示されていない」  
　https://app.clickup.com/t/86evgjxmj  
  → バルーン表示に関する反映不足の表記不整合。

どちらも、キャンペーン設定やマスターデータと、フロント側での表示・反映処理の整合性を確認し、必要な修正・反映確認がされてます。

【解決策の提案】
1. **想定される原因の調査**  
　- 「バトル準備」ダイアログ表示時、「消費スタミナ」UIがキャンペーン適用後の値を参照しているかサーバ・クライアント双方で確認してください。
　- キャンペーン適用フラグ・スタミナ計算の参照ソース（DB or 計算ロジック）と、実表示の値算出の差分（旧UIのキャッシュ等も含め）を精査してください。

2. **再現環境・他パターンへの影響調査**  
　- バトル準備ダイアログ表示箇所（初回・再挑戦・他、異なる導線）すべてで同様の現象が再現するか調査。
　- 他の消費系ダイアログや、同一ロジックを用いている「○○半減」系キャンペーンでも同現象が出ないか横断調査してください。

3. **修正方針**
　- 「消費スタミナ」のUI表示ロジックを、実消費処理に合わせてキャンペーン適用後の値で統一表示する処理に修正してください。
　- 以降、同様の割引/消費修正系キャンペーンが発生した場合でも意図通りに表示されるよう、表示ロジックを基礎設計単位で共通化することを推奨します。

【アサイン対象】
UI表示のロジックおよび値参照の調査・修正が必要なため、実装系の調査・修正に知見のある  
**Kazuomi Sawada** さん（クライアント/ロジック/キャンペーン系の過去修正経験あり）  
をメインアサインに提案します。

【関連・参考タスク】
- BLACKFRIDAYキャンペーンにて、スタミナ消費量調整の効果が発生していない  
　https://app.clickup.com/t/86evfa1ny
- BLACK FRIDAYキャンペーンで、スタミナ1/2のバルーンにキャンペーン種別内容が表示されていない  
　https://app.clickup.com/t/86evgjxmj

---

何か追加情報があればご共有ください。


