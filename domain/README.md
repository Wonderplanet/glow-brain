# domain フォルダ構成ガイド

この `domain/` フォルダは、**AI 活用のための知識・タスク・ツール基盤**です。

## このフォルダで実現すること

1. **AIが信頼できる知識の一元管理**
   - 仕様、ルール、解析結果などの「事実」を蓄積
   - AIが判断する際の根拠として参照可能な状態で管理

2. **AIタスクの明確な定義**
   - AIに「何をどうやらせるか」を明文化
   - 再利用可能なタスクテンプレートとして管理

3. **実行可能なツール群の配置**
   - AIタスクを実際に実行するためのツール・スクリプトを配置

4. **生データの履歴保存**
   - 一次情報を履歴として保管
   - 分析・調査時のデータソースとして活用

---

## 基本構成（4フォルダ）

```
domain/
  ├── raw-data/        # 未加工の一次データ
  ├── knowledge/       # AIが参照する知識
  ├── tasks/           # AIタスクの定義
  └── tools/           # 実行可能なツール
```

**設計思想：**
- AIに「何を信じさせるか」（knowledge）
- AIに「何をやらせるか」（tasks）
- AIを「どう補助するか」（tools）
- 将来の分析用に「何を保存するか」（raw-data）

を明確に分離して管理する。

---

## 1. raw-data/

### 役割
**未加工・未解釈の一次データを履歴として保存する場所**

AIや人が後から分析・調査するためのデータソース。

### 何を入れるか
- リリース済みデータのスナップショット
- ログファイル
- 外部システムから取得したデータ
- 解析前の生データ

### 整理の考え方

**整理パターンの例：**
- データの種類ごと（例: masterdata/, logs/, api-response/）
- 環境ごと（例: production/, staging/）
- 時系列（例: 日付フォルダ、バージョンフォルダ）

### 現在の整理例

```
raw-data/
  └── masterdata/
      └── released/
          └── 202512010/     # リリースキーごと
```

---

## 2. knowledge/

### 役割
**AIが判断材料として信頼する知識を管理する場所**

分析結果、仕様書、ルール、解析ドキュメントなど、AIが「事実」として参照すべき情報を集約。

### 何を入れるか
- ゲーム仕様書・画面仕様
- ID採番ルール・命名規則
- テーブル関係性の解析結果
- データ制約・バリデーションルール
- コーディング規約

### 何を入れないか
- 未検証の仮説（raw-data/ で保管）

### 整理の考え方
知識は**領域・機能ごと**にサブフォルダを作成して管理します。

**整理パターンの例：**
- ゲーム機能ごと（例: mission/, gacha/, battle/）
- 技術領域ごと（例: api/, masterdata/, client/）
- 職種視点ごと（例: planning/, engineering/, design/）

### 特殊フォルダ: sources/

**役割：**
外部システムから**定期的にインポートするデータ**の置き場所。

**用途：**
- スプレッドシートのエクスポートデータ
- 外部APIから取得した仕様データ
- 自動生成される参照データ

**ポイント：**
- `sources/` 配下のデータは自動更新される前提
- 手動編集せず、ツールで自動インポート
- 知識ドキュメント（.md）はこのデータを参照して作成

**配置例：**
```
knowledge/
  └── masterdata/
      └── mission/
          ├── ID採番ルール.md          # 人が書く知識ドキュメント
          ├── 関係性解析.md             # 人が書く知識ドキュメント
          └── sources/                  # 外部インポートデータ
              └── spreadsheet/          # スプレッドシートからのインポート
                  ├── 仕様書.html
                  └── データ定義.csv
```

### 現在の整理例

```
knowledge/
  ├── game-features/          # ゲーム画面・機能の仕様書
  └── masterdata/             # マスタデータのルール・解析結果
      └── mission/            # ミッション機能
          ├── ID採番ルール.md
          └── sources/        # 外部インポートデータ
```

---

## 3. tasks/

### 役割
**AIに「何を・どうやらせるか」を定義する場所**

再利用可能なタスクテンプレートを管理。

### 何を入れるか
- AIに与えるプロンプト
- タスク実行の手順書
- 入出力例・サンプル

### 整理の考え方

**整理パターンの例：**
- タスクの目的ごと（例: data-entry/, code-generation/, testing/）
- 対象AIごと（例: gemini/, claude/, gpt-4/）※AIごとにプロンプトが異なる場合のみ
- タスクカテゴリごと（例: spec-to-csv/, api-to-impl/）
- 対象機能ごと（例: mission/, gacha/, battle/）

### ファイル構成パターン

**構成例1: プロンプト + 手順書のペア**
```
{タスク名}_プロンプト.md
{タスク名}_手順書.md
```

**構成例2: 単一のタスクファイル**
```
{タスク名}.md       # プロンプトと手順を1ファイルに統合
```

**構成例3: フォルダで整理**
```
{タスク名}/
  ├── prompt.md
  ├── guide.md
  └── examples/
```

### 現在の整理例

```
tasks/
  └── masterdata-entry/
      └── gemini/
          └── spec_to_masterdata/
              └── mission/
                  ├── イベントミッション_プロンプト.md
                  └── イベントミッション_マスタデータ設定手順書.md
```

---

## 4. tools/

### 役割
**実際に実行可能なツール・スクリプトを配置する場所**

AIタスクを補助・自動化するためのプログラムを管理。

### 何を入れるか
- Pythonスクリプト（CLIツール、データ処理）
- Google Apps Script（スプレッドシート連携）
- HTML/JavaScript（ブラウザで動作するツール）
- Shell Script（ビルド、デプロイ補助）

### 整理の考え方
ツールは**目的・機能**ごとにサブフォルダを作成して管理します。

**整理パターンの例：**
- ツールの目的ごと（例: data-entry/, api-testing/, document-generation/）
- 対象領域ごと（例: masterdata/, api/, client/）

### フォルダ構成パターン

```
tools/
  └── {ツール目的}/
      ├── {ツール名}/
      │   ├── README.md
      │   └── ...
      └── scripts/
          ├── README.md
          └── *.py, *.sh
```

### 現在の整理例

```
tools/
  └── masterdata-entry/
      ├── bulk-download-.../      # GASツール
      ├── scripts/                # Pythonスクリプト集
      └── CSVプレビュー.html       # ブラウザツール
```

---

## データと知識の流れ

```
┌─────────────┐
│  raw-data/  │  一次データ（履歴・ログ）
└──────┬──────┘
       │ 分析・解析
       ↓
┌─────────────┐
│ knowledge/  │  知識化（ルール・仕様・解析結果）
│             │  ├── ドキュメント（.md）
│             │  └── sources/（外部インポート）
└──────┬──────┘
       │ 参照
       ↓
┌─────────────┐
│   tasks/    │  AIタスクのプロンプト・手順書
└──────┬──────┘
       │ 実行・補助
       ↓
┌─────────────┐
│   tools/    │  自動化ツール・スクリプト
└─────────────┘
```

---

## ファイル配置の判断基準

新しいファイルを配置する際の判断基準：

| 配置先 | 判断基準 | 例 |
|--------|---------|-----|
| **raw-data/** | 未加工・未解釈のデータか？ | リリース済みマスタデータ、APIログ |
| **knowledge/** | AIが信じるべき知識か？ | ID採番ルール、画面仕様書、テーブル関係性 |
| **knowledge/sources/** | 外部から定期インポートするデータか？ | スプレッドシートエクスポート、API取得データ |
| **tasks/** | AIタスクの定義か？ | プロンプト、手順書、入出力例 |
| **tools/** | 実行可能なプログラムか？ | Pythonスクリプト、GAS、HTMLツール |

---

## 実例：AI活用ワークフロー

### パターン1: データ投入タスク

1. **準備フェーズ**
   - `tools/` のスクリプトで必要なデータをダウンロード・準備

2. **知識参照フェーズ**
   - `knowledge/` のルール・仕様書を確認
   - `knowledge/sources/` の外部データを参照
   - AIに参照させる知識を特定

3. **タスク実行フェーズ**
   - `tasks/` のプロンプトをAIに投入
   - 手順書に従ってタスクを実行

4. **履歴保存フェーズ**
   - 完成したデータを `raw-data/` に保存（必要に応じて）

### パターン2: 知識の蓄積

1. **分析フェーズ**
   - `raw-data/` の一次データを分析
   - パターン・ルールを発見

2. **知識化フェーズ**
   - 分析結果を `knowledge/` にドキュメント化
   - AIが参照できる形式で整理

3. **タスク定義フェーズ**
   - 新しく発見したパターンを再利用可能なタスクとして `tasks/` に追加

---

## 関連ドキュメント

- `.claude/skills/masterdata-explorer/SKILL.md` - マスタデータ調査スキル
- `.claude/skills/masterdata-csv-validator/SKILL.md` - マスタデータCSV検証スキル
