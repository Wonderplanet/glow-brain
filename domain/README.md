# domain フォルダ構成ガイド

この `domain/` フォルダは、**GLOW開発における AI 活用のための知識・タスク・ツール基盤**です。

## このフォルダで実現すること

1. **AIが信頼できる知識の一元管理**
   - ゲーム仕様、マスタデータルール、画面仕様などの「事実」を蓄積
   - AIが判断する際の根拠として参照可能な状態で管理

2. **AIタスクの明確な定義**
   - AIに「何をどうやらせるか」をプロンプト・手順書として明文化
   - 再利用可能なタスクテンプレートとして管理

3. **実行可能なツール群の配置**
   - AIタスクを実際に実行するためのスクリプト・プログラムを配置
   - すぐに使える形で整備

4. **生データの履歴保存**
   - 運営で投入したマスタデータなどの一次情報を履歴として保管
   - 分析・調査時のデータソースとして活用

---

## 全体構成

```
domain/
  ├── raw-data/        # 未加工の一次データ（履歴・ログ）
  ├── knowledge/       # AIが参照する知識（仕様・ルール・解析結果）
  ├── tasks/           # AIタスクの定義（プロンプト・手順書）
  └── tools/           # 実行可能なツール・スクリプト
```

---

## 1. raw-data/

### 役割
**未加工・未解釈の一次データを履歴として保存する場所**

AIや人が後から分析・調査するためのデータソース。

### 整理方針

データは**領域・種類・日付/バージョン**の階層で管理します。

**分類の軸：**
- データ領域（例: masterdata, logs, api-response）
- データ種類（例: released, staging, test）
- タイムスタンプ・バージョン（例: 日付、リリース番号）

### 入れるもの
- リリース済みデータのスナップショット
- ログファイル
- 外部システムからの取得データ
- 解析前の生データ

### フォルダ構成例

```
raw-data/
  └── {データ領域}/        # 例: masterdata, logs, api-response
      └── {データ種類}/    # 例: released, staging
          └── {日付・バージョン}/  # 例: YYYYMMDD0, v1.2.3
              └── データファイル群
```

**現在の例：**
- `masterdata/released/202512010/` - 2025年12月1日リリースのマスタデータ

### 使い方
- データのスナップショットを日付・バージョンごとに保存
- 過去データとの差分確認
- 仕様変更の履歴調査

---

## 2. knowledge/

### 役割
**AIが判断材料として信頼する知識を管理する場所**

分析結果、仕様書、ルール、解析ドキュメントなど、AIが「事実」として参照すべき情報を集約。

### 整理方針

知識は**領域・機能ごと**にサブフォルダを作成して管理します。

**分類の軸：**
- ゲーム機能（例: ミッション、ガチャ、バトル）
- 技術領域（例: API、マスタデータ、クライアント実装）
- 職種視点（例: 企画仕様、技術仕様、デザイン仕様）

### 入れるもの
- ゲーム仕様書（Markdown）
- ID採番ルール・命名規則
- テーブル関係性の解析結果
- データ制約・バリデーションルール
- コーディング規約

### 入れないもの
- 未検証の仮説（raw-data/ で保管）

### フォルダ構成例

```
knowledge/
  ├── {領域名}/          # 例: game-features, masterdata, api など
  │   └── {機能名}/      # 例: mission, gacha, battle など
  │       ├── ルール.md
  │       ├── 仕様書.md
  │       └── sources/   # 解析時の中間データ（オプション）
  └── ...
```

**現在の例：**
- `game-features/` - ゲーム画面・機能の仕様書
- `masterdata/mission/` - ミッション機能のID採番ルール、関係性解析

---

## 3. tasks/

### 役割
**AIに「何を・どうやらせるか」を定義する場所**

再利用可能なタスクテンプレートとして、プロンプトと手順書をセットで管理。

### 整理方針

タスクは**目的・対象AI・タスクカテゴリ**の階層で管理します。

**分類の軸：**
- **第1階層**: タスクの目的（例: データ投入、コード生成、テスト実行）
- **第2階層**: 対象AI（例: gemini, claude, gpt-4）※AIごとにプロンプトが異なる場合
- **第3階層**: タスクカテゴリ（例: 仕様書→CSV変換、API→実装生成）
- **第4階層**: 対象機能（例: mission, gacha, battle）

### ファイル命名規則

各タスクは以下の2ファイルセットで構成：

1. **`{タスク名}_プロンプト.md`**
   - AIに与えるプロンプトテキスト
   - タスクの目的、入力、出力、制約を記述

2. **`{タスク名}_手順書.md`** または **`{タスク名}_マスタデータ設定手順書.md`**
   - タスク実行の詳細手順
   - 使用する knowledge/ ドキュメントの参照
   - チェックリスト

### フォルダ構成例

```
tasks/
  └── {タスク目的}/           # 例: masterdata-entry, code-generation
      └── {対象AI}/           # 例: gemini, claude（オプション）
          └── {タスクカテゴリ}/  # 例: spec_to_csv, api_to_impl
              └── {対象機能}/    # 例: mission, gacha
                  ├── {タスク名}_プロンプト.md
                  └── {タスク名}_手順書.md
```

**現在の例：**
- `masterdata-entry/gemini/spec_to_masterdata/mission/` - Gemini向けミッション仕様書→CSV変換タスク

### 使い方
1. タスクを実行したい時、対応するプロンプトをAIに投入
2. 手順書を参照しながらタスクを進行
3. 新しいタスクパターンが見つかったら tasks/ に追加

---

## 4. tools/

### 役割
**実際に実行可能なツール・スクリプトを配置する場所**

AIタスクを補助・自動化するためのプログラムを管理。

### 整理方針

ツールは**目的・機能**ごとにサブフォルダを作成して管理します。

**分類の軸：**
- ツールの目的（例: データ投入支援、テスト自動化、ドキュメント生成）
- 対象領域（例: masterdata, api, client）

### ツールの形式

- **Pythonスクリプト**: CLIツール、データ処理
- **Google Apps Script**: スプレッドシート連携
- **HTML/JavaScript**: ブラウザで動作するツール
- **Shell Script**: ビルド、デプロイ補助

### フォルダ構成例

```
tools/
  └── {ツール目的}/          # 例: masterdata-entry, api-testing
      ├── {ツール名}/        # 各ツールごとのフォルダ
      │   ├── README.md      # 必須: 使い方の説明
      │   └── ...            # ツールのファイル群
      └── scripts/           # 小規模スクリプト集（オプション）
          ├── README.md
          └── *.py, *.sh
```

**現在の例：**
- `masterdata-entry/bulk-download-.../` - GASによる仕様書一括ダウンロード
- `masterdata-entry/scripts/` - Pythonによる仕様書ダウンロードスクリプト
- `masterdata-entry/マスタデータCSVプレビュー.html` - ブラウザCSVプレビューツール

### 使い方
- 各ツールのREADME.mdを参照
- ツールを実行してタスクを効率化
- 新しいツールを作ったら tools/ に追加

---

## データと知識の流れ

```
┌─────────────┐
│  raw-data/  │  リリース済みマスタデータ、ログなどの一次情報
└──────┬──────┘
       │ 分析・解析
       ↓
┌─────────────┐
│ knowledge/  │  採番ルール、仕様書、関係性解析などの知識化
└──────┬──────┘
       │ 参照
       ↓
┌─────────────┐
│   tasks/    │  AIタスクのプロンプト・手順書
└──────┬──────┘
       │ 実行・補助
       ↓
┌─────────────┐
│   tools/    │  自動化スクリプト・支援ツール
└─────────────┘
```

---

## 判断基準まとめ

新しいファイルを配置する際の判断基準：

| 配置先 | 内容 | 例 |
|--------|------|-----|
| **raw-data/** | 未加工の一次データ | リリース済みマスタデータ、APIログ |
| **knowledge/** | AIが信じる知識・ルール | ID採番ルール、画面仕様書、テーブル関係性 |
| **tasks/** | AIタスクの定義 | プロンプト、手順書、入出力例 |
| **tools/** | 実行可能なプログラム | Pythonスクリプト、GAS、HTMLツール |

---

## 実例：AI活用ワークフロー

このフォルダ構成を活用したワークフロー例：

### パターン1: データ投入タスク

1. **準備フェーズ**
   - `tools/{目的}/` のスクリプトで必要なデータをダウンロード・準備

2. **知識参照フェーズ**
   - `knowledge/{領域}/{機能}/` のルール・仕様書を確認
   - AIに参照させる知識を特定

3. **タスク実行フェーズ**
   - `tasks/{目的}/{AI}/{カテゴリ}/` のプロンプトをAIに投入
   - 手順書に従ってタスクを実行

4. **履歴保存フェーズ**
   - 完成したデータを `raw-data/{領域}/` に保存（必要に応じて）

### パターン2: 知識の蓄積

1. **分析フェーズ**
   - `raw-data/` の一次データを分析
   - パターン・ルールを発見

2. **知識化フェーズ**
   - 分析結果を `knowledge/{領域}/{機能}/` にドキュメント化
   - AIが参照できる形式で整理

3. **タスク定義フェーズ**
   - 新しく発見したパターンを再利用可能なタスクとして `tasks/` に追加

---

## 拡張方針

このフォルダ構成は、開発プロジェクトの成長に合わせて拡張可能です。

### 新しい領域を追加する場合

**knowledge/ の拡張：**
- 新しい技術領域（API、クライアント、インフラなど）
- 新しい機能分野（ゲームデザイン、経済設計など）
- 新しい職種視点（QA、運営、カスタマーサポートなど）

**tasks/ の拡張：**
- 新しいタスク目的（コード生成、テスト自動化、ドキュメント生成など）
- 新しい対象AI（新しいAIツールの登場時）
- 新しいタスクカテゴリ（新しいワークフローの発見時）

**tools/ の拡張：**
- 新しい自動化ツール（テスト、ビルド、デプロイなど）
- 新しいデータ処理ツール（分析、可視化、検証など）

### 拡張時の原則

1. **既存構造との一貫性を保つ**
   - 命名規則を統一
   - フォルダ階層の深さを揃える

2. **README.mdを必ず作成**
   - 各サブフォルダの目的を明記
   - 使い方・参照方法を記載

3. **抽象度のバランスを保つ**
   - 粒度が細かすぎないように注意
   - 再利用可能な単位でまとめる

---

## 関連ドキュメント

- `.ai-context/prompts/運営仕様書からマスタデータ作成の手順書.md` - マスタデータ作成の全体手順
- `.claude/skills/masterdata-explorer/SKILL.md` - マスタデータ調査スキル
- `.claude/skills/masterdata-csv-validator/SKILL.md` - マスタデータCSV検証スキル
