# domain フォルダ構成ガイド

この `domain/` フォルダは、**GLOW開発における AI 活用のための知識・タスク・ツール基盤**です。

## このフォルダで実現すること

1. **AIが信頼できる知識の一元管理**
   - ゲーム仕様、マスタデータルール、画面仕様などの「事実」を蓄積
   - AIが判断する際の根拠として参照可能な状態で管理

2. **AIタスクの明確な定義**
   - AIに「何をどうやらせるか」をプロンプト・手順書として明文化
   - 再利用可能なタスクテンプレートとして管理

3. **実行可能なツール群の配置**
   - AIタスクを実際に実行するためのスクリプト・プログラムを配置
   - すぐに使える形で整備

4. **生データの履歴保存**
   - 運営で投入したマスタデータなどの一次情報を履歴として保管
   - 分析・調査時のデータソースとして活用

---

## 全体構成

```
domain/
  ├── raw-data/        # 未加工の一次データ（履歴・ログ）
  ├── knowledge/       # AIが参照する知識（仕様・ルール・解析結果）
  ├── tasks/           # AIタスクの定義（プロンプト・手順書）
  └── tools/           # 実行可能なツール・スクリプト
```

---

## 1. raw-data/

### 役割
**未加工・未解釈の一次データを履歴として保存する場所**

AIや人が後から分析・調査するためのデータソース。

### フォルダ構成

```
raw-data/
  └── masterdata/
      └── released/
          ├── 202511010/    # リリース日付ごとのフォルダ
          ├── 202511020/
          ├── 202512010/
          ├── 202512015/
          └── 202512020/
```

### 入れるもの
- **リリース済みマスタデータ**（日付ごとのスナップショット）
- ログファイル
- 外部システムからの取得データ
- 解析前の生データ

### 使い方
- 各リリース日付のフォルダにマスタデータCSVを保存
- 過去のマスタデータとの差分確認
- 仕様変更の履歴調査

---

## 2. knowledge/

### 役割
**AIが判断材料として信頼する知識を管理する場所**

分析結果、仕様書、ルール、解析ドキュメントなど、AIが「事実」として参照すべき情報を集約。

### フォルダ構成

```
knowledge/
  ├── game-features/     # ゲーム画面・機能の仕様書
  │   ├── 画面一覧.md
  │   ├── 降臨バトル画面.md
  │   ├── 降臨バトルミッション画面.md
  │   ├── 降臨バトル結果画面.md
  │   └── ...
  └── masterdata/        # マスタデータのルール・解析結果
      └── mission/       # ミッション関連の知識
          ├── MstMissionReward_group_id採番ルール.md
          ├── 降臨バトルミッションID採番ルール.md
          ├── criterion_typeとdestination_sceneの関係性解析.md
          └── sources/   # 解析時の中間データ
```

### 使い方

#### game-features/
- ゲームの各画面・機能の仕様を記述
- AIがマスタデータ作成時に参照
- 画面仕様とデータ構造の対応関係を理解するための資料

#### masterdata/
- マスタデータのID採番ルール
- テーブル間の関係性解析
- データ投入時の制約・ルール
- 各機能・テーブルごとにサブフォルダを作成可能

### 入れるもの
- ゲーム仕様書（Markdown）
- ID採番ルール
- テーブル関係性の解析結果
- データ制約・バリデーションルール
- 命名規則・コーディング規約

### 入れないもの
- 未検証の仮説（raw-data/ で保管）

---

## 3. tasks/

### 役割
**AIに「何を・どうやらせるか」を定義する場所**

再利用可能なタスクテンプレートとして、プロンプトと手順書をセットで管理。

### フォルダ構成

```
tasks/
  └── masterdata-entry/          # マスタデータ投入タスク
      └── gemini/                # Gemini AI向け
          └── spec_to_masterdata/    # 仕様書→マスタデータ変換
              └── mission/       # ミッション系のタスク
                  ├── アチーブメントミッション_プロンプト.md
                  ├── アチーブメントミッション_マスタデータ設定手順書.md
                  ├── イベントミッション_プロンプト.md
                  ├── イベントミッション_マスタデータ設定手順書.md
                  ├── イベントログインボーナス_プロンプト.md
                  ├── イベントログインボーナス_マスタデータ設定手順書.md
                  ├── 降臨バトルミッション_プロンプト.md
                  └── 降臨バトルミッション_マスタデータ設定手順書.md
```

### フォルダの意味

#### masterdata-entry/
マスタデータ投入に関するタスク群を配置

#### gemini/
Gemini AI（Google AI Studio）向けのタスク定義
- 他のAI（Claude、GPT-4など）向けは別フォルダで管理可能

#### spec_to_masterdata/
「仕様書からマスタデータCSVを作成」というタスクカテゴリ

#### mission/
ミッション機能に関するタスク定義

### ファイルの構成パターン

各タスクは以下の2ファイルセットで構成：

1. **`{タスク名}_プロンプト.md`**
   - AIに与えるプロンプトテキスト
   - タスクの目的、入力、出力、制約を記述

2. **`{タスク名}_マスタデータ設定手順書.md`**
   - タスク実行の詳細手順
   - 使用する knowledge ドキュメントの参照
   - チェックリスト

### 使い方
1. タスクを実行したい時、対応するプロンプトをAIに投入
2. 手順書を参照しながらタスクを進行
3. 新しいタスクパターンが見つかったら tasks/ に追加

---

## 4. tools/

### 役割
**実際に実行可能なツール・スクリプトを配置する場所**

AIタスクを補助・自動化するためのプログラムを管理。

### フォルダ構成

```
tools/
  └── masterdata-entry/      # マスタデータ投入支援ツール
      ├── bulk-download-masterdata-specs-from-data-qa-summary-spreadsheet/
      │   ├── Index.html       # GASのUIファイル
      │   ├── appsscript.json  # GAS設定
      │   └── コード.js         # GASスクリプト
      ├── scripts/
      │   ├── README.md        # スクリプトの説明書
      │   ├── download_masterdata_docs.py  # Pythonスクリプト
      │   ├── pyproject.toml   # Python依存関係定義
      │   └── requirements.txt
      └── マスタデータCSVプレビュー.html  # ブラウザで動作するツール
```

### フォルダの意味

#### masterdata-entry/
マスタデータ投入プロセスを支援するツール群

#### bulk-download-masterdata-specs-from-data-qa-summary-spreadsheet/
Google Apps Script（GAS）で実装されたツール
- データQAまとめシートからマスタデータ仕様書を一括ダウンロード

#### scripts/
Python/Shell などのスクリプトツール
- `download_masterdata_docs.py`: GASと同等機能のPython版

### 使い方
- 各ツールフォルダのREADME.mdを参照
- ツールを実行してタスクを効率化
- 新しいツールを作ったら tools/ に追加

---

## データと知識の流れ

```
┌─────────────┐
│  raw-data/  │  リリース済みマスタデータ、ログなどの一次情報
└──────┬──────┘
       │ 分析・解析
       ↓
┌─────────────┐
│ knowledge/  │  採番ルール、仕様書、関係性解析などの知識化
└──────┬──────┘
       │ 参照
       ↓
┌─────────────┐
│   tasks/    │  AIタスクのプロンプト・手順書
└──────┬──────┘
       │ 実行・補助
       ↓
┌─────────────┐
│   tools/    │  自動化スクリプト・支援ツール
└─────────────┘
```

---

## 判断基準まとめ

新しいファイルを配置する際の判断基準：

| 配置先 | 内容 | 例 |
|--------|------|-----|
| **raw-data/** | 未加工の一次データ | リリース済みマスタデータ、APIログ |
| **knowledge/** | AIが信じる知識・ルール | ID採番ルール、画面仕様書、テーブル関係性 |
| **tasks/** | AIタスクの定義 | プロンプト、手順書、入出力例 |
| **tools/** | 実行可能なプログラム | Pythonスクリプト、GAS、HTMLツール |

---

## 実例：マスタデータ投入ワークフロー

このフォルダ構成を活用した実際のワークフロー例：

### 1. 準備フェーズ
- **tools/masterdata-entry/scripts/** のスクリプトで仕様書をダウンロード

### 2. 知識参照フェーズ
- **knowledge/masterdata/mission/** のID採番ルールを確認
- **knowledge/game-features/** の画面仕様を確認

### 3. タスク実行フェーズ
- **tasks/masterdata-entry/gemini/spec_to_masterdata/mission/** のプロンプトをAIに投入
- 手順書に従ってマスタデータCSVを作成

### 4. 履歴保存フェーズ
- リリース後、**raw-data/masterdata/released/** に日付フォルダを作成して保存

---

## 拡張方針

今後、以下のような拡張が可能：

### knowledge/ の拡張
- `knowledge/api/` - API仕様の知識
- `knowledge/client/` - クライアント実装の知識
- `knowledge/game-design/` - ゲームデザインの知識

### tasks/ の拡張
- `tasks/code-generation/` - コード生成タスク
- `tasks/testing/` - テスト実行タスク
- `tasks/document-generation/` - ドキュメント生成タスク

### tools/ の拡張
- `tools/api-testing/` - APIテストツール
- `tools/data-analysis/` - データ分析ツール

---

## 関連ドキュメント

- `.ai-context/prompts/運営仕様書からマスタデータ作成の手順書.md` - マスタデータ作成の全体手順
- `.claude/skills/masterdata-explorer/SKILL.md` - マスタデータ調査スキル
- `.claude/skills/masterdata-csv-validator/SKILL.md` - マスタデータCSV検証スキル
