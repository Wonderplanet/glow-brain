# スタミナ回復アイテム設定クイックリファレンス

## 概要

スタミナ回復アイテムを追加する際の最小限の情報をまとめたクイックリファレンスです。

詳細な説明は [スタミナ回復アイテムのデータ設定方法.md](./スタミナ回復アイテムのデータ設定方法.md) を参照してください。

---

## 設定対象ファイル

| ファイル | 用途 |
|---------|------|
| `projects/glow-masterdata/MstItem.csv` | アイテム基本情報 |
| `projects/glow-masterdata/MstItemI18n.csv` | 表示名・説明文 |

---

## アイテム種別

| 種別 | 説明 | effect_value例 |
|------|------|----------------|
| `StaminaRecoveryPercent` | パーセンテージ回復 | `"50"` = 上限値の50% |
| `StaminaRecoveryFixed` | 固定値回復 | `"10"` = 10回復 |

---

## MstItem.csv テンプレート

### ヘッダー
```csv
ENABLE,id,type,group_type,rarity,asset_key,effect_value,sort_order,start_date,end_date,release_key,item_type,destination_opr_product_id
```

### 固定値回復の例
```csv
e,stamina_item_glo_00001,StaminaRecoveryFixed,Etc,R,stamina_item_glo_00001,10,1,"2026-02-01 15:00:00","2037-12-31 23:59:59",202602010,StaminaRecoveryFixed,
```

### パーセンテージ回復の例
```csv
e,stamina_item_glo_00002,StaminaRecoveryPercent,Consumable,SR,stamina_item_glo_00002,50,2,"2026-02-01 15:00:00","2037-12-31 23:59:59",202602010,StaminaRecoveryPercent,
```

---

## MstItemI18n.csv テンプレート

### ヘッダー
```csv
ENABLE,release_key,id,mst_item_id,language,name,description
```

### 固定値回復の例
```csv
e,202602010,stamina_item_glo_00001_ja,stamina_item_glo_00001,ja,スタミナドリンク,使用することでスタミナを最大10回復できるアイテム
```

### パーセンテージ回復の例
```csv
e,202602010,stamina_item_glo_00002_ja,stamina_item_glo_00002,ja,スタミナドリンク・50%,使用することでスタミナを上限値の50%回復できるアイテム
```

---

## 必須チェック項目

### ✓ アイテムID命名規則

```
stamina_item_glo_<連番5桁>
```

### ✓ type と item_type を一致させる

```
type: StaminaRecoveryFixed
item_type: StaminaRecoveryFixed
```

### ✓ I18nレコードID命名規則

```
<mst_item_id>_ja
```

### ✓ release_key 形式

```
YYYYMMvv
例: 202602010 (2026年2月の1回目)
```

---

## よくある設定値

### group_type

- `Etc` - その他
- `Consumable` - 消費アイテム

### rarity

- `R` - レア
- `SR` - スーパーレア
- `SSR` - スーパースーパーレア
- `UR` - ウルトラレア

### effect_value（固定値回復）

- `"10"` - 少量回復
- `"50"` - 中量回復
- `"100"` - 大量回復

### effect_value（パーセンテージ回復）

- `"50"` - 50%回復
- `"100"` - 100%回復（全回復）

---

## 回復仕様まとめ

| 項目 | 内容 |
|------|------|
| **システム上限** | 999 |
| **複数個使用** | 可能 |
| **上限超過時** | 999で打ち切り |
| **999到達時** | 使用不可（エラー） |

### 回復量計算式

**固定値回復:**
```
回復量 = effect_value × 使用個数
```

**パーセンテージ回復:**
```
回復量 = floor(スタミナ上限値 × effect_value%) × 使用個数
```

---

## 確認コマンド

### 既存のスタミナ回復アイテムを確認
```bash
grep "StaminaRecovery" projects/glow-masterdata/MstItem.csv
```

### アイテムIDの重複チェック
```bash
grep "^e,stamina_item_glo_00001," projects/glow-masterdata/MstItem.csv
```

### I18nデータの確認
```bash
grep "stamina_item_glo_00001" projects/glow-masterdata/MstItemI18n.csv
```

---

## 設定手順（超簡易版）

1. **アイテムIDを決定** (`stamina_item_glo_<連番>`)
2. **MstItem.csvに1行追加**
3. **MstItemI18n.csvに1行追加**
4. **重複チェック実行**

以上！

---

## トラブルシューティング

### Q: アイテムが使えない

**A:** 以下を確認
- スタミナが999に達していないか？
- ENABLEが `e` になっているか？
- start_date, end_dateが有効期間内か？

### Q: 回復量がおかしい

**A:** 以下を確認
- effect_valueの値は正しいか？
- typeは `StaminaRecoveryFixed` か `StaminaRecoveryPercent` か？
- 複数個使用している場合、個数 × effect_value になっているか？

### Q: DB投入でエラー

**A:** 以下を確認
- ヘッダーの列順はテンプレートと一致しているか？
- 列数は正しいか？
- release_keyの形式は `YYYYMMvv` か？

---

**詳細ドキュメント**: [スタミナ回復アイテムのデータ設定方法.md](./スタミナ回復アイテムのデータ設定方法.md)
