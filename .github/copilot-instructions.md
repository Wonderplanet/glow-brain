# GitHub Copilot Instructions

**重要: このリポジトリでの全ての対応（対話、PRタイトル、PR本文、コメント、コミットメッセージ、作業中の進捗記録など、あらゆる出力）は必ず日本語で行ってください。**

---

## プロジェクト概要

glow-brainは、**GLOWゲームプロジェクト全体の開発支援のための統合コンテキストリポジトリ**です。

### 目的

- GLOWプロジェクトに関する**あらゆる相談**に対応
- GLOWプロジェクトで**何かを作る**際の支援
- server/client/masterdataのコードベースを1箇所に集約し、横断的な理解と開発を可能にする

### ユースケース例

- マスタデータCSVの作成・検証
- サーバーAPIとクライアント実装の整合性確認
- 新機能の設計と実装相談
- バグ調査とトラブルシューティング
- コードベース横断的な調査
- 運営施策の技術的実現可能性の検討

---

## リポジトリ構造

```
glow-brain/
├── projects/              # GLOWプロジェクトの3リポジトリを集約
│   ├── glow-server/      # サーバー実装（API、DB）
│   ├── glow-client/      # クライアント実装（Unity/C#）
│   └── glow-masterdata/  # マスタデータ（CSV、スキーマ）
├── マスタデータ/           # 運営仕様書と生成データ
├── .claude/
│   ├── skills/          # Agent Skills（GitHub Copilot/Claude Code共通）
│   └── docs/            # 参考ドキュメント
├── .github/
│   ├── agents/          # GitHub Copilot Agents
│   └── copilot-instructions.md  # このファイル
├── scripts/              # セットアップスクリプト
├── docs/                 # プロジェクトドキュメント
└── config/               # 設定ファイル
```

### projects/配下の3リポジトリ

このリポジトリの最も重要な特徴は、**3つの独立したリポジトリを1箇所に集約**していることです。

| リポジトリ | 役割 | 主要技術 |
|-----------|------|---------|
| **glow-server** | バックエンドAPI、DB定義 | TypeScript, PostgreSQL |
| **glow-client** | ゲームクライアント | Unity, C# |
| **glow-masterdata** | マスタデータ管理 | CSV |

**重要な注意点**:
- これらは**参照専用**です（`.git`ディレクトリは削除済み）
- Git submoduleではなく、通常のディレクトリとして管理
- 実際の変更は各リポジトリで行う
- `config/versions.json`で管理されたバージョン・ブランチ状態

---

## バージョン管理

`config/versions.json`で複数バージョンのコードベースを管理しています。

```json
{
  "current_version": "v1.5.0-devld",
  "versions": {
    "v1.5.0-devld": {
      "glow-server": "develop/v1.5.0",
      "glow-client": "release/v1.5.0",
      "glow-masterdata": "release/dev-ld"
    }
  }
}
```

各バージョンごとに専用ブランチを作成し、異なるバージョンのコードベースを並行管理できます。

---

## 主要なデータソース

### 1. DBスキーマ

**パス**: `projects/glow-server/api/database/schema/exports/master_tables_schema.json`

テーブル定義、カラムの型、制約、enum値などが定義されています。

### 2. マスタデータCSV

**パス**: `projects/glow-masterdata/*.csv`

ゲームで使用される実際のマスタデータ。

### 3. サーバーAPI実装

**パス**: `projects/glow-server/`

TypeScriptで実装されたバックエンドAPI。

### 4. クライアント実装

**パス**: `projects/glow-client/`

Unity/C#で実装されたゲームクライアント。主要な場所:
- `Assets/GLOW/Scripts/Runtime/Core/Data/Data/AutoGenerated/` - マスタデータクラス（自動生成）
- `Assets/GLOW/Scripts/Runtime/Core/Domain/` - ドメイン層
- `Assets/GLOW/Scripts/Runtime/Core/Data/Translators/` - Data→Model変換

---

## 利用可能なツールとエージェント

### GitHub Copilot Agents

このリポジトリでは、以下のGitHub Copilot Agentが利用可能です:

- **pln-masterdata-creator** (`@copilot /pln-masterdata-creator`) - 運営仕様書からマスタデータCSVを作成

詳細は`.github/agents/`を参照してください。

### Agent Skills

このリポジトリでは、GitHub CopilotとClaude Code両方で使用できる**Agent Skills**を活用しています。

**配置場所**: `.claude/skills/`

**動作の仕組み**:
- プロンプトの内容に基づいて、Copilotが自動的に関連性のあるスキルを判断
- 必要なスキルのSKILL.mdがコンテキストに自動ロードされる
- 明示的に呼び出す必要はなく、関連するタスクを依頼すれば自動で活用される

**利用可能なスキル**:
`.claude/skills/`配下を参照してください。各スキルディレクトリには`SKILL.md`（スキルの説明と指示）と`references/`（詳細なドキュメント）が含まれています。

**注**: `.github/skills/`と`.claude/skills/`の両方がサポートされていますが、このリポジトリでは`.claude/skills/`を使用しています。

---

## 主要なワークフロー例

### マスタデータ作成

運営仕様書（`マスタデータ/運営仕様/<名前>/要件/`）からマスタデータCSVを作成するワークフローが整備されています。

詳細は以下を参照:
- `.ai-context/prompts/運営仕様書からマスタデータ作成の手順書.md` - 詳細な作成手順
- `.github/agents/pln-masterdata-creator.agent.md` - GitHub Copilot Agent定義
- `.claude/skills/masterdata-csv-validator/SKILL.md` - 検証方法（Agent Skill）

### コードベース調査

3つのリポジトリを横断的に調査できます。

例:
- 特定のマスタデータテーブルがどこで使われているかを調査
- サーバーAPIとクライアント実装の対応関係を確認
- 新機能に必要なマスタデータテーブルを特定

---

## テーブル命名規則

GLOWプロジェクトでは、DBスキーマとCSVファイルで異なる命名規則を使用しています。

| 種類 | 命名規則 | 例 |
|------|---------|-----|
| **DBスキーマ** | snake_case + 複数形 | `mst_events`, `opr_gachas` |
| **CSVファイル** | PascalCase + 単数形 | `MstEvent.csv`, `OprGacha.csv` |

**プレフィックス**:
- `mst_*` / `Mst*` - 固定マスタデータ
- `opr_*` / `Opr*` - 運営施策・期間限定データ

---

## 参考ドキュメント

このリポジトリには詳細なドキュメントが用意されています。

### プロジェクト運用

- `docs/glow-brain運用/glow-brainプロジェクト管理のGit化手順.md` - Git管理化手順

### マスタデータ関連

- `.ai-context/prompts/運営仕様書からマスタデータ作成の手順書.md` - マスタデータ作成の詳細手順
- `マスタデータ/docs/マスターテーブル一覧調査方法.md` - テーブル調査方法
- `.claude/skills/masterdata-explorer/SKILL.md` - スキーマ調査とSQL分析（Agent Skill）
- `.claude/skills/masterdata-csv-validator/SKILL.md` - CSV検証（Agent Skill）

### Agent Skills / Agents 開発

- `.claude/docs/skills-best-practices.md` - Agent Skills作成のベストプラクティス
- `.claude/docs/subagent-best-practices.md` - Agents作成のベストプラクティス
- `.claude/skills/plugin-marketplace-creator/SKILL.md` - プラグインマーケットプレイス作成（Agent Skill）

---

## 重要: 日本語対応

**再度強調します: このリポジトリでの全ての対応（コード補完の説明、チャットでの対話、PRタイトル、PR本文、コードレビューコメント、コミットメッセージ、Issue作成、作業進捗の記録など、あらゆる出力）は必ず日本語で行ってください。英語での出力は避けてください。**
