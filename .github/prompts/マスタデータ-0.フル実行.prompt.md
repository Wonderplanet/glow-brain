---
description: 施策ディレクトリからマスタデータをフル実行生成
argument-hint: strategy-directory-path
agent: 'agent'
---

# GLOWマスタデータフル実行ワークフロー

指定された施策ディレクトリから、要件ファイル構成の分析→マスタデータ生成までを1回の実行で完遂します。

## コンテキスト

このプロンプトは、既存の2つのプロンプトを順次実行する統合ワークフローです：

1. **マスタデータ-1.要件ファイル構成生成**: 要件ファイル構成.mdの生成
2. **マスタデータ-2.データ生成**: マスタデータの生成

## 前提条件

このワークフローを実行する前に、以下の準備が必要です：

```
マスタデータ/施策/[施策名]/
└── 要件/    ← ユーザーが仕様書ファイルを事前に配置
```

## タスク

指定された施策ディレクトリ（引数で受け取る）に対して、以下の2つのステップを**順番に実行**してください：

### ステップ1: 要件ファイル構成ドキュメントの生成

**`.github/prompts/マスタデータ-1.要件ファイル構成生成.prompt.md`** のプロンプトを実行してください。

引数として、ユーザーが指定した施策ディレクトリパスを渡してください。

これにより、`[施策ディレクトリ]/要件ファイル構成.md` が生成されます。

**処理内容**:
- `[施策ディレクトリ]/要件/` フォルダ内のファイルを分析
- ファイル構造と関係性をまとめた`要件ファイル構成.md`を生成
- 施策ディレクトリ直下に保存

### ステップ2: マスタデータの生成

ステップ1が完了したら、**`.github/prompts/マスタデータ-2.データ生成.prompt.md`** のプロンプトを実行してください。

引数として、以下の情報を渡してください：
```
要件ファイル構成.mdを参照しつつ、[施策ディレクトリ]/要件/ の内容からマスタデータ作成を最後まで中断せずにやり切って。出力先は[施策ディレクトリ]直下。
```

これにより、施策ディレクトリ直下に全てのマスタデータCSVとREPORT.mdが生成されます。

## 重要な注意事項

### タスク完遂の原則 ⚠️

- **両方のステップを完全に実行**: ステップ1だけで終わらず、必ずステップ2まで完遂してください
- **途中で止めない**: ステップ2では、要件に含まれる全てのマスタデータを最後まで生成してください
- **完了条件**: REPORTに「未作成のマスタデータ」が残らないようにしてください

### 完了の確認

以下が全て完了していることを確認してください：

#### ステップ1の成果物
- ✅ `[施策ディレクトリ]/要件ファイル構成.md` が生成されている

#### ステップ2の成果物
- ✅ **全てのCSVファイルがテンプレートファイルからコピーして作成されている**
- ✅ 全てのマスタデータCSVファイルが施策ディレクトリ直下に生成されている
- ✅ `REPORT.md` が施策ディレクトリ直下に生成されている
- ✅ REPORTに「未作成のマスタデータ」セクションが存在しない
- ✅ REPORTに「スキーマ検証と修正」セクションが含まれている

## 出力形式

### 最終的なディレクトリ構造

```
マスタデータ/施策/[施策名]/
├── 要件/                    ← ユーザーが事前に用意
│   ├── 仕様書1.html
│   └── 仕様書2.html
├── 要件ファイル構成.md       ← ステップ1で生成
├── REPORT.md                ← ステップ2で生成
├── [ModelName1].csv         ← ステップ2で生成
├── [ModelName2].csv         ← ステップ2で生成
└── [ModelName3].csv         ← ステップ2で生成
```

## 使用例

```
/マスタデータ-0.フル実行 マスタデータ/施策/新春ガチャ
```

**前提**:
```
マスタデータ/施策/新春ガチャ/
└── 要件/
    ├── ガチャ仕様書.html
    └── 報酬一覧.html
```

**実行後**:
```
マスタデータ/施策/新春ガチャ/
├── 要件/
│   ├── ガチャ仕様書.html
│   └── 報酬一覧.html
├── 要件ファイル構成.md      ← 新規生成
├── REPORT.md                ← 新規生成
├── OprGacha.csv             ← 新規生成
└── OprGachaI18n.csv         ← 新規生成
```

## 参照プロンプト

このプロンプトは以下の2つのプロンプトファイルに依存しています：

- `.github/prompts/マスタデータ-1.要件ファイル構成生成.prompt.md`
- `.github/prompts/マスタデータ-2.データ生成.prompt.md`

各ステップの詳細な仕様や注意事項は、それぞれのプロンプトファイルを参照してください。
