# イベントミッション作成手順書

## 概要

イベント期間中の達成型ミッション（ステージクリア回数、ガシャ引き回数、特定キャラ使用等）を設定するためのマスタデータ作成手順です。

**参照する運営仕様書**: `04_ミッション.csv` の「◆いいジャン祭ミッション」「◆ぴえヨンミッション」セクション

---

## ミッションの種類

### いいジャン祭ミッション
- **目的**: イベント全体の達成目標
- **達成条件**: ステージクリア回数、ガシャ引き回数
- **報酬**: プリズム、賀正ガシャチケット、スペシャルガシャチケット

### ぴえヨンミッション
- **目的**: 特定キャラ（ぴえヨン）を使用してクエストをクリア
- **達成条件**: 特定キャラを編成してクエストクリア/挑戦
- **報酬**: コイン、エンブレム

---

## 必要な情報（運営仕様書から取得）

| 項目 | 例 |
|------|-----|
| 施策名称 | 【推しの子】いいジャン祭 特別ミッション |
| 開催期間 | 2026-01-01 00:00:00 ～ 2026-02-02 10:59:59 |
| ミッション内容 | ステージを5回クリアしよう |
| 報酬 | 賀正ガシャチケット×2 |

---

## 作成するマスタデータテーブル

1. **MstMissionEvent.csv** - イベントミッション定義
2. **MstMissionReward.csv** - ミッション報酬

---

## 作成手順

### Step 1: イベントミッションを作成（MstMissionEvent.csv）

| カラム | 設定値 | 例（ステージクリア回数） | 例（ガシャ引き回数） | 例（特定キャラ編成） |
|--------|--------|----------------------|---------------------|-------------------|
| ENABLE | `e` | e | e | e |
| id | `{event_id}_{連番}` | event_osh_00001_1 | event_osh_00001_28 | event_osh_00001_33 |
| release_key | リリースキー | 202512020 | 202512020 | 202512020 |
| mst_event_id | イベントID | event_osh_00001 | event_osh_00001 | event_osh_00001 |
| criterion_type | ミッション条件タイプ | StageClearCount | SpecificGachaDrawCount | SpecificUnitStageClearCount |
| criterion_value | 条件の値 | （空欄） | gasho_001 | chara_osh_00601.event_osh1_1day_00001 |
| criterion_count | 達成回数 | 5 | 10 | 1 |
| unlock_criterion_type | 前提条件タイプ | __NULL__ | __NULL__ | __NULL__ |
| unlock_criterion_value | 前提条件の値 | （空欄） | （空欄） | （空欄） |
| unlock_criterion_count | 前提条件回数 | 0 | 0 | 0 |
| group_key | グループキー | （空欄） | （空欄） | （空欄） |
| mst_mission_reward_group_id | 報酬グループID | osh_00001_event_reward_1 | osh_00001_event_reward_28 | osh_00001_event_reward_33 |
| sort_order | 表示順 | 1 | 28 | 33 |
| destination_scene | 遷移先 | Event | Gacha | Event |

---

### Step 2: ミッション報酬を作成（MstMissionReward.csv）

| カラム | 設定値 | 例（賀正チケット） | 例（プリズム） | 例（コイン） |
|--------|--------|-------------------|--------------|------------|
| ENABLE | `e` | e | e | e |
| id | 連番 | mission_reward_531 | mission_reward_535 | mission_reward_563 |
| release_key | リリースキー | 202512020 | 202512020 | 202512020 |
| group_id | Step1のmst_mission_reward_group_id | osh_00001_event_reward_1 | osh_00001_event_reward_5 | osh_00001_event_reward_33 |
| resource_type | 報酬タイプ | Item | FreeDiamond | Coin |
| resource_id | リソースID | ticket_glo_10001 | （空欄） | （空欄） |
| resource_amount | 個数 | 2 | 50 | 1000 |
| sort_order | 表示順 | 1 | 1 | 1 |
| 備考 | （任意）報酬名 | 推しの子ミッション(賀正チケット) | 推しの子ミッション(賀正チケット) | ぴえヨン連れて行こうミッション |

---

## ミッション条件タイプ（criterion_type）一覧

### 基本的な条件

| criterion_type | 説明 | criterion_value | criterion_count | 用途例 |
|---------------|------|-----------------|-----------------|--------|
| **StageClearCount** | ステージクリア回数 | （空欄） | 回数 | ステージを5回クリアしよう |
| **SpecificStageClearCount** | 特定ステージクリア回数 | ステージID | 回数 | デイリークエストを1回クリアしよう |
| **SpecificQuestClear** | 特定クエストクリア | クエストID | 1 | 収集クエスト「芸能界へ！」をクリアしよう |
| **SpecificGachaDrawCount** | 特定ガシャ引き回数 | ガシャID | 回数 | 賀正ガシャ2026を10回引こう |

### 特定キャラ関連

| criterion_type | 説明 | criterion_value | criterion_count | 用途例 |
|---------------|------|-----------------|-----------------|--------|
| **SpecificUnitStageClearCount** | 特定キャラ編成でクリア | `{キャラID}.{ステージID}` | 回数 | ぴえヨンを編成してクエスト1回クリア |
| **SpecificUnitStageChallengeCount** | 特定キャラ編成で挑戦 | `{キャラID}.{ステージID}` | 回数 | ぴえヨンを編成してクエスト1回挑戦 |

**criterion_valueの書き方**:
- 特定キャラ関連の場合: `chara_osh_00601.event_osh1_1day_00001`
- キャラIDとステージIDを `.` で連結

---

## 遷移先（destination_scene）の種類

| destination_scene | 遷移先画面 | 使用例 |
|------------------|----------|--------|
| **Event** | イベントTOP画面 | ステージクリア系ミッション |
| **Gacha** | ガシャ画面 | ガシャ引き回数系ミッション |
| **QuestSelect** | クエスト選択画面 | 特定クエストクリア系ミッション |

---

## ミッション作成パターン

### パターン1: ステージクリア回数ミッション

**運営仕様書の記載**:
```
ミッション内容: ステージを5回クリアしよう
報酬: 賀正ガシャチケット×2
```

**MstMissionEvent**:
- criterion_type: `StageClearCount`
- criterion_value: （空欄）
- criterion_count: `5`

**MstMissionReward**:
- resource_type: `Item`
- resource_id: `ticket_glo_10001`
- resource_amount: `2`

---

### パターン2: ガシャ引き回数ミッション

**運営仕様書の記載**:
```
ミッション内容: 賀正ガシャ2026を10回引こう
報酬: スペシャルガシャチケット×1
```

**MstMissionEvent**:
- criterion_type: `SpecificGachaDrawCount`
- criterion_value: `gasho_001` （ガシャIDを指定）
- criterion_count: `10`

**MstMissionReward**:
- resource_type: `Item`
- resource_id: `ticket_glo_00002`
- resource_amount: `1`

---

### パターン3: 特定キャラ編成クリアミッション

**運営仕様書の記載**:
```
ミッション内容: 【汗が輝いてるよ!】ぴえヨンを編成に入れて「ファンと推し合戦！」を1回クリア
報酬: コイン×1000
```

**MstMissionEvent**:
- criterion_type: `SpecificUnitStageClearCount`
- criterion_value: `chara_osh_00601.event_osh1_1day_00001`
- criterion_count: `1`

**MstMissionReward**:
- resource_type: `Coin`
- resource_id: （空欄）
- resource_amount: `1000`

**criterion_valueの構成**:
- `chara_osh_00601`: ぴえヨンのキャラID
- `.`: 区切り文字
- `event_osh1_1day_00001`: ファンと推し合戦！のステージID

---

### パターン4: 特定クエストクリアミッション

**運営仕様書の記載**:
```
ミッション内容: 【胸筋の登山始まってるよ!】収集クエスト「芸能界へ！」をクリアしよう
報酬: コイン×1000
```

**MstMissionEvent**:
- criterion_type: `SpecificQuestClear`
- criterion_value: `quest_event_osh1_charaget01`
- criterion_count: `1`

**MstMissionReward**:
- resource_type: `Coin`
- resource_id: （空欄）
- resource_amount: `1000`

---

## チェックリスト

作成後、以下を確認してください：

- [ ] ミッション数が運営仕様書と一致しているか
- [ ] criterion_typeが正しく設定されているか
- [ ] criterion_valueの書き方が正しいか（特にキャラ編成系）
- [ ] criterion_countが仕様書と一致しているか
- [ ] 報酬グループIDが正しく紐づいているか
- [ ] 報酬の種類と個数が仕様書と一致しているか
- [ ] destination_sceneが適切に設定されているか
- [ ] sort_orderが適切に設定されているか

---

## 注意点

### ミッションIDの採番
- イベントIDの後に連番を付ける: `event_osh_00001_1`, `event_osh_00001_2`, ...
- 連番はイベント全体で通し番号

### 報酬グループIDの命名
- `{event_id}_event_reward_{連番}` の形式
- 例: `osh_00001_event_reward_1`

### 特定キャラ編成ミッションの注意
- criterion_valueは `{キャラID}.{ステージID}` の形式
- キャラIDとステージIDの間に `.` を必ず入れる
- ステージIDは完全一致する必要がある

### クリアと挑戦の違い
- **SpecificUnitStageClearCount**: クリア（成功）した回数
- **SpecificUnitStageChallengeCount**: 挑戦（失敗含む）した回数
- 高難易度クエストでは「挑戦」を使うことが多い

---

## 実例（202512020リリース）

### いいジャン祭ミッション
- ミッション数: 32個
- 主な条件: ステージクリア回数（5～600回）、ガシャ引き回数（10～50回）
- 主な報酬: プリズム、賀正ガシャチケット、スペシャルガシャチケット

### ぴえヨンミッション
- ミッション数: 21個
- 主な条件: ぴえヨンを編成してクエストクリア/挑戦
- 主な報酬: コイン、筋肉推し!エンブレム

---

**作成完了後**: 次は期間限定ミッションや恒常ミッションの作成に進んでください。
