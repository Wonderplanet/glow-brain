using System;
using System.Collections;
using System.Collections.Generic;
using System.Runtime.Serialization;
using System.Threading;
using Cysharp.Threading.Tasks;
using Newtonsoft.Json;
using UnityEngine;
using UnityHTTPLibrary;
using WPFramework.Data.Extensions;
using GLOW.Core.Data.Data;
using GLOW.Core.Domain.Constants;
using Zenject;

// ----------------------------------------------------------------------
// This file is auto-generated by SchemaBuilder. Do not modify directly.
// ----------------------------------------------------------------------

namespace GLOW.Core.Data.DataStores
{
    public sealed class BoxGachaApi
    {
        [Serializable]
        class JsonParamInfo
        {
            [IgnoreDataMember] [JsonIgnore]
            public string MstBoxGachaId {
                get => mstBoxGachaId;
                set => mstBoxGachaId = value;
            }
            [DataMember(Name = "mstBoxGachaId")] [SerializeField] [JsonProperty("mstBoxGachaId")] string mstBoxGachaId;
        }
        [Serializable]
        class JsonParamDraw
        {
            [IgnoreDataMember] [JsonIgnore]
            public string MstBoxGachaId {
                get => mstBoxGachaId;
                set => mstBoxGachaId = value;
            }
            [IgnoreDataMember] [JsonIgnore]
            public int DrawCount {
                get => drawCount;
                set => drawCount = value;
            }
            [IgnoreDataMember] [JsonIgnore]
            public int CurrentBoxLevel {
                get => currentBoxLevel;
                set => currentBoxLevel = value;
            }
            [DataMember(Name = "mstBoxGachaId")] [SerializeField] [JsonProperty("mstBoxGachaId")] string mstBoxGachaId;
            [DataMember(Name = "drawCount")] [SerializeField] [JsonProperty("drawCount")] int drawCount;
            [DataMember(Name = "currentBoxLevel")] [SerializeField] [JsonProperty("currentBoxLevel")] int currentBoxLevel;
        }
        [Serializable]
        class JsonParamReset
        {
            [IgnoreDataMember] [JsonIgnore]
            public string MstBoxGachaId {
                get => mstBoxGachaId;
                set => mstBoxGachaId = value;
            }
            [IgnoreDataMember] [JsonIgnore]
            public int CurrentBoxLevel {
                get => currentBoxLevel;
                set => currentBoxLevel = value;
            }
            [DataMember(Name = "mstBoxGachaId")] [SerializeField] [JsonProperty("mstBoxGachaId")] string mstBoxGachaId;
            [DataMember(Name = "currentBoxLevel")] [SerializeField] [JsonProperty("currentBoxLevel")] int currentBoxLevel;
        }

        [Inject(Id = WPFramework.Constants.Zenject.FrameworkInjectId.ServerApi.Game)] ServerApi APIContext { get; }

        public async UniTask<BoxGachaInfoResultData> Info(CancellationToken cancellationToken, string mstBoxGachaId)
        {
            var payload = new Payload()
            {
                Data = Array.Empty<byte>(),
                ContentType = MimeTypes.Json
            };
            var uriParameters = System.Web.HttpUtility.ParseQueryString(string.Empty);
            uriParameters["mstBoxGachaId"] = mstBoxGachaId; 
    
            return await APIContext.Get<BoxGachaInfoResultData>(cancellationToken, "/api/box_gacha/info?" + uriParameters, payload);
        }
        public async UniTask<BoxGachaDrawResultData> Draw(CancellationToken cancellationToken, string mstBoxGachaId, int drawCount, int currentBoxLevel)
        {
            var param = new JsonParamDraw();
            param.MstBoxGachaId = mstBoxGachaId;
            param.DrawCount = drawCount;
            param.CurrentBoxLevel = currentBoxLevel;
            var json = JsonConvert.SerializeObject(param);
            var payload = new Payload()
            {
                Data = System.Text.Encoding.UTF8.GetBytes(json),
                ContentType = MimeTypes.Json
            };
    
            return await APIContext.Post<BoxGachaDrawResultData>(cancellationToken, "/api/box_gacha/draw", payload);
        }
        public async UniTask<BoxGachaResetResultData> Reset(CancellationToken cancellationToken, string mstBoxGachaId, int currentBoxLevel)
        {
            var param = new JsonParamReset();
            param.MstBoxGachaId = mstBoxGachaId;
            param.CurrentBoxLevel = currentBoxLevel;
            var json = JsonConvert.SerializeObject(param);
            var payload = new Payload()
            {
                Data = System.Text.Encoding.UTF8.GetBytes(json),
                ContentType = MimeTypes.Json
            };
    
            return await APIContext.Post<BoxGachaResetResultData>(cancellationToken, "/api/box_gacha/reset", payload);
        }
    }
}