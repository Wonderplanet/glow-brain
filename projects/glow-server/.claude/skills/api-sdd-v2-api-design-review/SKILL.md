---
name: api-sdd-v2-api-design-review
description: |
  体系的なチェックリストバリデーションを用いてAPI設計書の品質レビューと洗練を行う。以下の場合に使用:(1) 設計書品質の検証、(2) 規約違反の検出、(3) API設計の完全性確認。レビュー項目:(1) テンプレート形式準拠(標準セクションと構造)、(2) API仕様の完全性(リクエスト/レスポンス/バリデーション)、(3) DB設計の妥当性(TiDB最適化、インデックス、PK)、(4) エラーハンドリングの網羅性(コード、条件、挙動)、(5) テスト観点の十分性(単体/機能/シナリオ)。レビューカテゴリ:A) API設計規約(パスパラメータ禁止、一覧API禁止、oprテーブル新規追加禁止)、B) レスポンス構造(camelCase、報酬形式、ISO8601日時)、C) 実装ガイダンス(トランザクション制御、データ出所の明確化)、D) アーキテクチャ方針(既存テーブル拡張優先)。API設計書作成後、設計書の品質確認時、規約準拠の検証時、設計の完全性確認時に使用する。入力:03_API設計書.md。出力:レビューサマリーと修正案。
---

# SDD v2 API設計書レビュースキル

API設計書の初稿に対し、チェックリストに基づいた品質レビューと微調整を行うスキルです。

## 使用タイミング

- API設計書作成完了後、品質検証の段階
- `/sdd-v2:api-review {機能名}` コマンドから起動
- `sdd-orchestrator-v2` スキルから直接呼び出し

## 基本原則

1. **チェックリスト準拠**: 公式チェックリストに基づく体系的なレビュー
2. **規約違反の検出**: API設計規約、レスポンス構造、実装ガイダンス等の違反を特定
3. **修正案の提示**: 問題箇所に対する具体的な修正案を提供
4. **ユーザー承認**: 修正適用前に必ずユーザーの承認を得る

## 入力

- `docs/sdd-v2/features/{機能名}/03_API設計書.md` （レビュー対象）

## 出力

- レビュー結果のサマリー（チャットに出力）
- 承認後、`03_API設計書.md` を更新

## 参照チェックリスト

@docs/sdd-v2/checklists/api-design-checklist.md

## レビューカテゴリ

### カテゴリA: API設計の規約チェック

- A1: パスパラメータ禁止
- A2: 一覧取得API禁止
- A3: oprテーブル新規追加禁止

### カテゴリB: レスポンス構造チェック

- B1: キー命名規則（camelCase、glow-schema一致）
- B2: 報酬構造（getRewardResponseData形式）
- B3: 日時フォーマット（ISO8601、StringUtil記載）
- B4: ResponseDataFactory活用

### カテゴリC: 実装ガイダンスチェック

- C1: トランザクション制御の記載
- C2: データ出所（mst/usr/log）の明確化

### カテゴリD: アーキテクチャ方針チェック

- D1: テーブル設計方針（既存拡張優先）

## 作業フロー

1. **API設計書の読み込み**: `03_API設計書.md` を読み込む
2. **チェックリストレビュー**: 各カテゴリの項目を順にチェック
3. **問題箇所の特定**: 違反項目とその詳細を記録
4. **レビュー結果の報告**: サマリー表と問題詳細を出力
5. **修正の適用**: ユーザー承認後、設計書を更新

## 出力フォーマット

```markdown
## API設計書レビュー結果

### チェックサマリー

| カテゴリ | 結果 | 問題数 |
|---------|------|--------|
| A: API設計規約 | OK/NG | 0 |
| B: レスポンス構造 | OK/NG | 0 |
| C: 実装ガイダンス | OK/NG | 0 |
| D: アーキテクチャ | OK/NG | 0 |

### 問題箇所（該当する場合）

#### {カテゴリ}{番号}: {項目名}

**現在の記載:**
...

**問題点:**
...

**修正案:**
...
```

## 関連ドキュメント

- `@docs/sdd-v2/checklists/api-design-checklist.md` - 品質チェックリスト
- `@.claude/skills/api-response/SKILL.md` - APIレスポンス実装スキル
- `@.claude/skills/apply-user-transaction-changes/SKILL.md` - トランザクション制御スキル

## 次のステップ

レビュー完了後、以下のいずれかに進む：
1. 問題なし → refineフェーズ（`sdd-v2-api-design-refiner` スキル）へ
2. 問題あり・修正適用 → 再度レビュー、または refine へ
