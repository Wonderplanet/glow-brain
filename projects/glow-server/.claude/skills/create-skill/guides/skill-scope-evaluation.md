# スキルのスコープ評価と分割提案ガイド

整理したルールと対象範囲を評価し、**1つのスキルとして肥大化しそうな場合は複数のスキルに分割する**ための判断基準とプロセスを説明します。

## スキル分割の判断基準

### 1. 責務の独立性

明確に異なる責務や役割がある場合は分割を検討します。

**例:**
- 「データ取得」と「画面表示」は別々のスキルにできる
- 「API実装」と「API テスト」は別々のスキルにできる

### 2. 使用タイミングの違い

異なるタイミングで使われる機能は分割を検討します。

**例:**
- 「実装」と「テスト」と「デバッグ」は別々のスキルにできる
- 「開発前の調査」と「開発中の実装」と「開発後のレビュー」は別々のスキルにできる

### 3. 複雑度の指標

以下の基準に**複数該当する場合**は分割を検討します：

- [ ] 対象ファイルが10個以上に及ぶ
- [ ] 実装パターンが5つ以上ある
- [ ] 異なるツール・ライブラリを3つ以上使う
- [ ] ワークフローが複数フェーズ（調査→計画→実装→検証など）に分かれる
- [ ] SKILL.mdが100行を超えそう、または参照ファイルが8個以上必要

### 4. 技術スタックの違い

異なる技術領域をカバーしている場合は分割を検討します。

**例:**
- 「バックエンドAPI実装」と「フロントエンド画面実装」は別々のスキルにできる
- 「データベース設計」と「ビジネスロジック実装」は別々のスキルにできる

## 分割提案のプロセス

スキル分割が必要と判断した場合、以下のプロセスで進めます：

### ステップ1: 分割の必要性を説明

ユーザーに以下を伝えます：
- なぜ分割が必要か（上記の判断基準のどれに該当するか）
- 分割しない場合の問題点（保守性、使いやすさ、トークン消費など）
- 分割による利点（責務の明確化、独立した保守、必要なスキルだけを読み込める）

### ステップ2: 分割案を複数提示

通常2-4個のスキルに分割する案を提示します。

**提示形式の例:**

```markdown
## スキル分割提案

対象範囲を分析した結果、以下のように複数のスキルに分割することを推奨します：

### 提案1: フェーズ別に3つのスキルに分割

1. **xxx-research** (調査・分析)
   - 既存実装の調査
   - 依存関係の特定
   - 影響範囲の分析

2. **xxx-implementation** (実装)
   - マイグレーション作成
   - モデル・コントローラー実装
   - サービスロジック実装

3. **xxx-testing** (テスト)
   - テストケース作成
   - テスト実行・デバッグ
   - カバレッジ確認

### 提案2: 技術領域別に2つのスキルに分割

1. **xxx-backend** (バックエンド実装)
   - DB設計・マイグレーション
   - モデル・リポジトリ実装
   - ビジネスロジック実装

2. **xxx-contract** (API契約実装)
   - ルーティング設定
   - コントローラー実装
   - レスポンス形式実装
   - APIテスト
```

### ステップ3: 各スキルの責務範囲を明確に定義

各分割案について、以下を明確にします：
- スキル名と説明
- 担当する責務
- 使用タイミング
- 想定される規模（SKILL.md行数、参照ファイル数）

### ステップ4: スキル間の連携方法を説明

分割したスキルがどのように連携するかを説明します：
- 典型的な使用フロー（例: skill A → skill B → skill C）
- スキル間のデータの受け渡し方法
- 各スキルのSKILL.md内に「関連スキル」セクションを追加

### ステップ5: ユーザーに選択肢を提示

以下の選択肢を提示します：

```markdown
どの案で進めますか？

A: 提案された分割案で進める（提案1または提案2を選択）
B: 統合して1つのスキルとして作成
C: カスタム分割（ユーザーが調整）
```

## 分割しない場合の対応

ユーザーが統合（選択肢B）を選択した場合でも、以下の点に注意してファイル構成を設計します：

### ディレクトリ構造で責務を分離

```
.claude/skills/{skill-name}/
├── SKILL.md
├── guides/          # コンセプト、ツールの使い方
├── patterns/        # 実装パターン、方法論
└── examples/        # 具体的な実装例
```

### SKILL.mdで各セクションを明確に区切る

```markdown
## Instructions

### フェーズ1: 調査
...

### フェーズ2: 実装
...

### フェーズ3: テスト
...
```

### 参照ファイルは200行以下を目安に分割

1つのファイルが長くなりすぎる場合は、以下のように分割します：
- `patterns/implementation-phase1.md`
- `patterns/implementation-phase2.md`
- `patterns/implementation-phase3.md`

## 分割例

詳細な分割例は以下を参照してください：
- **[API開発の分割例](../examples/split-example-api-dev.md)**
- **[Admin開発の分割例](../examples/split-example-admin.md)**
