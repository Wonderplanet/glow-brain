---
name: api-sdd-v2-spec-confirmation
description: |
  2段階の仕様確認ワークフロー:要件調査の不明点からプランナー確認項目を整理し、確認結果を統合する。以下の場合に使用:(1) 要件調査の曖昧さ解消、(2) プランナー確認質問の準備、(3) 仕様の確定。Phase A:8つの観点(未定義仕様、実装乖離、状態管理、機能連携、セキュリティ、UI役割分担、実現性)で不明点を分析、確定要件の誤判定レビュー(PDF記載なし項目、コード前提項目)、フローチャートでプランナー確認が必要なものとサーバーチーム判断可能なものを分類、優先順位付けされた質問リストを出力。Phase B:プランナー回答を統合、解決状況を評価(完全/部分/未解決)、確定仕様を文書化、トレーサビリティを保ちながら残存不明点を明確化。重要:Stage 1確定要件の再チェック(PDF出典なし項目、新機能では異なる可能性のあるコード前提項目)。要件調査後の曖昧さ解消時、プランナー確認項目の整理時、仕様の確定時、要件の不確実性を排除する際に使用する。入力Phase A:01_要件調査.md。出力Phase A:02_仕様確認.md。入力Phase B:プランナー回答。出力Phase B:02_2_プランナー確認結果.md。
---

# SDD v2 仕様確認スキル

要件調査で洗い出された不明点・曖昧点をレビューし、プランナーへの確認項目を整理した上で、確認結果を統合するスキルです。

## 使用タイミング

- 要件調査完了後、仕様の曖昧さを解消する段階
- `/sdd-v2:spec-confirm {機能名}` コマンドから起動
- `sdd-orchestrator-v2` スキルから直接呼び出し

## 基本原則

1. **段階的な進行**: まず確認項目を洗い出し（Phase A）、確認後に結果を統合（Phase B）
2. **明確な分類**: プランナー確認が必要なものと不要なものを明確に区別
3. **最小限の確認**: 技術的な選択肢はサーバーチームで決定し、プランナーの負担を減らす
4. **トレーサビリティ**: 各確定仕様がどの確認結果から導かれたかを明記
5. **曖昧さの排除**: 確定した仕様は明確に、曖昧さを残さない表現で記述

## 入力

- **Phase A**: `docs/sdd-v2/features/{機能名}/01_要件調査.md`
- **Phase B**: ユーザーから提供されるプランナー確認結果

## 出力

- **Phase A**: `docs/sdd-v2/features/{機能名}/02_仕様確認.md` （確認項目リスト）
- **Phase B**: `docs/sdd-v2/features/{機能名}/02_2_プランナー確認結果.md` （確認結果統合）

## 作業フロー

詳細な作業手順とフォーマットは以下を参照：

@docs/sdd-v2/prompts/02_仕様確認_テンプレート.md

**Phase A: 確認項目の洗い出し**

1. 要件調査結果を8つの分析観点で評価
2. **確定要件のレビュー（重要）**: Stage 1で確定された要件のダブルチェック
   - PDF記載なしの要件はないか？
   - 既存コード前提で、新機能では異なる可能性がある要件はないか？
   - 推定要件として分類すべきものが確定要件に含まれていないか？
3. プランナー確認が必要な項目と不要な項目を分類（判断フローチャート使用）
4. 確認項目リストを質問形式で整理
5. 出力前の自己検証を実施

**Phase B: 確認結果の統合**

1. プランナー確認結果を受け取り
2. 各不明点の解決状況を評価（完全解決/部分解決/未解決）
3. 確定した仕様を整理
4. 残存する不明点を明記

## 8つの分析観点

1. 仕様上の未定義部分
2. ゲーム体験とコード実装の乖離
3. サーバー側で曖昧な要件
4. 状態管理に関する不明点
5. 他機能との連携漏れ
6. セキュリティ/不正対策上の曖昧さ
7. UIとの役割分担が不明な箇所
8. 実現性に問題がある仕様

## 確定要件のレビュー観点

**Stage 1で誤って確定された要件を検出するための重要なチェック:**

1. **PDF仕様書に記載がない要件**
   - 「Code C-X」のみを出典とする要件をリストアップ
   - それらが本当に確定要件として扱ってよいか再検討

2. **既存コードの動作を前提としているが、新機能では異なる可能性がある要件**
   - 既存にない新しいゲームメカニクスを導入する場合
   - 既存実装からの推論で確定させた要件を再チェック

3. **推定要件として分類すべきものが確定要件に含まれていないか**
   - PDF記載なしの仕様が確定要件として扱われていないか
   - 実装方式を断定している要件はないか

→ 問題のある要件は「推定要件（要確認）」に再分類し、プランナー確認項目に追加

## プランナー確認の判断基準

⚠️ **プランナー確認が必要**: ユーザーが画面で見る挙動・表示が変わる仕様の不明点

✅ **サーバー決定可能**: 既存実装パターンで解決できる技術的な選択肢

## 次のステップ

Phase B完了後、`api-sdd-v2-api-design` スキルでAPI設計書を作成。
