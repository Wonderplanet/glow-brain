# SDD プロンプトテンプレート 使用ガイド

このディレクトリには、Spec-Driven Development（SDD）プロセスを実行するためのプロンプトテンプレートが含まれています。

## 概要

各ステップのプロンプトテンプレートをAIに渡して、要件定義から設計まで段階的に作業を進めます。

### AIに渡す方法

下記のような指示文をAIに伝えます：
```
docs/sdd/prompts/01_サーバー要件抽出_テンプレート.md のテンプレートに従って、
{FEATURE_NAME} を「スタミナブースト」として作業を進めてください。
```

**PhpStorm + GitHub Copilot Chat**:
- Copilot Chat ウィンドウを開く（Alt+C / Cmd+Shift+C）
- 指示文を入力して送信

**VSCode + GitHub Copilot Chat**:
- Copilot Chat パネル（サイドバーまたはエディタ右側）を開く
- 指示文を入力して送信

## 前提条件

```bash
# 機能ディレクトリを作成
mkdir -p "docs/sdd/features/{機能名}"

# ゲーム体験仕様書PDFを配置
# docs/sdd/features/{機能名}/ゲーム体験仕様書.pdf
```

## テンプレート変数について

各プロンプトテンプレートには `{FEATURE_NAME}` というプレースホルダーが含まれています。
プロンプトをAIに渡す際、「`{FEATURE_NAME}` を `スタミナブースト` として作業を進めてください」のように指定します。

## 手動実行の流れ

### フェーズ1: 要件定義（Stage 1-5）

各ステップは順次実行してください。次のステップは前のステップの出力に依存します。

---

#### Stage 1: サーバー要件抽出

**目的**: ゲーム体験仕様書からサーバー関与が必要な項目を抽出

**実行方法**:

```
docs/sdd/prompts/01_サーバー要件抽出_テンプレート.md のテンプレートに従って、
{FEATURE_NAME} を「スタミナブースト」として作業を進めてください。
```

**出力ファイル**:
- `docs/sdd/features/{機能名}/01_サーバー要件抽出.md`

---

#### Stage 2: コード調査追記

**目的**: 仕様書に書かれていない暗黙の前提・制約をコードベースから洗い出し

**実行方法**:

```
docs/sdd/prompts/02_サーバー要件_コード調査追記テンプレート.md のテンプレートに従って、
{FEATURE_NAME} を「スタミナブースト」として作業を進めてください。
```

**出力ファイル**:
- `docs/sdd/features/{機能名}/02_サーバー要件_コード調査追記.md`

---

#### Stage 3: サーバー仕様レビュー

**目的**: 仕様を詳細化し、曖昧さ・不明点を評価

**実行方法**:

```
docs/sdd/prompts/03_サーバー仕様レビュー_テンプレート.md のテンプレートに従って、
{FEATURE_NAME} を「スタミナブースト」として作業を進めてください。
```

**出力ファイル**:
- `docs/sdd/features/{機能名}/03_サーバー仕様レビュー.md`
  - **重要**: このファイルに「プランナーへ確認が必要な項目まとめ」が含まれます

**次のステップ**:
- `03_サーバー仕様レビュー.md` の「4. プランナーへ確認が必要な項目まとめ」を確認
- プランナーに確認し、回答を記録してから Stage 4 へ進む

---

#### Stage 4: ゲーム体験仕様確認結果まとめ

**目的**: プランナー確認結果を整理し、不明点の解決状況を評価

**実行方法**:

```
docs/sdd/prompts/04_ゲーム体験仕様確認結果まとめ_テンプレート.md のテンプレートに従って、
{FEATURE_NAME} を「スタミナブースト」として作業を進めてください。

## プランナー確認結果
<プランナー確認結果をまとめてここに記載する>
```

**出力ファイル**:
- `docs/sdd/features/{機能名}/04_ゲーム体験仕様確認結果まとめ.md`

---

#### Stage 5: サーバーAPI要件書まとめ

**目的**: 全ての情報を統合し、完全で一貫性のある要件書を作成

**実行方法**:

```
docs/sdd/prompts/05_サーバーAPI要件書まとめ_テンプレート.md のテンプレートに従って、
{FEATURE_NAME} を「スタミナブースト」として作業を進めてください。
```

**出力ファイル**:
- `docs/sdd/features/{機能名}/05_サーバーAPI要件書.md`
  - **要件定義フェーズ完了！**

---

### フェーズ2: 設計（Stage 6-8）

Stage 6, 7, 8は**独立して実行可能**です。
すべて Stage 5 の出力（サーバーAPI要件書）を入力として使用します。

---

#### Stage 6: API実装全体概要設計

**目的**: どのAPIエンドポイントが関わるか全体像を把握（新規 vs 既存改修）

**実行方法**:

```
docs/sdd/prompts/06_API実装全体概要設計_テンプレート.md のテンプレートに従って、
{FEATURE_NAME} を「スタミナブースト」として作業を進めてください。
```

**出力ファイル**:
- `docs/sdd/features/{機能名}/06_API実装全体概要設計.md`

---

#### Stage 7: サーバーAPI設計書作成

**目的**: 各APIの詳細仕様を設計（リクエスト・レスポンス・エラー）

**実行方法**:

```
docs/sdd/prompts/07_サーバーAPI設計書作成_テンプレート.md のテンプレートに従って、
{FEATURE_NAME} を「スタミナブースト」として作業を進めてください。
```

**出力ファイル**:
- `docs/sdd/features/{機能名}/07_サーバーAPI設計書.md`

---

#### Stage 8: サーバーAPI機能要件実装設計

**目的**: 実装の詳細設計（DB設計・ドメイン設計・クリーンアーキテクチャ）

**実行方法**:

```
docs/sdd/prompts/08_サーバーAPI機能要件実装設計_テンプレート.md のテンプレートに従って、
{FEATURE_NAME} を「スタミナブースト」として作業を進めてください。
```

**出力ファイル**:
- `docs/sdd/features/{機能名}/08_サーバーAPI機能要件実装設計.md`
  - **設計フェーズ完了！**

---

## 使用例: スタミナブースト機能

### 準備

```bash
# ディレクトリ作成
mkdir -p "docs/sdd/features/スタミナブースト"

# ゲーム体験仕様書PDFを配置
# docs/sdd/features/スタミナブースト/ゲーム体験仕様書.pdf
```

### Stage 1の実行

AIに以下のように指示します：

```
docs/sdd/prompts/01_サーバー要件抽出_テンプレート.md のテンプレートに従って、
{FEATURE_NAME} を「スタミナブースト」として作業を進めてください。
```

出力ファイル：
- `docs/sdd/features/スタミナブースト/01_サーバー要件抽出.md`

### Stage 2-8も同様に実行

各ステップで対応するテンプレートファイル（02-08）を指定し、同じように実行します。

---

## 重要な原則

### 要件定義フェーズ（Stage 1-5）

- **実装非依存**: 「何を実現するか」のみ記述、「どう実装するか」には言及しない
- **中立性**: 実装方式を断定しない（「APIが必要」「DB更新が必須」など）
- **トレーサビリティ**: 各要件の出典（仕様書のページ番号など）を明記
- **完全性**: 曖昧さを排除し、プランナー確認で不明点を解消

### 設計フェーズ（Stage 6-8）

- **具体性**: 実装に必要な詳細まで設計
- **一貫性**: 既存実装との整合性を保つ
- **glow-server準拠**: クリーンアーキテクチャに従う

---

## 出力ファイル構成

各ステップで以下のファイルが生成されます:

```
docs/sdd/features/{機能名}/
├── ゲーム体験仕様書.pdf                         # 入力（手動配置）
├── 01_サーバー要件抽出.md                       # Stage 1の出力
├── 02_サーバー要件_コード調査追記.md            # Stage 2の出力
├── 03_サーバー仕様レビュー.md                   # Stage 3の出力
├── 04_ゲーム体験仕様確認結果まとめ.md           # Stage 4の出力
├── 05_サーバーAPI要件書.md                      # Stage 5の出力（要件定義完了）
├── 06_API実装全体概要設計.md                    # Stage 6の出力
├── 07_サーバーAPI設計書.md                      # Stage 7の出力
└── 08_サーバーAPI機能要件実装設計.md            # Stage 8の出力（設計完了）
```

---

## トラブルシューティング

### プロンプトテンプレートが見つからない

- `docs/sdd/prompts/` ディレクトリに8つのテンプレートファイルが存在するか確認
- ファイル名の接頭辞番号（01-08）が正しいか確認

### 出力ファイルが生成されない

- AIに明示的にファイル保存を指示しているか確認
- ファイルパスが正しいか確認（`docs/sdd/features/{機能名}/xx_xxx.md`）

### {FEATURE_NAME} の指定を忘れた

- AIに指示する際、「{FEATURE_NAME} を「機能名」として」と明示的に伝える
- プロンプトテンプレート内で `{FEATURE_NAME}` が使われている箇所を確認

### Stage 4でプランナー確認結果が不足

- Stage 3の出力ファイル「4. プランナーへ確認が必要な項目まとめ」を確認
- すべての項目について回答を取得してから Stage 4 を実行

---

## 関連ドキュメント

- **コマンド版ガイド**: `.claude/commands/sdd/README.md` - スラッシュコマンドを使用した自動実行
- **プロンプトテンプレート**: `docs/sdd/prompts/01-08_*.md` - 各Stageのテンプレート
