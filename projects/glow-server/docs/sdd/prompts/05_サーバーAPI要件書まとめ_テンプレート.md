あなたはゲームサーバー/API 開発のスペシャリストです。

これまでの全てのドキュメント分析結果を統合し、
サーバーAPIで実現すべき要件を完全な形でまとめた「サーバーAPI要件書」を作成してください。

【入力情報】
以下の4つのドキュメントを全て参照します:

1. サーバー要件抽出: @docs/sdd/features/{FEATURE_NAME}/01_サーバー要件抽出.md
2. コード調査追記: @docs/sdd/features/{FEATURE_NAME}/02_サーバー要件_コード調査追記.md
3. サーバー仕様レビュー: @docs/sdd/features/{FEATURE_NAME}/03_サーバー仕様レビュー.md
4. ゲーム体験仕様確認結果: @docs/sdd/features/{FEATURE_NAME}/04_ゲーム体験仕様確認結果まとめ.md

【出力ファイル】
- **以下のパスに Markdown として保存してください:**
  `@docs/sdd/features/{FEATURE_NAME}/05_サーバーAPI要件書.md`

========================
【目的】

- これまでのステップで得られた全ての情報を統合し、サーバーAPIで実現すべき要件を完全な形でまとめる
- 要件の重複を排除し、矛盾を解消し、完全で一貫性のある要件セットを作成する
- 各要件について、「何を実現する必要があるか」を明確に定義する
- ゲーム体験仕様の確認で明らかになった仕様を反映し、曖昧さを完全に排除する
- API実装者が「何を作るべきか」を正確に理解できる状態にする

※ 重要な注意事項:
1. このドキュメントは「サーバーAPI」の要件のみを対象とします
2. 管理ツール(admin)の要件は対象外です。管理ツールに関する言及は一切含めないでください
3. マスタデータ管理については、「APIがマスタデータをどう参照・利用するか」のみを記述し、「マスタデータの編集機能」には言及しません
4. ここでは「何を実現するか」を定義します。「どう実装するか」（API設計、DB設計、具体的な実装方式など）には言及しません
5. 出力容量が大量になる場合、エラーを回避する為に適度に小分けしながら対象ファイルに出力してください

========================
【作業手順】

1. **全ドキュメントの読み込みと理解**
   - 4つのドキュメントを全て読み込む
   - それぞれのドキュメントの役割と情報を理解する
   - 時系列での情報の変化（追加、修正、確定）を把握する

2. **要件の洗い出しと統合**
   - サーバー要件抽出で洗い出された初期要件を基礎とする
   - コード調査で追加された既存実装との関連情報を統合する
   - サーバー仕様レビューで洗い出された不明点・曖昧点を確認する
   - ゲーム体験仕様確認結果で確定した仕様を反映する

3. **要件の整理と体系化**
   - 重複する要件を統合する
   - 矛盾する要件を解消する（ゲーム体験仕様確認結果を最優先）
   - 関連する要件をグループ化する
   - 要件間の依存関係を明確にする

4. **曖昧さの排除**
   - ゲーム体験仕様確認結果で確定した仕様を全て反映する
   - 残存する不明点がある場合は明記する
   - 条件分岐や例外ケースを明確にする

5. **出力ドキュメントの作成**
   - 以下のフォーマットで Markdown を生成する

========================
【出力フォーマット】

出力は、以下の構造で Markdown を生成してください。

# サーバーAPI要件書

## 1. ドキュメント情報
- 対象機能: {FEATURE_NAME}
- 作成日: YYYY-MM-DD
- 参照ドキュメント:
  - 01_サーバー要件抽出.md
  - 02_サーバー要件_コード調査追記.md
  - 03_サーバー仕様レビュー.md
  - 04_ゲーム体験仕様確認結果まとめ.md

## 2. 機能概要
- この機能がユーザーに提供するゲーム体験の概要を簡潔に記述
- サーバーAPIが果たす役割の概要を記述

## 3. API要件一覧

### 3.1 カテゴリA（適切なカテゴリ名に変更）

#### 要件 A-1: （要件の簡潔なタイトル）
- **要件ID:** REQ-A-1
- **概要:**
  - この要件で実現すべき内容を簡潔に記述
- **詳細仕様:**
  - ゲーム体験仕様書の記載:
    - （ゲーム体験仕様書からの抜粋、または参照ページ情報）
  - APIで実現すべき内容:
    - （箇条書きで具体的に記述）
  - 条件・制約:
    - （適用条件、制限事項、例外ケースなどを明記）
  - データ管理要件:
    - （管理すべきデータ、データの永続化要件など）
  - 検証・チェック要件:
    - （API側で検証すべき内容、不正防止要件など）
- **既存実装との関連:**
  - （既存のテーブル、ロジック、APIとの関連があれば記載）
- **備考:**
  - （補足事項、注意点など）

#### 要件 A-2: （同様に続ける）
（以下略）

### 3.2 カテゴリB（適切なカテゴリ名に変更）
（同様の構造で各カテゴリの要件を記述）

## 4. 要件間の依存関係

### 4.1 前提となる要件
- 要件 X は 要件 Y が実現されていることを前提とする
- （他の依存関係があれば記載）

### 4.2 同時に実現すべき要件
- 要件 P と 要件 Q は同時に実現される必要がある
- （他の同時実現要件があれば記載）

## 5. 非機能要件

### 5.1 パフォーマンス要件
- （レスポンスタイム、スループット、同時接続数など、分かっている範囲で記載）

### 5.2 セキュリティ要件
- （不正防止、データ保護など、API側で考慮すべきセキュリティ要件）

### 5.3 可用性要件
- （サービス継続性、エラーハンドリングなど）

### 5.4 その他の非機能要件
- （ログ記録、監視、運用に関する要件など）

## 6. データ要件

### 6.1 永続化が必要なデータ
- データ項目A:
  - 内容: （何を記録するか）
  - 用途: （何のために記録するか）
  - 保持期間: （永久 / 期間限定 / 不明）
  - 関連要件: REQ-X-Y

（他のデータ項目も同様に記述）

### 6.2 一時的に管理が必要なデータ
- （キャッシュ、セッションデータなど）

## 7. 外部システム連携要件

### 7.1 クライアント連携
- （クライアントとのデータ送受信、同期要件など）

### 7.2 他API機能との連携
- （既存の他機能との連携要件）

### 7.3 外部サービス連携
- （プッシュ通知、決済、外部APIなど）

## 8. 残存する不明点・要確認事項

### 8.1 まだ不明な仕様
- （項目名）
  - 何が不明か:
  - 実装への影響:
  - 確認すべき相手:

### 8.2 実装時に判断が必要な事項
- （仕様は確定しているが、実装方式の選択肢が複数ある項目など）

## 9. 要件確定度の評価

### 9.1 全体評価
- 要件の確定度: XX%
- API実装に必要な要件情報の充足度: 十分 / やや不足 / 不足
- 実装開始の可否: 可 / 条件付き可 / 不可

### 9.2 カテゴリ別評価
- カテゴリA: （確定度、課題、実装準備状況）
- カテゴリB: （確定度、課題、実装準備状況）
（以下略）

## 10. 次のステップ

### 10.1 要件確定のために必要なアクション
- [ ] （追加で確認すべき項目があれば記載）
- [ ] （仕様確定のために必要なアクションがあれば記載）

### 10.2 実装設計へ向けて
- [ ] （APIエンドポイント設計、DB設計など、次に着手すべき設計作業）
- [ ] （技術選定、アーキテクチャ検討など）

========================
【カテゴリ分けのガイドライン】

要件を論理的にグループ化するため、適切なカテゴリに分類してください。
カテゴリの例（実際の要件内容に応じて柔軟に調整してください）:

※ 注意: API要件のみを対象とし、管理ツール(admin)関連のカテゴリは含めません

- **マスタデータ参照**: APIがマスタデータをどう参照・利用するか
- **データ管理**: ゲーム内データの管理、状態の記録
- **報酬・アイテム付与**: 報酬の計算、アイテムの付与
- **条件判定・検証**: 実行条件のチェック、不正検知
- **ゲームロジック**: ゲームルールの実装
- **通知・同期**: クライアントへの通知、データ同期
- **集計・ランキング**: データの集計、ランキング計算
- **課金・決済**: 課金処理、購入履歴
- **イベント管理**: 期間限定イベント、スケジュール管理
- **ユーザー管理**: ユーザー情報、権限管理
- **外部連携**: 他システムとの連携

========================
【要件記述のポリシー】

1. **API要件のみに限定**
   - このドキュメントはサーバーAPIの要件のみを対象とする
   - 管理ツール(admin)の要件は一切含めない
   - マスタデータの編集機能については言及しない（APIがマスタデータをどう参照・利用するかのみを記述）

2. **曖昧さの排除**
   - 「〜かもしれない」「〜の可能性がある」といった表現は避ける
   - ゲーム体験仕様確認結果で確定した仕様は、確定した内容として明確に記述する
   - まだ不明な点は「残存する不明点」セクションに明記する

3. **実装から独立した記述**
   - 「APIエンドポイントを作成する」「DBテーブルを追加する」といった実装手段には言及しない
   - 「〜を管理する」「〜を記録する」「〜を検証する」など、機能的な記述にとどめる
   - ただし、既存実装との関連は記載する（「既存の〇〇テーブルを参照する」など）

4. **具体性と網羅性**
   - 抽象的な記述ではなく、具体的な条件や数値を記載する
   - 正常系だけでなく、異常系や例外ケースも記述する
   - エッジケース、境界値についても考慮する

5. **トレーサビリティの確保**
   - 各要件が元のドキュメントのどこから来たかを追跡可能にする
   - 要件IDを付与し、参照を容易にする
   - ゲーム体験仕様書のページ番号なども可能な限り記載する

6. **一貫性の維持**
   - 用語の使い方を統一する
   - 要件間で矛盾がないようにする
   - 矛盾がある場合は、ゲーム体験仕様確認結果を優先し、その旨を明記する

========================
【統合時の優先順位】

異なるドキュメント間で情報が矛盾する場合、以下の優先順位で判断してください:

1. **最優先**: ゲーム体験仕様確認結果まとめ.md
   - ゲーム企画担当者に確認して確定した最新の仕様

2. **次点**: サーバー仕様レビュー.md
   - 専門家レビューで指摘された考慮事項

3. **参考**: サーバー要件_コード調査追記.md
   - 既存実装の情報

4. **基礎**: サーバー要件抽出.md
   - 初期抽出された要件

矛盾を解消した場合は、その旨を備考欄に記載してください。

========================
【重要】
生成したサーバーAPI要件書は、Markdown として
**@docs/sdd/features/{FEATURE_NAME}/05_サーバーAPI要件書.md**
に保存してください。

========================

以上を踏まえて、
これまでの全てのドキュメントを統合した完全なサーバーAPI要件書を作成し、
md ファイルとして保存してください。
