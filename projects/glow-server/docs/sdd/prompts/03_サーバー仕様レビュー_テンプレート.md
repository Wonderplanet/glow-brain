あなたはゲームサーバー/API 開発のスペシャリストです。

以下の 2 ファイルを元データとして扱い、  
ゲーム体験仕様の観点でサーバー実装に必要な粒度まで内容を詳細化し、  
曖昧さ・矛盾・不足を評価する仕様レビュー・レポートを作成してください。

【入力ファイル】
1. 仕様書ベース: @docs/sdd/features/{FEATURE_NAME}/01_サーバー要件抽出.md
2. コード調査ベース: @docs/sdd/features/{FEATURE_NAME}/02_サーバー要件_コード調査追記.md

【出力ファイル】
- **最終レポートを Markdown として、以下のパスに保存してください：**
  `@docs/sdd/features/{FEATURE_NAME}/03_サーバー仕様レビュー.md`

========================
【目的】

- サーバー観点で必要な仕様を *実装可能なレベルまで詳細化* する
- 仕様書に曖昧・未定義・判断不能な部分がないか、客観的に評価する
- プランナーへ確認/相談すべき点を洗い出す
- サーバー側で仕様確定に必要な論点を明文化する

**【重要】プランナー確認項目の判断基準：**

以下は**サーバーチームで決定可能**なため、プランナー確認項目に含めないでください：

1. **既存実装パターンで解決できる技術的な選択肢**
   - 例：リセット処理の実装方法（バッチ処理 vs アクセス時判定）
   - コード調査で「適用範囲に該当する」と記載されている場合、既存パターンに倣う

2. **実装方法の詳細で、ゲーム体験に影響しないもの**
   - 例：トランザクション処理の方式、ログ出力の形式

3. **既存の技術基盤・アーキテクチャに関する判断**
   - 例：RewardDelegatorの使用、Clock機能の利用

プランナー確認が**必要**なのは：

1. **ゲーム体験に影響する仕様の不明点**
   - 例：交換上限到達後のUI表示、リソース不足時の表示形式

2. **複数の実装方法でユーザー体験が変わる場合の選択**
   - 例：初回無料機能の有無、売却機能の実装範囲

3. **既存実装パターンでは実現不可能な要件**
   - 例：新しいリソースタイプの追加、既存にない特殊な処理

========================
【分析観点】

以下の観点で両ファイルを照合し、問題点・曖昧さ・不足を洗い出してください：

1. **仕様上の未定義部分**
2. **ゲーム体験とコード実装の乖離**
3. **サーバー側で曖昧な要件**
4. **状態管理に関する不明点**
5. **他機能との連携漏れ**
6. **セキュリティ/不正対策上の曖昧さ**
7. **UI との役割分担が不明な箇所**
8. **実現性に問題がある仕様**

========================
【出力フォーマット】

出力は、以下の構造で Markdown を生成してください。

# サーバー実装観点の仕様レビュー（自動分析レポート）

## 1. 要約
- 現時点での仕様の明瞭さ/不明瞭さの総評
- 大きなリスク・不確定要素の概要

## 2. 仕様の詳細化（サーバー観点）
サーバーが扱う仕様を、曖昧さを排除した形で統合して整理してください。

## 3. 不明点・曖昧点・判断が必要な項目

### A. 仕様書に記載がなく判断不能な項目
- （項目名）
  - 該当箇所:
  - 何が曖昧なのか:
  - サーバーとして明確化が必要な理由:

### B. 仕様書とコードの不一致
- （項目名）
  - 該当ファイル:
  - どのように矛盾しているか:
  - 影響:

### C. サーバー側で仕様確定が必要な項目
- （項目名）
  - 決める必要がある点:
  - プランナーへの確認ポイント:

### D. ゲーム体験的に不自然な可能性がある項目
- （項目名）
  - 問題点:
  - 想定される影響:

## 4. プランナーへ確認が必要な項目まとめ（最重要）
質問文の形式で列挙してください。

例：
- Q1: 〜〜について、どちらの挙動を想定していますか？
- Q2: 境界条件（〜〜）をどのように扱いますか？

## 5. サーバー開発への影響まとめ
- 実装前に必ず詰めるべき論点
- 不明点が残る場合のリスク
- スケジュール・品質への影響

========================
【表現ポリシー】

- 実装方針（API の追加等）を「断定しない」
- 「仕様確定に必要な論点」の抽出に集中する
- 推測が含まれる場合は「推測」と明記する
- **コード調査で「既存実装パターンの適用範囲に該当する」と記載されている場合、それを不明点として扱わない**
  - 例：リセット処理が既存パターンの適用範囲内なら、プランナー確認項目に含めない

========================
【重要】
生成したレポートは、Markdown として
**@docs/sdd/features/{FEATURE_NAME}/03_サーバー仕様レビュー.md**
に保存してください。

========================

以上を踏まえて、  
仕様書要件・コード要件を統合したサーバー仕様レビューを作成し、  
md ファイルとして保存してください。
