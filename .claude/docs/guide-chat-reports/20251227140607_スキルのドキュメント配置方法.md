# Claude Code ガイド相談レポート

**日付**: 2025年12月27日
**トピック**: スキルでドキュメントを参照させる際のファイル配置方法

## 相談内容

- スキルで特定のドキュメントファイルを参照させる際の配置方法
  1. `.claude/skills/スキル名/` 内に配置する方法
  2. 別ディレクトリ（`docs/` など）に配置して `SKILL.md` でリンクする方法
- 上記2つの方法における精度、パフォーマンス、その他の違い

## 重要な結論・学び

### 配置方法による違い

#### ✅ 推奨：`.claude/skills/スキル名/` 内に配置

> 出典: [Claude Code - Skills](https://code.claude.com/docs/en/skills.md)

**メリット:**
- **自動検出**: Claudeがファイルを自動的に発見しやすい
- **Progressive Disclosure**: 必要な情報を段階的に読み込む効率的な設計
  - `SKILL.md` には概要と指示のみ（500行以下推奨）
  - 詳細は別ファイルにしてリンクで参照（必要時のみ読込）
- **パフォーマンス**: トークン消費が最適化される

**推奨構造:**
```
.claude/skills/my-skill/
├── SKILL.md           # 概要・ナビゲーション（500行以下推奨）
├── reference.md       # 詳細リファレンス（リンク参照）
├── examples.md        # 使用例（リンク参照）
└── scripts/
    └── helper.py      # スクリプト（実行のみ）
```

#### ❌ 非推奨：別ディレクトリ（`docs/` など）に配置

**デメリット:**
- Claudeが自動的に見つけづらい
- パフォーマンスが低下する可能性
- ファイル参照の方向解決に余計なトークンを消費する可能性

### Progressive Disclosure パターン

公式ドキュメントで推奨されている設計パターン：

> 出典: [Claude Code - Add supporting files with progressive disclosure](https://code.claude.com/docs/en/skills.md#add-supporting-files-with-progressive-disclosure)

1. **SKILL.md は簡潔に保つ**（500行以下推奨）
   - スキルの概要と使用方法のみ記載
   - 詳細資料へのリンクを提供

2. **詳細情報は別ファイルで管理**
   - 詳細なリファレンス、API仕様、使用例などは別ファイルに分離
   - SKILL.md からリンクで参照

3. **スクリプトは実行のみ**
   - スクリプトの内容は読み込まれない
   - 実行可能なユーティリティとして配置

**コード例**（SKILL.md 内での参照）:

    ## 詳細について

    スキルの詳細な使用方法については以下を参照してください：

    - [CSVスキーマ詳細](CSV_SCHEMA.md)
    - [実装ガイド](GUIDE.md)
    - [サンプルコード集](examples.md)

    ## バリデーション実行

    バリデーションを実行するには：

        python scripts/validate.py input.csv

### 重要な制約：1階層までの参照

公式ドキュメントで明記されている制約：

> 出典: [Claude Code - Example multi-file skill structure](https://code.claude.com/docs/en/skills.md#example-multi-file-skill-structure)
>
> **Keep references one level deep**
>
> Link directly from SKILL.md to reference files. Deeply nested references
> (file A links to file B which links to file C) may result in Claude
> partially reading files.

**ベストプラクティス**:
- ✅ `SKILL.md` → `reference.md` （1階層）
- ❌ `SKILL.md` → `guide.md` → `examples.md` （多階層）

### 実践例：GLOW プロジェクトでの適用

```
.claude/skills/glow-masterdata/
├── SKILL.md                    # 概要と指示（500行以下）
├── CSV_GUIDE.md               # CSVガイド（詳細）
├── SCHEMA_REFERENCE.md        # スキーマ仕様（詳細）
├── EXAMPLES.md                # 実装例（詳細）
└── scripts/
    ├── validate.py            # バリデーションスクリプト
    └── generate.py            # 生成スクリプト
```

**SKILL.md の構成例**:

    # GLOW マスターデータスキル

    GLOWプロジェクトの施策マスターデータCSV作成を支援します。

    ## 基本的な使い方

    1. 施策仕様書を確認
    2. 該当するマスターテーブルを特定
    3. スクリプトでCSVを生成

    ## 詳細ドキュメント

    - [CSVガイド](CSV_GUIDE.md) - CSV作成の詳細手順
    - [スキーマリファレンス](SCHEMA_REFERENCE.md) - 各テーブルの仕様
    - [実装例](EXAMPLES.md) - 実際の施策での使用例

    ## スクリプト

    バリデーション:

        python scripts/validate.py input.csv

    CSV生成:

        python scripts/generate.py --type pack --data spec.json

## 精度・パフォーマンス比較表

| 観点 | `.claude/skills/` 内配置 | 別ディレクトリ配置 |
|------|-------------------------|------------------|
| **精度** | 高（自動検出） | 低（手動参照必要） |
| **パフォーマンス** | 優れている（段階的読込） | 劣る（解決コスト増） |
| **保守性** | 優れている | 複雑になりやすい |
| **トークン効率** | 最適化されている | 非効率的 |
| **推奨度** | ⭐️ **強く推奨** | 非推奨 |

## ベストプラクティス

1. **ドキュメントは必ずスキルディレクトリ内に配置**
   - `.claude/skills/スキル名/` 内に全関連ファイルを配置

2. **SKILL.md は簡潔に保つ**
   - 500行以下を目標
   - 概要と使用方法のみ記載

3. **詳細情報は別ファイルに分離**
   - API仕様、リファレンス、使用例などを分離
   - SKILL.md から相対パスでリンク

4. **参照は1階層まで**
   - 多段参照（A→B→C）は避ける
   - SKILL.md から直接参照ファイルへリンク

5. **スクリプトは実行用のみ**
   - `scripts/` ディレクトリに配置
   - コード内容は読み込まれないため、ドキュメントとは分離

## 注意点

- ❌ **多段参照は避ける**: ファイル参照は1階層までにすること
- ❌ **外部ディレクトリに配置しない**: スキル関連ファイルはすべてスキルディレクトリ内に
- ❌ **SKILL.md を肥大化させない**: 詳細は別ファイルに分離して参照
- ✅ **相対パスを使用**: リンクは相対パスで記述
- ✅ **Progressive Disclosure**: 必要な情報を段階的に提供する設計

## 参照ドキュメント

- [Claude Code - Skills](https://code.claude.com/docs/en/skills.md) - スキルの基本概念と作成方法
- [Add supporting files with progressive disclosure](https://code.claude.com/docs/en/skills.md#add-supporting-files-with-progressive-disclosure) - 段階的な情報開示パターン
- [Example multi-file skill structure](https://code.claude.com/docs/en/skills.md#example-multi-file-skill-structure) - 参照階層の制約（Keep references one level deep）
- [Agent Skills - Best Practices](https://docs.claude.com/en/docs/agents-and-tools/agent-skills/best-practices) - Progressive Disclosure の詳細ガイダンス

## 次のアクション

1. **既存スキルの見直し**
   - 現在のスキル構成を確認
   - ドキュメントが外部に配置されていないか確認

2. **GLOW プロジェクトでの実装**
   - `glow-masterdata` スキルの構成を最適化
   - Progressive Disclosure パターンを適用

3. **テンプレート作成**
   - 今後のスキル作成用のテンプレートを作成
   - ベストプラクティスに従った構成を標準化

4. **ドキュメント分割の検討**
   - 500行を超える SKILL.md がある場合は分割
   - 詳細情報を別ファイルに移動

---

*このレポートは `/guide-chat` コマンドにより自動生成されました*
