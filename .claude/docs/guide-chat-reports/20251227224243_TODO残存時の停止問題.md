# Claude Code ガイド相談レポート

**日付**: 2025年12月27日
**トピック**: TODOが残っているのに作業が途中で止まる問題

## 相談内容

- TODOリストが残っている状態で、Claude Codeが確認を求めることなく勝手に停止する現象について
- この問題が既知のissueとして報告されているか
- 原因と回避策について

## 重要な結論・学び

### 既知の問題として複数報告されている

この問題は実際に複数のGitHub Issueで報告されている既知の問題です：

- **Issue #6159**: Agent Stops Mid-Task - 詳細な計画とTODOリストを作成後、途中で終了してしまう
- **Issue #6623**: TODO Tracking Functionality Broken - TODOリストの追跡機能が完全に機能しない
- **Issue #599**: Claude Code terminates prematurely - TODOリストを完了せずに早期終了
- **Issue #1066**: Claude stops and waits for user input with TODO list - TODOリスト残存状態で停止
- **Issue #1632**: Claude stops, forgetting unfinished TODOs - 未完了TODOを忘れて停止

**特徴的なパターン**:
- タスクの約50～60%完了地点で一貫して停止する傾向
- 確認を求めるわけではなく、単に処理を中止してしまう
- 複雑なマルチステップタスクで発生しやすい

### 関連する可能性のある仕様

#### Checkpointing機能
自動的な変更追跡とリワインド機能があり、複雑な作業の状態管理に関連している可能性があります。

> 参考: [Checkpointing Documentation](https://code.claude.com/docs/en/checkpointing.md)

#### Stop/SubagentStopフック
Claudeがいつ停止するかを制御する仕様に関連しています。`Stop`および`SubagentStop`フックで停止条件を制御できます。

> 参考: [Hooks Documentation](https://code.claude.com/docs/en/hooks.md)

### ユーザーが報告している回避策

1. **明示的な継続プロンプト**
   - 「残りのタスクを完了してください」と明示的に指示する
   - 「remaining casesを実装してください」のような具体的な指示を追加

2. **タスクの小分け**
   - 大きなタスクを小さなステップに分割
   - 各ステップを明確に分離して実行

3. **チェックポイントの設置**
   - 進捗状況を定期的に確認するポイントを設ける
   - 各段階で完了を確認しながら進める

## 参照ドキュメント・Issue

公式ドキュメント：
- [Claude Code Troubleshooting Documentation](https://code.claude.com/docs/en/troubleshooting.md)
- [Checkpointing Documentation](https://code.claude.com/docs/en/checkpointing.md)
- [Hooks Documentation](https://code.claude.com/docs/en/hooks.md)

関連GitHub Issues：
- [Issue #6159: Agent Stops Mid-Task](https://github.com/anthropics/claude-code/issues/6159)
- [Issue #6623: TODO Tracking Functionality Broken](https://github.com/anthropics/claude-code/issues/6623)
- [Issue #599: Terminates prematurely](https://github.com/anthropics/claude-code-action/issues/599)
- [Issue #1066: Stops and waits with TODO list](https://github.com/anthropics/claude-code/issues/1066)
- [Issue #1632: Forgets unfinished TODOs](https://github.com/anthropics/claude-code/issues/1632)

## 次のアクション

- 複雑なタスクを実行する際は、明示的に「最後まで完了してください」と指示を含める
- 大きなタスクは可能な限り小さなステップに分割する
- Stop/SubagentStopフックの設定を確認し、必要に応じてカスタマイズを検討
- 問題が頻発する場合は、上記のGitHub Issuesを監視して最新の情報や解決策を確認

---

*このレポートは `/claude-code:guide-chat` コマンドにより自動生成されました*
