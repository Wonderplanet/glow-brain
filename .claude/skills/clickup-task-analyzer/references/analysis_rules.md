# ClickUpタスク分析ルール

このドキュメントでは、タスク情報から正確な分析レポートを生成するための重要なルールを定義します。

## 開発期間の算出

**重要**: タスク作成日（`created_date`）ではなく、**最も早い期限日（`due_date`）を開発開始日とする**

### 理由
- タスク作成日はプロジェクト計画時や事前準備期間を含む
- 実際の開発開始は、最初のタスクの期限日で判断する方が正確

### 実装
```python
def calculate_date_range(tasks):
    """最も早い期限日 ～ 最も遅い期限日を返す"""
    dates = [
        datetime.fromisoformat(task['due_date'])
        for task in tasks
        if task.get('due_date')
    ]
    return min(dates), max(dates)
```

### 例
```
タスク作成日: 2025-10-27
最も早い期限日: 2025-12-05  ← この日付を開発開始日とする
最も遅い期限日: 2026-02-02

正しい開発期間: 2025-12-05 ～ 2026-02-02（約2ヶ月）
誤った開発期間: 2025-10-27 ～ 2026-02-02（約3ヶ月） ← 使用しない
```

## 職種分類ルール

タスク名のプレフィックスと実際の作業内容から職種を判定します。

### 1. サーバーエンジニア

**判定条件:**
- タスク名が`(サバ)`で始まる
- タスク名に`管理ツール`が含まれる
- データベース、API、バックエンド関連のキーワード

**例:**
- `(サバ)スタミナ回復アイテム`
- `(サバ)BOXガシャ`
- `管理ツール_BOXガシャ`

### 2. クライアントエンジニア

**判定条件:**
- タスク名が`(クラ)`で始まる
- タスク名が`(スキル)`で始まる（プランナーではない！）
- タスク名に`スキル`が含まれる実装タスク
- Unity、C#、クライアント実装関連のキーワード

**重要**: スキル実装タスクはクライアントエンジニアの作業です。

**例:**
- `(クラ)BOXガシャ(Data層対応)`
- `(クラ)スタミナ回復アイテム`
- `(スキル_作品バフ)スキルによる付与` ← クライアントエンジニア
- `スキル：作品・キャラID絞り込み` ← クライアントエンジニア
- `(スキル_作品バフ)ステージスペシャルルールによる付与` ← クライアントエンジニア

### 3. UIデザイナー

**判定条件:**
- タスク名が`(UI)`で始まる
- タスク名に`_T[数字]`が含まれる（デザインタスク番号）
- プレハブ、デザイン、画面レイアウト関連のキーワード

**例:**
- `v1.5.0(01_07)3_(UI)スタミナ回復アイテムT8`
- `v1.5.0(01_07)11_(UI)BOXガシャT9`
- `地獄楽分のガシャプレハブ作成とテンプレート作成`

### 4. プランナー/ディレクター

**判定条件:**
- 要件定義、仕様策定関連のタスク
- タスク管理システムに明示的なタスクがない場合が多い

**重要**: スキル実装タスクはプランナーの作業ではありません。

**例:**
- 要件定義タスク（タスク管理システムに記録されないことが多い）

### 5. QA・テスト

**判定条件:**
- タスク名に`QA期間`が含まれる
- タスク名が`QA`で始まる

**重要**: QA期間タスクの担当者（`assignees`）は開発メンバー全員の可能性があるため、**QA専任メンバーとして記載しない**

**例:**
- `[1.5.0]QA期間`
- `QAテスト`

**QA体制の記述例:**
```markdown
### QA・テスト

**作業内容**:
1. **[1.5.0]QA期間** - 期限: 2026-01-23
   - 全開発メンバーがQA期間タスクに参加
   - 包括的な機能テストと品質確認

**備考**:
- QA専任メンバーの情報はタスク管理システムに記録されていない
- 開発メンバー全員がQA期間に参画する体制
```

### 6. その他

**判定条件:**
- リリース管理、データエンジニアなど、上記に該当しない職種

**例:**
- `リリース`
- `サブミット対応`
- `データレイク転送テスト`

## 職種判定の優先順位

1. プレフィックス判定（`(サバ)`, `(クラ)`, `(UI)`, `(スキル)`）
2. キーワード判定（`管理ツール`, `スキル`, `QA期間`等）
3. 担当者の実作業内容から推測
4. デフォルト: `その他`

## タイムライン生成ルール

タスクの期限日をもとに、プロジェクトの主要マイルストーンをASCII図形式で可視化します。

### フォーマット
```
YYYY-MM-DD  マイルストーン名
   |        - 詳細1
   |        - 詳細2
   v
MM月XX旬   フェーズ名
   |        - 詳細
```

### 例
```
2025-12-05  プロジェクト開始
   |        - スタミナ回復アイテム実装開始 (Junki)
   v
12月上旬   サーバー実装開始
   |        - UI実装開始 (Rira)
   v
12月中旬   クライアント実装本格化
   |        - BOXガシャ Data層 (Kiryu)
```

## 工数分析ルール

### タスク期限から見た工数配分

期限日を週/月単位でグループ化し、各期間のタスク数と主な内容を集計します。

### 職種別作業負荷

各職種の主要担当者数、作業期間、タスク数から作業負荷を判定します。

**作業負荷レベル:**
- **高**: 1人あたり5タスク以上、または期間が1ヶ月以上
- **中**: 1人あたり3-4タスク、または期間が2-4週間
- **低**: 1人あたり1-2タスク、または期間が1週間以内

## よくある間違い

### ❌ 間違い1: タスク作成日を開発開始日とする

```markdown
開発期間: 2025年10月27日 ～ 2026年2月2日（約3ヶ月） ← 誤り
```

**正しくは:**
```markdown
開発期間: 2025年12月5日 ～ 2026年2月2日（約2ヶ月）
```

### ❌ 間違い2: スキル実装タスクをプランナーに分類

```markdown
### プランナー/ディレクター

#### Kenta Inui
1. (スキル_作品バフ)スキルによる付与  ← 誤り（クライアントエンジニアの作業）
```

**正しくは:**
```markdown
### クライアントエンジニア

#### Kenta Inui
1. (スキル_作品バフ)スキルによる付与  ← 正しい
```

### ❌ 間違い3: QA期間タスクの担当者をQA担当者とする

```markdown
### QA

**担当者**:
- daichi_takishima
- Kazuomi Sawada
- wataru shigeyama
...（開発メンバー全員） ← 誤り
```

**正しくは:**
```markdown
### QA・テスト

**作業内容**:
1. **[1.5.0]QA期間** - 期限: 2026-01-23
   - 全開発メンバーがQA期間タスクに参加

**備考**:
- QA専任メンバーの情報はタスク管理システムに記録されていない
```

## レポート品質チェックリスト

- [ ] 開発期間は最も早い期限日から算出されているか
- [ ] スキル実装タスクはクライアントエンジニアに分類されているか
- [ ] QA期間タスクの担当者をQA専任メンバーとして記載していないか
- [ ] タイムラインは期限日に基づいて正確に生成されているか
- [ ] 職種分類はプレフィックスとキーワードで正確に判定されているか
- [ ] 工数分析は実際のタスク数と期間から算出されているか
