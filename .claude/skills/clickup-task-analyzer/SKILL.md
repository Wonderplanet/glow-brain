---
name: clickup-task-analyzer
description: ClickUpタスクJSONから構造化されたプロジェクト分析レポート（Markdown形式）を自動生成します。「ClickUpタスク分析」「プロジェクト分析レポート」「タスク情報分析」「開発プロジェクト分析」などで使用します。インプット: domain/raw-data/clickup/{Space}/{Folder}/{List}/_list_tasks_raw_phase2_with_subtasks.json、アウトプット: domain/knowledge/project-management/clickup/{Space}/{Folder}/{List}/タスク分析.md
disable-model-invocation: false
---

# ClickUpタスク分析スキル

ClickUpリストのタスク情報JSONから、プロジェクト概要、職種別作業分析、開発フロー、工数分析、総括を含む構造化された分析レポートを自動生成します。

## 使用方法

### 基本的な使い方

ユーザーがClickUpタスク分析を依頼した場合、以下の手順で実行します：

#### ステップ1: リスト種別の認識

まず、リストのパス構造から種別を認識します：

- **開発管理リスト**: `domain/raw-data/clickup/GLOW/GLOW(開発)/v1.5.0`
- **QA管理リスト**: `domain/raw-data/clickup/GLOW/QA/アプリQA_Ver1.5.0`
- **運営施策リスト**: `domain/raw-data/clickup/GLOW/運営/施策名`

詳細は [list_types.md](references/list_types.md) を参照。

#### ステップ2: jqクエリで全体把握（任意）

基本統計を確認したい場合は、query_helper.shを実行：

```bash
bash .claude/skills/clickup-task-analyzer/scripts/query_helper.sh <clickup-list-directory>
```

出力例：
```
=== プレフィックス集計 ===
   8 (クラ)
   3 (サバ)
   3 (UI)
   2 (スキル)
   1 なし

=== 担当者別タスク数 ===
   5 Hiroshi Sato
   4 Kentaro Ito
   3 Takeshi Tanaka
```

#### ステップ3: 基本レポート生成

Pythonスクリプトで基本レポートを生成：

```bash
python3 .claude/skills/clickup-task-analyzer/scripts/analyze_tasks.py <clickup-list-directory>
```

出力先: `domain/knowledge/project-management/clickup/{Space}/{Folder}/{List}/タスク分析.md`

**重要**: このスクリプトは以下を自動実行します：
- メンバー一覧.csvから職種情報を取得して正確な職種分類を実施
- 職種別タスク一覧を生成
- プロジェクト概要と基本統計を算出

**職種分類の精度**:
- メンバー一覧.csv登録者: 100%正確（CSV情報を優先）
- 未登録者: タスク名プレフィックスから推測（フォールバック）

#### ステップ4: AI詳細分析

基本レポートを読み込み、以下の詳細分析を追加します：

**重要: 職種分類の扱い**
- 基本レポートの職種分類は**変更禁止**（メンバー一覧.csvに基づく正確な分類）
- AIは職種分類を**検証のみ**（明らかな誤りがある場合のみ報告）
- 職種分類を勝手に変更したり、上書きしたりしない

**AI詳細分析の内容**:

1. **職種別作業分析の詳細化**
   - 基本レポートの職種分類を**そのまま使用**
   - 各職種の主な担当者とタスク数を明記
   - 作業内容の詳細を追加（基本レポートのタスク一覧から抽出）

2. **リスト種別に応じた分析**
   - 開発リスト: タイムライン、開発フロー、主要タスク詳細分析
   - QAリスト: バグカテゴリ分析、優先度分析、修正担当者分析
   - 運営リスト: 施策内容分析、運営フロー

3. **工数分析**
   - 職種別作業負荷、期限日から見た工数配分

4. **総括**
   - 成功要因、課題と改善点、プロジェクト特性

**参考**: [example_report.md](references/example_report.md) の構成を参考にしてください。

### インプットファイル形式

```json
{
  "total_count": 100,
  "tasks": [
    {
      "id": "86ew6hyg4",
      "name": "(受け入れ)ガシャ一覧画面の刷新",
      "status": "Closed",
      "due_date": "2026-01-16T04:00:00",
      "created_date": "2026-01-13T17:10:31.540000",
      "assignees": ["kenji_watanabe"],
      "parent": "86evjvued"
    }
  ]
}
```

### アウトプット形式

生成されるレポートには以下のセクションが含まれます：

1. **プロジェクト概要** - バージョン、開発期間、リリース日、タスク総数
2. **主要機能** - 親タスクごとの機能一覧
3. **職種別作業分析** - 職種ごとの担当者と作業内容
4. **工数分析** - 職種別作業負荷表
5. **総括** - プロジェクト特性と完了率

## 重要な分析ルール

このスキルで最も重要なのは、**正確な分析ルールに従うこと**です。詳細は [analysis_rules.md](references/analysis_rules.md) を参照してください。

### 開発期間の算出

**重要**: タスク作成日ではなく、**最も早い期限日を開発開始日とする**

```
タスク作成日: 2025-10-27
最も早い期限日: 2025-12-05  ← この日付を使用
最も遅い期限日: 2026-02-02

正しい開発期間: 2025-12-05 ～ 2026-02-02（約2ヶ月）
```

### 職種分類の方法

**重要**: スクリプトは**メンバー一覧.csv**から職種情報を取得します。

#### 職種判定の優先順位

1. **メンバー一覧.csv**（最優先）
   - `domain/knowledge/project-structure/メンバー一覧.csv`から取得
   - assignee名を正規化してマッチング
   - 職種 + 専門領域から詳細職種を決定

2. **タスク名プレフィックス**（フォールバック）
   - メンバー一覧.csvに存在しないassigneeの場合のみ使用
   - `(サバ)` → サーバーエンジニア
   - `(クラ)` → クライアントエンジニア
   - `(UI)` → UIデザイナー
   - `(スキル)` → クライアントエンジニア
   - `QA期間` → QA・テスト
   - `管理ツール` → サーバーエンジニア
   - `リリース`、`サブミット` → リリース管理

3. **その他**（デフォルト）
   - 上記のいずれにも該当しない場合

### 職種分類の検証方法（AI向けガイドライン）

**基本方針**: スクリプトが生成した職種分類は**変更禁止**です。以下の場合のみ報告してください。

#### 検証チェックリスト

AI詳細分析時に、以下をチェックしてください：

1. **メンバー一覧.csv登録者の職種分類**
   - スクリプトはCSV情報を優先するため、**100%正確**
   - AIが職種を変更する必要は**一切ありません**
   - 例: Kentaro Itoは必ず「クライアントエンジニア」（CSV: エンジニア, クライアント）

2. **未登録者の職種分類**
   - タスク名プレフィックスから推測（フォールバック）
   - プレフィックスがない場合は「その他」
   - この場合もスクリプトの判定を信頼

3. **複数担当者タスクの扱い**
   - スクリプトは「最初の担当者」の職種で分類
   - AIは職種を変更せず、そのまま受け入れる
   - 注釈として「複数担当者」であることを記載可能

4. **明らかな誤りがある場合のみ報告**
   - メンバー一覧.csvの情報と矛盾する場合のみユーザーに報告
   - 例: CSV未登録者が「クライアントエンジニア」に分類されているが、タスク名は「(サバ)〜」
   - ただし、**勝手に修正しない**（ユーザーに確認）

#### 禁止事項

以下の行為は**絶対に行わない**でください：

❌ スクリプトが生成した職種分類を上書きする
❌ タスク名や作業内容から「総合的に判断」して職種を変更する
❌ 「主な担当者」セクションで、メンバー一覧.csvと異なる職種を記載する
❌ 職種別作業分析で、基本レポートと異なる分類を使用する

#### 正しい対応例

✅ 基本レポートの職種分類をそのまま使用
✅ 各職種セクションで、担当者とタスク数を明記（基本レポートから抽出）
✅ 複数担当者タスクの場合、職種分類はそのままで注釈を追加
✅ 明らかな誤りがある場合は、ユーザーに報告（修正はしない）

#### メンバー一覧.csvの形式

```csv
名前(日本語),名前(英語),職種,専門領域,専門領域詳細,メールアドレス
小林 正人,Masato Kobayashi,エンジニア,クライアント,インゲーム・アウトゲーム | 設計 | 実装 | テスト,masato@example.com
田中 武志,Takeshi Tanaka,エンジニア,サーバー,API・ツール・インフラ | 設計 | 実装 | テスト,
中村 由美,Yumi Nakamura,デザイナー,UI,AD補佐 | UIレイアウト制作 | 素材作成 | 実装,yumi@example.com
```

#### 職種マッピングルール

| 職種（CSV） | 専門領域（CSV） | 詳細職種（出力） |
|------------|----------------|----------------|
| エンジニア | クライアント | クライアントエンジニア |
| エンジニア | サーバー | サーバーエンジニア |
| エンジニア | SRE | SRE |
| デザイナー | UI | UIデザイナー |
| デザイナー | アセット | アセットデザイナー |
| プランナー | - | プランナー |
| QA | - | QA・テスト |
| マネジメント | - | マネジメント |

#### 名前正規化の仕組み

ClickUpのassignee名とメンバー一覧.csvの名前(英語)は形式が異なるため、正規化してマッチングします：

**ClickUpのassignee名形式**:
- "Takeshi Tanaka"（First Last）
- "kenji_watanabe"（first_last）
- "souta matsumoto"（first last）
- "EriYoshida"（FirstLast）

**正規化処理**:
1. 小文字化
2. アンダースコア→スペース変換
3. 前後の空白削除

**マッチング例**:
- "Takeshi Tanaka" → "daiki kawasaki" → マッチ成功
- "kenji_watanabe" → "kenji watanabe" → マッチ成功
- "EriYoshida" → "eriyoshida" → マッチ失敗（姓名連結形式）→ フォールバックへ

#### 職種分類の具体例

**例1: メンバー一覧.csvから判定成功**
- **タスク**: 「スキル：作品・キャラID絞り込み」
- **担当者**: Masato Kobayashi
- **メンバー一覧.csv**: 職種=エンジニア、専門領域=クライアント
- **判断**: クライアントエンジニア（メンバー一覧.csvから）

**例2: メンバー一覧.csvから判定成功**
- **タスク**: 「(サバ)BOXガシャ」
- **担当者**: Takeshi Tanaka
- **メンバー一覧.csv**: 職種=エンジニア、専門領域=サーバー
- **判断**: サーバーエンジニア（メンバー一覧.csvから）

**例3: メンバー一覧.csv未登録のフォールバック**
- **タスク**: 「(クラ)新機能実装」
- **担当者**: Unknown Person
- **メンバー一覧.csv**: 存在しない
- **判断**: クライアントエンジニア（タスク名プレフィックスから推測）

**例4: 複合タスク（複数担当者）**
- **タスク**: 「ガシャ一覧画面の刷新」
- **担当者**: kenji_watanabe, Yumi Nakamura, souta_matsumoto
- **判断**: 最初の担当者（kenji_watanabe）の職種で分類

#### 職種分類の信頼性

スクリプト（analyze_tasks.py）は以下の精度で職種分類を実行します：

| メンバー種別 | 職種判定方法 | 精度 |
|------------|-------------|-----|
| **メンバー一覧.csv登録者** | CSV情報を優先 | **100%正確** |
| **未登録者** | タスク名プレフィックス | 推測レベル（80%程度） |
| **プレフィックスなし未登録者** | 「その他」に分類 | N/A |

**重要**: AI詳細分析では、この職種分類を**変更せず、そのまま使用**してください。

### リスト役割の認識

ClickUpリストは役割によって分析方法が異なります。詳細は [list_types.md](references/list_types.md) を参照してください。

#### 開発管理リスト

**パターン**: `domain/raw-data/clickup/{プロジェクト}/{プロジェクト名}(開発)/v*.*.*`

**分析方法**: 職種別作業分析、工数分析、開発フロー分析

#### QA管理リスト

**パターン**: `domain/raw-data/clickup/{プロジェクト}/QA/アプリQA_Ver*.*.*`

**分析方法**: バグ分類、優先度分析、修正担当者分析

### QA体制の扱い

**開発リスト**の場合、QA期間タスクの担当者（assignees）は開発メンバー全員の可能性があるため、**QA専任メンバーとして記載しない**

正しい記述例（開発リスト）：
```markdown
### QA・テスト

**作業内容**:
1. **[1.5.0]QA期間** - 期限: 2026-01-23
   - 全開発メンバーがQA期間タスクに参加

**備考**:
- QA専任メンバーの情報はタスク管理システムに記録されていない
```

**QAリスト**の場合は、修正担当者を職種別に分類してください。

## レポート生成後のAI分析

スクリプトは基本レポート（職種分類済み）を生成します。その後、AIが以下の詳細分析を追加します：

### 1. 職種別作業分析の詳細化

**重要**: 基本レポートの職種分類は**変更禁止**です。

AIが行うのは、以下の詳細化のみ：

- 各職種の主な担当者を明記（基本レポートから抽出）
- タスク数を集計（基本レポートから集計）
- 作業内容の詳細を追加（基本レポートのタスク一覧から抽出）

職種カテゴリ（参考）：
- サーバーエンジニア
- クライアントエンジニア
- UIデザイナー
- アセットデザイナー
- プランナー/ディレクター
- QA・テスト
- その他（SRE、リリース管理など）

## AIが詳細化すべき項目

基本レポートを読み込んだ後、以下の項目を追加・詳細化してください：

### 1. タイムライン

期限日をもとにASCII図形式で可視化：

```
2025-12-05  プロジェクト開始
   |        - スタミナ回復アイテム実装開始 (Yuki)
   v
12月上旬   サーバー実装開始
   |        - UI実装開始 (Yumi)
   v
12月中旬   クライアント実装本格化
   |        - BOXガシャ Data層 (Hiroshi)
```

### 2. 主要タスクの詳細分析

最大規模タスクについて、以下を詳細に記述：

- 関連タスク数、担当者、開発期間
- 実装内容（技術スタック、アーキテクチャ）
- 実装順序（Data層 → Domain層 → UI層など）
- 品質管理（テストケース、レビュー体制）

### 3. リスクと対応

タスク名や説明から読み取れる課題と対応策を記述：

```markdown
### 確認された課題

1. **BOXガシャ リザルト画面の挙動修正**（1月中旬）
   - 問題: アニメーション再生順序の不具合
   - 対応: 演出順序を修正
   - 担当: Hiroshi Sato
```

### 4. 成果物

リリース内容とドキュメントを記述：

```markdown
### リリース内容
1. BOXガシャシステム（いいジャンくじ）
2. スタミナ回復アイテム機能拡張

### ドキュメント
- 要件仕様書（Google Slides）
- 影響範囲シート（Google Sheets）
```

### 5. 総括

成功要因、課題と改善点、プロジェクト特性を分析：

```markdown
### 成功要因
1. **段階的実装**: BOXガシャをData層→Domain層→UI層と段階的に実装し、リスク分散
2. **並行開発**: 複数機能を並行して進め、効率的にリソース活用

### 課題と改善点
1. **クライアント実装の集中**: 一人に実装が集中
   - 改善案: 早期段階で作業分担を検討
```

## サンプルレポート

完成形のサンプルレポートを参照：
- [example_report.md](references/example_report.md) - GLOW v1.5.0開発リストの完成例

このサンプルを参考に、以下の構成で詳細レポートを生成してください：

1. **プロジェクト概要** - バージョン、開発期間、タスク総数
2. **主要機能** - 親タスクごとの機能一覧
3. **職種別作業分析** - AIが柔軟に職種分類した結果
4. **開発フロー分析（タイムライン）** - ASCII図形式
5. **主要タスクの詳細分析** - 最大規模タスクの深掘り
6. **工数分析** - 職種別作業負荷、期限日から見た工数配分
7. **総括** - 成功要因、課題と改善点

## トラブルシューティング

### JSONファイルが見つからない

```bash
❌ エラー: domain/raw-data/clickup/.../\_list_tasks_raw_phase2_with_subtasks.json が見つかりません
```

対処法:
- ディレクトリパスが正しいか確認
- JSONファイル名が `_list_tasks_raw_phase2_with_subtasks.json` であることを確認

### 職種分類が不正確

対処法:
- [analysis_rules.md](references/analysis_rules.md) を参照して手動で修正
- 特にスキル実装タスクがプランナーに分類されていないか確認

### 開発期間が長すぎる

対処法:
- タスク作成日ではなく、最も早い期限日が使用されているか確認
- スクリプトの`calculate_date_range()`関数を確認

## よくある質問

**Q: スクリプトだけで完全なレポートが生成されますか？**

A: スクリプトは基本構造を生成しますが、タイムライン、詳細分析、リスクと対応、総括などは手動で詳細化することを推奨します。

**Q: QA担当者がレポートに含まれません**

A: QA期間タスクの担当者は開発メンバー全員の可能性があるため、意図的にQA専任メンバーとして記載していません。これは正しい動作です。

**Q: 職種分類をカスタマイズしたい**

A: `scripts/analyze_tasks.py` の `classify_role()` 関数を編集してください。プレフィックスやキーワードのマッピングを変更できます。
