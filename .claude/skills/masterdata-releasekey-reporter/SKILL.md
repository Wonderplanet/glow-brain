---
name: masterdata-releasekey-reporter
description: GLOWマスタデータのリリースキー別抽出とレポート生成。リリースキーを指定して該当データを全テーブルから抽出し、rawデータとMarkdownレポートを作成します。「リリースキー」「release key」「マスタデータ抽出」「データ投入」「リリース内容」などのキーワードで使用します。
---

# Masterdata Release Key Reporter

## 概要

GLOWプロジェクトのマスタデータから特定のリリースキーに関連するデータを抽出し、包括的なレポートを生成するスキルです。93テーブル以上のマスタデータから該当データを自動抽出し、投入内容の全容を把握できます。

## 使用タイミング

- 特定リリースで投入されたデータの全容を確認したい
- リリース前後の影響範囲を調査したい
- データ投入内容をドキュメント化したい
- 運営施策の実装内容をレビューしたい

## ワークフロー

### 1. リリースキーの確認

ユーザーからリリースキーを取得します。リリースキーは通常9桁の数字（例: 202512020）です。

### 2. rawデータ抽出

`scripts/extract_release_data.sh` スクリプトを実行してrawデータを抽出します:

```bash
.claude/skills/masterdata-releasekey-reporter/scripts/extract_release_data.sh <RELEASE_KEY>
```

**例:**
```bash
.claude/skills/masterdata-releasekey-reporter/scripts/extract_release_data.sh 202512020
```

スクリプトは以下を実行します:
1. `projects/glow-masterdata/*.csv` から該当リリースキーを含むデータを検索
2. 該当データを抽出してrawデータファイルを生成

### 3. rawデータの分析とレポート作成

生成されたrawデータファイル (`マスタデータ/リリース/{リリースキー}/release_{RELEASE_KEY}_raw_data.txt`) を読み込んで内容を分析します。

**分析のポイント:**
- どのテーブルにデータが投入されているか
- 各テーブルにどのようなデータが含まれているか
- データの関連性（例: ユニット、アートワーク、攻撃アクションの関係）
- 機能カテゴリ（降臨バトル、イベント、ガチャ、ミッション等）
- 多言語対応の状況

**レポート生成:**

rawデータを分析した結果をもとに、簡潔で分かりやすいMarkdownレポートを作成します。レポートは `マスタデータ/リリース/{リリースキー}/release_{RELEASE_KEY}_report.md` に保存します。

レポートに含めるべき内容:
1. **概要セクション**: リリースキー、テーブル数、総行数、抽出日時
2. **データ投入サマリー**: このリリースで何が追加されたか（例: 降臨バトル「○○」の実装データ）
3. **主要な機能追加**: 大きな機能単位でまとめる（例: 新規ユニット、イベントシステム、ガチャ等）
4. **機能別データ詳細**: カテゴリごとに整理（降臨バトル、ユニット・キャラクター、イベント、ミッション、ステージ、交換・ショップ、ガチャ、アイテム、UI・演出等）
5. **多言語対応**: I18nテーブルの一覧
6. **まとめ**: リリースの特徴や規模感

**レポートのトーン:**
- 簡潔かつ分かりやすく
- 具体的な数値を含める
- 投入されたデータの目的や内容を推測して記載
- 技術者と非技術者の両方が理解できる言葉で

### 4. 結果の提示

ユーザーに以下を報告します:
- 抽出されたテーブル数と総行数
- レポートの要約（主要な機能追加や特徴）
- 生成されたファイルのパス

## エラーハンドリング

### リリースキーが見つからない場合

```
エラー: リリースキー {RELEASE_KEY} を含むデータが見つかりませんでした
```

このエラーが発生した場合:
1. リリースキーの桁数や形式が正しいか確認
2. マスタデータが最新の状態か確認
3. 類似のリリースキーを検索して提案

### マスタデータディレクトリが見つからない場合

```
エラー: マスタデータディレクトリが見つかりません: projects/glow-masterdata
```

このエラーが発生した場合:
1. glow-brainリポジトリのルートディレクトリで実行しているか確認
2. `projects/glow-masterdata` ディレクトリが存在するか確認

## スクリプト詳細

### extract_release_data.sh

**入力:**
- 第1引数: リリースキー（必須）

**処理:**
1. マスタデータディレクトリの存在確認
2. 全CSVファイルから該当リリースキーを含む行を抽出
3. rawデータファイルを生成（全データをテーブルごとに整形）

**出力:**
- `マスタデータ/リリース/{リリースキー}/release_{リリースキー}_raw_data.txt`

## 使用例

### 例1: 基本的な使用

**ユーザー:**
> リリースキー202512020のデータを抽出して

**応答フロー:**
1. スクリプトを実行してrawデータを抽出
```bash
.claude/skills/masterdata-releasekey-reporter/scripts/extract_release_data.sh 202512020
```
2. 生成されたrawデータを読み込んで分析
3. 分析結果をもとにレポートを作成して保存
4. レポートの要約をユーザーに提示

### 例2: レポート確認

**ユーザー:**
> リリースキー202512020のマスタデータ投入内容を確認したい

**応答フロー:**
1. rawデータ抽出スクリプトを実行
2. rawデータを読み込んで詳細に分析
3. 簡潔なレポートを生成（各テーブルの内容説明、機能カテゴリ、データの関連性を含む）
4. 主要な統計情報と投入内容のサマリーを提示

### 例3: 複数リリースの比較準備

**ユーザー:**
> リリースキー202512010と202512020の差分を見たい

**応答フロー:**
1. 両方のリリースキーに対してrawデータを抽出
2. 各リリースのrawデータを分析してレポートを作成
3. 生成された2つのレポートを比較して差分を提示

## 注意事項

- **projects/glow-masterdata** は参照専用です。このスキルは読み取り専用で動作します。
- 大量のデータを抽出する場合、処理に時間がかかることがあります。
- rawデータファイルは数百KBになる可能性があります。
- レポートはClaudeがrawデータを分析して作成するため、データの内容を理解した質の高いレポートが生成されます。
- rawデータファイルを読み込む際、ファイルが大きい場合は分割して読み込むことを検討してください。

## テーブル命名規則

GLOWプロジェクトのマスタデータテーブル:

| プレフィックス | 意味 | 例 |
|--------------|------|-----|
| **Mst** | 固定マスタデータ | MstUnit, MstStage, MstItem |
| **Opr** | 運営施策・期間限定データ | OprGacha, OprCampaign, OprProduct |

レポートではこれらのカテゴリ別に集計されます。
