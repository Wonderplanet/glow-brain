---
name: masterdata-table-docs-creator
description: GLOWマスタデータのテーブル詳細解説ドキュメント生成。DBスキーマ・CSVデータ・クライアント実装を調査し、全カラム一覧・enum解説・連携・実データ例つきのMarkdownを生成して domain/knowledge/masterdata/table-docs/ に保存。「テーブル詳細」「マスタ解説」「table docs」「カラム解説」などで使用。
---

# マスタテーブル詳細解説ドキュメント作成スキル

GLOWマスタデータの任意のテーブルを調査し、全カラム仕様・enum解説・他テーブルとの連携・実データ例を含む詳細解説Markdownを生成します。

## 保存先

```
domain/knowledge/masterdata/table-docs/{TableName}詳細.md
```

## 5ステップ作業フロー

### Step 1: テーブル名の確認

ユーザーが指定したテーブル名（例: `MstItem`）を確認し、命名規則を把握する。

| 種類 | 命名規則 | 例 |
|------|---------|-----|
| DBスキーマ（table_name） | snake_case + 複数形 | `mst_items` |
| CSVファイル名 | PascalCase + 単数形 | `MstItem.csv` |
| クライアントクラス名 | PascalCase + 単数形 | `MstItem.cs` |

変換ルール: `MstItem` → `mst_items`（先頭大文字→小文字、残りはキャメルケースをスネークに、末尾に`s`付与）

### Step 2: DBスキーマからカラム情報取得

```bash
# テーブル定義を取得（全カラム・型・enum・デフォルト値）
cat projects/glow-server/api/database/schema/exports/master_tables_schema.json \
  | jq '.[] | select(.table_name == "{snake_table_name}")'
```

取得内容:
- `column_name`: カラム名
- `data_type`: データ型（varchar, bigint, integer, boolean など）
- `is_nullable`: NULL許容かどうか
- `column_default`: デフォルト値
- `enum_values`: enum型の場合は選択肢リスト（存在する場合）

### Step 3: CSVファイルから実データを取得

```bash
# カラム構造確認
duckdb -c "DESCRIBE SELECT * FROM read_csv('projects/glow-masterdata/{TableName}.csv', AUTO_DETECT=TRUE, nullstr='__NULL__');"

# サンプルデータ取得（上位10件）
duckdb -c "SELECT * FROM read_csv('projects/glow-masterdata/{TableName}.csv', AUTO_DETECT=TRUE, nullstr='__NULL__') LIMIT 10;"

# 総レコード数確認
duckdb -c "SELECT COUNT(*) FROM read_csv('projects/glow-masterdata/{TableName}.csv', AUTO_DETECT=TRUE, nullstr='__NULL__');"
```

詳細クエリは [duckdb-queries.md](references/duckdb-queries.md) を参照。

### Step 4: クライアント実装の確認

```bash
# AutoGeneratedディレクトリから対応クラスを検索
ls projects/glow-client/Assets/GLOW/Scripts/Runtime/Core/Data/Data/AutoGenerated/ | grep {TableName}
```

見つかった場合は内容を読んで確認する:
- フィールド定義（プロパティ名・型）
- enum定義（クライアント側のenum値と意味）
- コメント（実装上の注意事項）
- Translatorクラスがある場合はData→Model変換のロジックも確認

### Step 5: ドキュメント生成・保存

[document-structure.md](references/document-structure.md) のテンプレートに従ってMarkdownを生成し、以下に保存する。

```
domain/knowledge/masterdata/table-docs/{TableName}詳細.md
```

**必須セクション（7セクション）**:
1. 概要
2. 全カラム一覧
3. 主要なenum/フラグの解説（テーブル固有の値がある場合）
4. 命名規則 / IDの生成ルール（IDカラムがある場合）
5. 他テーブルとの連携
6. 実データ例
7. 設定時のポイント

詳細テンプレートは [document-structure.md](references/document-structure.md) を参照。

## CSVが存在しない場合の対処

CSVが `projects/glow-masterdata/` に存在しない場合でも、DBスキーマとクライアント実装からドキュメントを生成できる。その場合は「実データ例」セクションに「CSVデータ未確認」と明記する。

## 参照ドキュメント

- [document-structure.md](references/document-structure.md) — 7セクション詳細テンプレート
- [duckdb-queries.md](references/duckdb-queries.md) — 使用するDuckDBクエリ集
