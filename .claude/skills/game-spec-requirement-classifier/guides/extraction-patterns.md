# 要件抽出パターン

このドキュメントは、ゲーム体験仕様書から要件を抽出する際のパターンとテクニックを提供します。

抽出した要件は、クライアント実装・サーバー実装の両方で活用できます。

## 基本的な抽出方針

### 1. 仕様書の構造を理解する

ゲーム体験仕様書は通常、以下のような構造を持ちます:

- **概要・背景**: ビジネス要件が記載されていることが多い
- **機能説明**: 機能要件が中心
- **条件・制約**: 制約条件や実装要件が記載
- **運用**: 運用要件が記載
- **性能・品質**: 非機能要件が記載

### 2. セクションごとに要件候補を抽出する

各セクションから要件となりうる記述を抽出します。

## 抽出パターン

### パターン1: 行動・振る舞いの記述

**対象:** 機能要件

**識別キーワード:**
- 「〜できる」
- 「〜する」
- 「〜が表示される」
- 「〜が付与される」
- 「〜が発生する」

**例:**
- 「ガチャを引くことができる」 → 機能要件
- 「ミッション達成時に報酬が付与される」 → 機能要件
- 「特別演出が表示される」 → 機能要件

### パターン2: 性能・品質の記述

**対象:** 非機能要件

**識別キーワード:**
- 「〜ms以内」
- 「高負荷」
- 「冪等性」
- 「二重〜防止」
- 「セキュリティ」
- 「安全性」

**例:**
- 「レスポンス500ms以内」 → 非機能要件
- 「二重付与を防止する」 → 非機能要件
- 「高負荷に耐える設計」 → 非機能要件

### パターン3: 運営操作の記述

**対象:** 運用要件

**識別キーワード:**
- 「設定テーブルで」
- 「管理画面から」
- 「即時反映」
- 「運営が〜できる」
- 「デプロイ不要」
- 「ロールバック」

**例:**
- 「設定テーブルでON/OFF切り替え可能」 → 運用要件
- 「管理画面から変更できる」 → 運用要件
- 「即時反映が必要」 → 運用要件

### パターン4: 制約・前提の記述

**対象:** 制約条件

**識別キーワード:**
- 「既存〜を使用」
- 「〜を変更しない」
- 「互換性を維持」
- 「〜上で動作」
- 「〜を使用する」

**例:**
- 「既存テーブルを使用する」 → 制約条件
- 「既存APIを変更しない」 → 制約条件
- 「後方互換を維持する」 → 制約条件

### パターン5: 実装方針の記述

**対象:** 実装要件

**識別キーワード:**
- 「〜で実装」
- 「〜の組み合わせ」
- 「新規〜は作らない」
- 「〜のみ変更」
- 「〜方式を採用」

**例:**
- 「既存機能の組み合わせで実装」 → 実装要件
- 「新UseCaseは作らない」 → 実装要件
- 「Feature Flag方式を採用」 → 実装要件

### パターン6: 目的・背景の記述

**対象:** ビジネス要件

**識別キーワード:**
- 「〜向上」
- 「〜施策」
- 「〜削減」
- 「〜改善」
- 「〜のため」

**例:**
- 「売上向上のため」 → ビジネス要件
- 「イベント施策として」 → ビジネス要件
- 「運営コスト削減」 → ビジネス要件

## 複合的な記述の扱い

### 複数要件が混在する場合

1つの文章に複数の要件が含まれる場合は、分解して抽出します。

**例:**
> 「設定テーブルでON/OFF切り替え可能な新ガチャ機能を追加し、売上向上を目指す」

**抽出結果:**
- 機能要件: 新ガチャ機能を追加
- 運用要件: 設定テーブルでON/OFF切り替え可能
- ビジネス要件: 売上向上を目指す

### 曖昧な記述の扱い

明確に分類できない記述は、以下の優先順位で判断します:

1. **判定軸に立ち返る**: classification-rules.mdの判定軸を参照
2. **文脈を考慮**: 前後の文章から意図を推測
3. **迷ったら複数に分類**: 無理に1つに絞らず、該当する複数のカテゴリに分類

## 抽出時の注意点

### 1. 表現の多様性に注意

同じ要件でも、異なる表現で記載されることがあります。

**例:**
- 「ガチャを引ける」= 「ガチャ機能を提供する」= 「ガチャが利用可能」

### 2. 暗黙的な要件を見逃さない

明示的に記載されていない要件も抽出します。

**例:**
- 「ユーザーデータを扱う」→ 非機能要件: セキュリティ対策が必要（暗黙的）

### 3. 否定形の記述も要件

「〜しない」「〜させない」も重要な要件です。

**例:**
- 「二重付与させない」→ 非機能要件
- 「既存APIを変更しない」→ 制約条件

## 抽出ワークフロー

### ステップ1: 全体を読む

まず仕様書全体を読んで、構造と概要を把握します。

### ステップ2: セクションごとに抽出

各セクションを順番に読み、要件候補を抽出します。

### ステップ3: 抽出結果をリスト化

抽出した要件候補を一覧にまとめます。

### ステップ4: 分類を行う

classification-rules.mdを参照しながら、各要件を分類します。

## 実践例

詳細な実践例は以下のファイルを参照してください:

- [mission-spec-example.md](../examples/mission-spec-example.md) - ミッション仕様書の抽出・分類例
- [gacha-spec-example.md](../examples/gacha-spec-example.md) - ガチャ仕様書の抽出・分類例
