---
description: 要件を対話的に収集し、ベストプラクティスに沿ったカスタムslash commandを自動生成。使用時機：新しいslash commandを作りたい時、チーム向けコマンドを標準化したい時
allowed-tools: AskUserQuestion, Read, Write, Bash(ls:*), Bash(mkdir:*)
---

# Slash Command 自動生成

このコマンドは、ユーザーから要件を対話的に収集し、Claude Code のベストプラクティスに従ったカスタム slash command を自動生成します。

## あなたの役割

Slash command 生成の専門家として、ユーザーの要件を丁寧にヒアリングし、高品質なコマンドファイルを作成します。

## 実行ステップ

### ステップ1: 要件のヒアリング

AskUserQuestion ツールを使用して、以下の情報を収集してください：

**質問1: 基本情報**
- コマンド名（例: `review-security`, `optimize-db`）
- コマンドの目的（何を実現するか）
- 使用場面（いつ使うか）

**質問2: 引数の設計**
- 引数は必要か？
- 必要な場合、何個の引数か？（単一/複数）
- 各引数の意味

**質問3: プロンプトタイプ**
- 段階的指示型（ステップバイステップで実行）
- Context活用型（Bashコマンドやファイル参照を使用）
- テンプレート型（構造化されたフォーマットを提供）

**質問4: 使用するツール**
- Bash コマンド（git, npm, docker など）
- ファイル操作（Read, Write, Edit）
- 検索（Grep, Glob）
- その他

### ステップ2: Frontmatter の生成

収集した情報から以下を自動生成してください：

```yaml
---
description: [目的] + "。使用時機：" + [使用場面]
argument-hint: [引数がある場合のヒント]  # オプション
allowed-tools: [使用ツールのリスト]  # オプション
---
```

**description の生成ルール:**
- 簡潔かつ具体的に（50-100文字程度）
- 「〜を行う」「〜をチェックする」など動詞で始める
- 必ず「使用時機：」を含める

**allowed-tools の判定ルール:**
- Git操作 → `Bash(git:*)` またはより具体的に `Bash(git add:*), Bash(git commit:*)`
- ファイル読み込み → `Read`
- コード検索 → `Grep, Glob`
- ファイル作成/編集 → `Write, Edit`
- npm/docker/その他 → `Bash(npm:*)`, `Bash(docker:*)`

### ステップ3: プロンプト本文の生成

選択されたプロンプトタイプに応じて本文を生成してください：

**パターンA: 段階的指示型**
```markdown
# [コマンド名]

## あなたの役割
[専門家としての役割定義]

## 実行ステップ

1. **[ステップ1]**
   - [詳細な指示]
   - [具体的なアクション]

2. **[ステップ2]**
   - [詳細な指示]

3. **[最終ステップ]**
   - [出力形式の指定]

## 注意事項
- [重要な制約]
- [避けるべきこと]
```

**パターンB: Context活用型**
```markdown
# [コマンド名]

## 現在の状態

[関連する情報を収集]
```
!`[Bashコマンド]`
```

## あなたの任務

上記の情報を基に、[具体的なタスク] を実行してください。

## 出力形式
[期待される出力]
```

**パターンC: テンプレート型**
```markdown
# [コマンド名]

## テンプレート構造

```
[期待される構造を提示]
```

## あなたの任務
上記のテンプレートに従って、$ARGUMENTS についての [成果物] を作成してください。
```

### ステップ4: 引数の組み込み

引数の使用方法を判定して組み込んでください：

- **引数なし**: プロンプトをそのまま使用
- **単一引数 or 全引数を一括使用**: `$ARGUMENTS` を使用
- **複数の構造化された引数**: `$1`, `$2`, `$3` を使用

**引数の記述例:**
```markdown
# 例1: 全引数を使用
issue #$ARGUMENTS について調査してください

# 例2: 個別引数を使用
- **リポジトリ**: $1
- **ブランチ**: $2
- **環境**: $3
```

### ステップ5: ファイルの保存

生成したコマンドを以下に保存してください：

**保存先:**
```
.claude/commands/claude-code/[コマンド名].md
```

**ファイル名のルール:**
- ケバブケース（小文字 + ハイフン）
- 例: `review-security.md`, `optimize-database.md`, `deploy-staging.md`

### ステップ6: プレビューと確認

生成したコマンドの全内容をユーザーに提示し、確認を求めてください：

```markdown
## 生成されたコマンド

**ファイル:** `.claude/commands/claude-code/[名前].md`

**内容:**
[生成したコマンド全文を表示]

---

このコマンドで問題なければ、以下のように実行できます：
/[コマンド名] [引数例]

修正が必要な場合はお知らせください。
```

## ベストプラクティスチェックリスト

生成前に以下を確認してください：

- [ ] Description に「使用時機」が含まれているか
- [ ] Description は具体的で簡潔か（50-100文字）
- [ ] Allowed-tools が適切に設定されているか
- [ ] 引数が適切に組み込まれているか（$ARGUMENTS or $1, $2）
- [ ] プロンプトが実行可能な指示になっているか（曖昧でない）
- [ ] 出力形式が明確に指定されているか
- [ ] ファイル名がケバブケースで適切か
- [ ] 保存先が `.claude/commands/claude-code/` 以下か

## エラーハンドリング

以下のケースに注意してください：

1. **コマンド名の衝突**
   - 既存のコマンドと同名の場合は警告し、上書きするか確認

2. **不適切なツール指定**
   - ユーザーが指定したツールが存在しない場合は提案

3. **引数の不整合**
   - argument-hint と本文での引数使用が一致しているか確認

## 完了メッセージ

コマンド生成完了後、以下を表示してください：

```
✅ Slash command が正常に作成されました！

**ファイル:** .claude/commands/claude-code/[名前].md
**使用方法:** /[コマンド名] [引数]

次回のセッションから利用可能です。
他のコマンドを作成する場合は、再度 /create-command を実行してください。
```

---

## 重要な注意事項

- ユーザーとの対話を大切にし、曖昧な要件は必ず確認してください
- 生成したコマンドは必ずプレビューして承認を得てください
- ベストプラクティスに従い、高品質なコマンドを生成してください
- 既存のプロジェクト構造や制約（glow-brain の参照専用ポリシーなど）を尊重してください
